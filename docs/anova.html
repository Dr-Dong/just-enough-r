<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just enough R</title>
  <meta name="description" content="‘Just enough’ R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Just enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="linear-models-simple.html">
<link rel="next" href="anova-cookbook.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-1-must-read"><i class="fa fa-check"></i>Part 1: ‘Must read’</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-2-nice-to-know"><i class="fa fa-check"></i>Part 2: Nice to know</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-3-loose-ends"><i class="fa fa-check"></i>Part 3: Loose ends</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-warning"><i class="fa fa-check"></i>A warning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start_here.html"><a href="start_here.html"><i class="fa fa-check"></i><b>2</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="start_here.html"><a href="start_here.html#using-rmarkdown-to-record-and-share-work"><i class="fa fa-check"></i><b>2.1</b> Using RMarkdown to record and share work</a></li>
<li class="chapter" data-level="2.2" data-path="start_here.html"><a href="start_here.html#writing-and-knitting-rmarkdown"><i class="fa fa-check"></i><b>2.2</b> Writing and ‘knitting’ RMarkdown</a></li>
<li class="chapter" data-level="2.3" data-path="start_here.html"><a href="start_here.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="start_here.html"><a href="start_here.html#your-first-r-commands"><i class="fa fa-check"></i><b>2.4</b> Your first R commands</a></li>
<li class="chapter" data-level="2.5" data-path="start_here.html"><a href="start_here.html#naming-things-variable-assignment"><i class="fa fa-check"></i><b>2.5</b> Naming things: <em>variable assignment</em></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="start_here.html"><a href="start_here.html#vectors-and-lists"><i class="fa fa-check"></i><b>3</b> Vectors and lists</a><ul>
<li class="chapter" data-level="3.1" data-path="start_here.html"><a href="start_here.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a><ul>
<li class="chapter" data-level="3.1.1" data-path="start_here.html"><a href="start_here.html#accessing-elements-within-vectors"><i class="fa fa-check"></i><b>3.1.1</b> Accessing elements within vectors</a></li>
<li class="chapter" data-level="3.1.2" data-path="start_here.html"><a href="start_here.html#selecting-more-than-one-element-in-a-vector"><i class="fa fa-check"></i><b>3.1.2</b> Selecting more than one element in a vector</a></li>
<li class="chapter" data-level="3.1.3" data-path="start_here.html"><a href="start_here.html#processing-vectors"><i class="fa fa-check"></i><b>3.1.3</b> Processing vectors</a></li>
<li class="chapter" data-level="3.1.4" data-path="start_here.html"><a href="start_here.html#processing-vectors-to-make-new-vectors"><i class="fa fa-check"></i><b>3.1.4</b> Processing vectors to make new vectors</a></li>
<li class="chapter" data-level="3.1.5" data-path="start_here.html"><a href="start_here.html#making-up-data-new-vectors"><i class="fa fa-check"></i><b>3.1.5</b> Making up data (new vectors)</a></li>
<li class="chapter" data-level="3.1.6" data-path="start_here.html"><a href="start_here.html#useful-functions-to-learn-now"><i class="fa fa-check"></i><b>3.1.6</b> Useful functions to learn now</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="start_here.html"><a href="start_here.html#lists"><i class="fa fa-check"></i><b>3.2</b> Lists</a></li>
<li class="chapter" data-level="3.3" data-path="start_here.html"><a href="start_here.html#questions-on-vectors-and-lists"><i class="fa fa-check"></i><b>3.3</b> Questions on vectors and lists</a><ul>
<li class="chapter" data-level="3.3.1" data-path="start_here.html"><a href="start_here.html#extended-questions"><i class="fa fa-check"></i><b>3.3.1</b> Extended questions:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>4</b> Datasets and dataframes</a><ul>
<li class="chapter" data-level="4.1" data-path="datasets.html"><a href="datasets.html#using-built-in-data"><i class="fa fa-check"></i><b>4.1</b> Using ‘built in’ data</a></li>
<li class="chapter" data-level="4.2" data-path="datasets.html"><a href="datasets.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>4.2</b> Importing and exporting data</a></li>
<li class="chapter" data-level="4.3" data-path="datasets.html"><a href="datasets.html#importing-data-over-the-web"><i class="fa fa-check"></i><b>4.3</b> Importing data over the web</a></li>
<li class="chapter" data-level="4.4" data-path="datasets.html"><a href="datasets.html#importing-from-spss-and-other-packages"><i class="fa fa-check"></i><b>4.4</b> Importing from SPSS and other packages</a></li>
<li class="chapter" data-level="4.5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>4.5</b> Working with dataframes</a></li>
<li class="chapter" data-level="4.6" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#introducing-the-tidyverse"><i class="fa fa-check"></i><b>4.6</b> Introducing the <code>tidyverse</code></a></li>
<li class="chapter" data-level="4.7" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-columns-from-a-dataframe"><i class="fa fa-check"></i><b>4.7</b> Selecting columns from a dataframe</a></li>
<li class="chapter" data-level="4.8" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-rows-of-data"><i class="fa fa-check"></i><b>4.8</b> Selecting rows of data</a></li>
<li class="chapter" data-level="4.9" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#combining-column-selections-and-filters-with-dplyr"><i class="fa fa-check"></i><b>4.9</b> Combining column selections and filters with <code>dplyr</code></a></li>
<li class="chapter" data-level="4.10" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#modifying-and-creating-new-columns"><i class="fa fa-check"></i><b>4.10</b> Modifying and creating new columns</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>5</b> Summarising data</a><ul>
<li class="chapter" data-level="5.1" data-path="summarising-data.html"><a href="summarising-data.html#summaries-of-dataframes"><i class="fa fa-check"></i><b>5.1</b> Summaries of dataframes</a></li>
<li class="chapter" data-level="5.2" data-path="summarising-data.html"><a href="summarising-data.html#split-apply-combine"><i class="fa fa-check"></i><b>5.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="5.3" data-path="summarising-data.html"><a href="summarising-data.html#split-breaking-the-data-into-groups"><i class="fa fa-check"></i><b>5.3</b> Split: breaking the data into groups</a></li>
<li class="chapter" data-level="5.4" data-path="summarising-data.html"><a href="summarising-data.html#apply-and-combine"><i class="fa fa-check"></i><b>5.4</b> Apply and combine</a></li>
<li class="chapter" data-level="5.5" data-path="summarising-data.html"><a href="summarising-data.html#a-real-example"><i class="fa fa-check"></i><b>5.5</b> A ‘real’ example</a></li>
<li class="chapter" data-level="5.6" data-path="summarising-data.html"><a href="summarising-data.html#sorting-data"><i class="fa fa-check"></i><b>5.6</b> Sorting data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>6</b> Graphics</a><ul>
<li class="chapter" data-level="" data-path="graphics.html"><a href="graphics.html#the-r-graphics-cookbook"><i class="fa fa-check"></i>The R Graphics Cookbook</a></li>
<li class="chapter" data-level="6.1" data-path="graphics.html"><a href="graphics.html#benefits-of-visualising-data"><i class="fa fa-check"></i><b>6.1</b> Benefits of visualising data</a></li>
<li class="chapter" data-level="6.2" data-path="graphics.html"><a href="graphics.html#choosing-a-plot-type"><i class="fa fa-check"></i><b>6.2</b> Choosing a plot type</a></li>
<li class="chapter" data-level="6.3" data-path="graphics.html"><a href="graphics.html#choosing-layering-and-facetting-graphics"><i class="fa fa-check"></i><b>6.3</b> Choosing, layering and facetting graphics</a><ul>
<li class="chapter" data-level="6.3.1" data-path="graphics.html"><a href="graphics.html#using-ggplot"><i class="fa fa-check"></i><b>6.3.1</b> Using ggplot</a></li>
<li class="chapter" data-level="6.3.2" data-path="graphics.html"><a href="graphics.html#relationships"><i class="fa fa-check"></i><b>6.3.2</b> Relationships</a></li>
<li class="chapter" data-level="6.3.3" data-path="graphics.html"><a href="graphics.html#distributions"><i class="fa fa-check"></i><b>6.3.3</b> Distributions</a></li>
<li class="chapter" data-level="6.3.4" data-path="graphics.html"><a href="graphics.html#comparisons"><i class="fa fa-check"></i><b>6.3.4</b> Comparisons</a></li>
<li class="chapter" data-level="6.3.5" data-path="graphics.html"><a href="graphics.html#composition"><i class="fa fa-check"></i><b>6.3.5</b> Composition</a></li>
<li class="chapter" data-level="6.3.6" data-path="graphics.html"><a href="graphics.html#combining-plots-in-a-grid"><i class="fa fa-check"></i><b>6.3.6</b> Combining plots in a grid</a></li>
<li class="chapter" data-level="6.3.7" data-path="graphics.html"><a href="graphics.html#exporting-high-quality-ggplots-for-print"><i class="fa fa-check"></i><b>6.3.7</b> Exporting high quality ggplots for print</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graphics.html"><a href="graphics.html#quick-and-dirty-plotting"><i class="fa fa-check"></i><b>6.4</b> ‘Quick and dirty’ plotting</a><ul>
<li class="chapter" data-level="6.4.1" data-path="graphics.html"><a href="graphics.html#distributions-1"><i class="fa fa-check"></i><b>6.4.1</b> Distributions</a></li>
<li class="chapter" data-level="6.4.2" data-path="graphics.html"><a href="graphics.html#relationships-1"><i class="fa fa-check"></i><b>6.4.2</b> Relationships</a></li>
<li class="chapter" data-level="6.4.3" data-path="graphics.html"><a href="graphics.html#quantities"><i class="fa fa-check"></i><b>6.4.3</b> Quantities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>7</b> Working with ‘real’ data</a><ul>
<li class="chapter" data-level="7.1" data-path="real-data.html"><a href="real-data.html#how-to-tidy-data"><i class="fa fa-check"></i><b>7.1</b> How to ‘tidy’ data</a></li>
<li class="chapter" data-level="7.2" data-path="real-data.html"><a href="real-data.html#deal-with-multiple-files"><i class="fa fa-check"></i><b>7.2</b> Deal with multiple files</a></li>
<li class="chapter" data-level="7.3" data-path="real-data.html"><a href="real-data.html#error-checking"><i class="fa fa-check"></i><b>7.3</b> Error checking</a></li>
<li class="chapter" data-level="7.4" data-path="real-data.html"><a href="real-data.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing values</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>8</b> Correlations</a><ul>
<li class="chapter" data-level="8.1" data-path="correlations.html"><a href="correlations.html#obtaining-a-correlation-matrix"><i class="fa fa-check"></i><b>8.1</b> Obtaining a correlation matrix</a></li>
<li class="chapter" data-level="8.2" data-path="correlations.html"><a href="correlations.html#making-correlation-tables-for-publication"><i class="fa fa-check"></i><b>8.2</b> Making correlation tables for publication</a><ul>
<li class="chapter" data-level="8.2.1" data-path="correlations.html"><a href="correlations.html#apatables"><i class="fa fa-check"></i><b>8.2.1</b> <code>apaTables</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="correlations.html"><a href="correlations.html#by-hand"><i class="fa fa-check"></i><b>8.2.2</b> By hand</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="correlations.html"><a href="correlations.html#other-types-of-correlation"><i class="fa fa-check"></i><b>8.3</b> Other types of correlation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i><b>9</b> t-tests</a><ul>
<li class="chapter" data-level="9.1" data-path="t-tests.html"><a href="t-tests.html#running-t-tests"><i class="fa fa-check"></i><b>9.1</b> Running t-tests</a></li>
<li class="chapter" data-level="9.2" data-path="t-tests.html"><a href="t-tests.html#independent-groups"><i class="fa fa-check"></i><b>9.2</b> 2 independent groups:</a></li>
<li class="chapter" data-level="9.3" data-path="t-tests.html"><a href="t-tests.html#unequal-variances"><i class="fa fa-check"></i><b>9.3</b> Unequal variances</a></li>
<li class="chapter" data-level="9.4" data-path="t-tests.html"><a href="t-tests.html#paired-samples"><i class="fa fa-check"></i><b>9.4</b> Paired samples</a></li>
<li class="chapter" data-level="9.5" data-path="t-tests.html"><a href="t-tests.html#one-sample-test"><i class="fa fa-check"></i><b>9.5</b> One-sample test</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>10</b> Introduction to linear models in R</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#differences-between-r-and-other-packages-its-important-to-be-aware-of"><i class="fa fa-check"></i><b>10.1</b> Differences between R and other packages it’s important to be aware of</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models-simple.html"><a href="linear-models-simple.html#describing-statistical-models-using-formulae"><i class="fa fa-check"></i><b>10.2</b> Describing statistical models using formulae</a></li>
<li class="chapter" data-level="10.3" data-path="linear-models-simple.html"><a href="linear-models-simple.html#running-a-linear-model"><i class="fa fa-check"></i><b>10.3</b> Running a linear model</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models-simple.html"><a href="linear-models-simple.html#more-on-formulas"><i class="fa fa-check"></i><b>10.4</b> More on formulas</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#other-formula-shortcuts"><i class="fa fa-check"></i><b>10.4.1</b> Other formula shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-models-simple.html"><a href="linear-models-simple.html#what-next"><i class="fa fa-check"></i><b>10.5</b> What next</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>11</b> Anova in R</a><ul>
<li class="chapter" data-level="11.1" data-path="anova.html"><a href="anova.html#differences-between-anova-in-r-v.s.-spss-or-stata"><i class="fa fa-check"></i><b>11.1</b> Differences between Anova in R v.s. SPSS or Stata</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#important-difference-1-variable-codings-and-contrasts"><i class="fa fa-check"></i>Important difference 1: Variable codings and contrasts</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#important-difference-2-which-sums-of-squares"><i class="fa fa-check"></i>Important difference 2: Which sums of squares?</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#anova-in-r-for-spss-users"><i class="fa fa-check"></i>Anova in R for SPSS users</a></li>
<li><a href="anova.html#whats-wrong-with-the-base-r-anova-function">What’s wrong with the base R <code>anova()</code> function?</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#whats-wrong-with-the-spss-defaults"><i class="fa fa-check"></i>What’s wrong with the SPSS defaults?</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#important-difference-3-r-works-on-long-format-data-so-you-must-be-careful-with-repeated-measures-models"><i class="fa fa-check"></i>Important difference 3: R works on long-format data (so you must be careful with repeated measures models)</a></li>
<li class="chapter" data-level="11.2" data-path="anova.html"><a href="anova.html#general-anova-recommendations"><i class="fa fa-check"></i><b>11.2</b> General Anova recommendations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="anova-cookbook.html"><a href="anova-cookbook.html"><i class="fa fa-check"></i><b>12</b> Anova ‘Cookbook’</a><ul>
<li class="chapter" data-level="12.1" data-path="anova-cookbook.html"><a href="anova-cookbook.html#between-subjects-designs"><i class="fa fa-check"></i><b>12.1</b> Between subjects designs</a><ul>
<li class="chapter" data-level="12.1.1" data-path="anova-cookbook.html"><a href="anova-cookbook.html#factorial-anova-no-bigger-than-2x2"><i class="fa fa-check"></i><b>12.1.1</b> Factorial anova, no bigger than 2x2</a></li>
<li class="chapter" data-level="12.1.2" data-path="anova-cookbook.html"><a href="anova-cookbook.html#factorial-anova-where-one-factor-has-2-levels."><i class="fa fa-check"></i><b>12.1.2</b> Factorial anova, where one factor has &gt; 2 levels.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="anova-cookbook.html"><a href="anova-cookbook.html#repeated-measures-or-split-plot-designs"><i class="fa fa-check"></i><b>12.2</b> Repeated measures or ‘split plot’ designs</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>13</b> Understanding interactions (part 1)</a><ul>
<li class="chapter" data-level="13.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-is-an-interaction"><i class="fa fa-check"></i><b>13.1</b> What is an interaction?</a><ul>
<li class="chapter" data-level="13.1.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#example-interaction-visualised"><i class="fa fa-check"></i><b>13.1.1</b> Example interaction visualised</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="understanding-interactions.html"><a href="understanding-interactions.html#visualising-interactions-in-raw-data"><i class="fa fa-check"></i><b>13.2</b> Visualising interactions in raw data</a></li>
<li class="chapter" data-level="13.3" data-path="understanding-interactions.html"><a href="understanding-interactions.html#continuous-predictors"><i class="fa fa-check"></i><b>13.3</b> Continuous predictors</a></li>
<li class="chapter" data-level="13.4" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-next-1"><i class="fa fa-check"></i><b>13.4</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html"><i class="fa fa-check"></i><b>14</b> Making predictions</a><ul>
<li class="chapter" data-level="14.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predictions-vs-margins"><i class="fa fa-check"></i><b>14.1</b> Predictions vs margins</a></li>
<li class="chapter" data-level="14.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means"><i class="fa fa-check"></i><b>14.2</b> Predicted means</a></li>
<li class="chapter" data-level="14.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#effects-margins"><i class="fa fa-check"></i><b>14.3</b> <em>Effects</em> (margins)</a></li>
<li class="chapter" data-level="14.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#continuous-predictors-1"><i class="fa fa-check"></i><b>14.4</b> Continuous predictors</a></li>
<li class="chapter" data-level="14.5" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means-and-margins-using-lm"><i class="fa fa-check"></i><b>14.5</b> Predicted means and margins using <code>lm()</code></a><ul>
<li class="chapter" data-level="14.5.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#running-the-model"><i class="fa fa-check"></i><b>14.5.1</b> Running the model</a></li>
<li class="chapter" data-level="14.5.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-predictions-for-means"><i class="fa fa-check"></i><b>14.5.2</b> Making predictions for means</a></li>
<li class="chapter" data-level="14.5.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-1-make-a-new-dataframe"><i class="fa fa-check"></i><b>14.5.3</b> Step 1: Make a new dataframe</a></li>
<li class="chapter" data-level="14.5.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-2-make-the-predictions"><i class="fa fa-check"></i><b>14.5.4</b> Step 2: Make the predictions</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-prdictions-for-margins-effects-of-predictors"><i class="fa fa-check"></i><b>14.6</b> Making prdictions for margins (<em>effects</em> of predictors)</a></li>
<li class="chapter" data-level="14.7" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#marginal-effects"><i class="fa fa-check"></i><b>14.7</b> Marginal effects</a></li>
<li class="chapter" data-level="14.8" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#with-continuous-covariates"><i class="fa fa-check"></i><b>14.8</b> With continuous covariates</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#visualising-interactions-from-linear-models"><i class="fa fa-check"></i><b>15</b> Visualising interactions from linear models</a></li>
<li class="chapter" data-level="16" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>16</b> Mediation</a></li>
<li class="chapter" data-level="17" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>17</b> Multilevel models</a><ul>
<li class="chapter" data-level="17.1" data-path="multilevel-models.html"><a href="multilevel-models.html#the-sleepstudy-data-and-traditional-rm-anova"><i class="fa fa-check"></i><b>17.1</b> The <code>sleepstudy</code> data and traditional RM Anova</a><ul>
<li class="chapter" data-level="17.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#fit-a-simple-slope-for-days"><i class="fa fa-check"></i><b>17.1.1</b> Fit a simple slope for <code>Days</code></a></li>
<li class="chapter" data-level="17.1.2" data-path="multilevel-models.html"><a href="multilevel-models.html#allow-the-effect-of-sleep-deprivation-to-vary-for-different-participants"><i class="fa fa-check"></i><b>17.1.2</b> Allow the effect of sleep deprivation to vary for different participants</a></li>
<li class="chapter" data-level="17.1.3" data-path="multilevel-models.html"><a href="multilevel-models.html#fitting-a-curve-for-the-effect-of-days"><i class="fa fa-check"></i><b>17.1.3</b> Fitting a curve for the effect of <code>Days</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>18</b> Confirmatory factor analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="cfa.html"><a href="cfa.html#defining-the-model"><i class="fa fa-check"></i><b>18.1</b> Defining the model</a></li>
<li class="chapter" data-level="18.2" data-path="cfa.html"><a href="cfa.html#model-fit"><i class="fa fa-check"></i><b>18.2</b> Model fit</a></li>
<li class="chapter" data-level="18.3" data-path="cfa.html"><a href="cfa.html#modification-indices"><i class="fa fa-check"></i><b>18.3</b> Modification indices</a></li>
<li class="chapter" data-level="18.4" data-path="cfa.html"><a href="cfa.html#missing-data"><i class="fa fa-check"></i><b>18.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>19</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="20" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>20</b> Loading packages</a></li>
<li class="chapter" data-level="21" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>21</b> Getting help</a></li>
<li class="chapter" data-level="22" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>22</b> Missing values</a></li>
<li class="chapter" data-level="23" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html"><i class="fa fa-check"></i><b>23</b> Tips and tricks with RMarkdown</a></li>
<li class="chapter" data-level="24" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html"><i class="fa fa-check"></i><b>24</b> Confidence, credible and prediction intervals</a><ul>
<li class="chapter" data-level="24.1" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#the-problem-with-confidence-intervals"><i class="fa fa-check"></i><b>24.1</b> The problem with confidence intervals</a></li>
<li class="chapter" data-level="24.2" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#forgetting-that-the-ci-depends-on-sample-size."><i class="fa fa-check"></i><b>24.2</b> Forgetting that the CI depends on sample size.</a></li>
<li class="chapter" data-level="24.3" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#what-does-this-mean-for-my-work-on-insert-speciality-here"><i class="fa fa-check"></i><b>24.3</b> What does this mean for my work on [insert speciality here]?</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>25</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘Just enough’ R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova-in-r" class="section level1">
<h1><span class="header-section-number">11</span> Anova in R</h1>
<p>This section attempts to cover in a high level way how to specify anova models in R and some of the issues in interpreting the model output. If you just want the ‘answers’ — i.e. the syntax to specify common Anova models – you could skip to the next section: <a href="anova-cookbook.html">Anova cookbook</a></p>
<div id="differences-between-anova-in-r-v.s.-spss-or-stata" class="section level2">
<h2><span class="header-section-number">11.1</span> Differences between Anova in R v.s. SPSS or Stata</h2>
<p>As noted previously:</p>
<ul>
<li>R can run (pretty much) any Anova model you want but.</li>
<li>R’s default settings for Anova are different to those SPSS or Stata.</li>
</ul>
<p>Most people probably <em>do</em> want to change these default settings, or use an R package that does it for you.</p>
</div>
<div id="important-difference-1-variable-codings-and-contrasts" class="section level2 unnumbered">
<h2>Important difference 1: Variable codings and contrasts</h2>
<p>You may have heard it said before that Anova is just a special case of regression, but not fully explored the links between Anova and regression models.</p>
<p>One of the distinctive features of R is that, unlike SPSS, it tends to do things in a ‘regressiony’ way. In fact, you typically specify your Anova model in regression first, then call the <code>anova()</code> function on it to calculate the familiar F tests, etc.</p>
<p>This means:</p>
<ul>
<li>You need to work out kind of model you actually want (this is a good thing!)</li>
<li>You sometimes have to work harder to make sure R uses categorical variables properly</li>
</ul>
<p>By default R assumes all numeric variables are <em>continuous</em> linear predictors of the outcome. If you have a categorical variable coded as numbers you need to use the <code>factor()</code> function to make sure R knows it is categorical.</p>
<p>As a conseuqence, this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># model 1</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl, <span class="dt">data=</span>mtcars))
## 
## Call:
## lm(formula = mpg ~ cyl, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.9814 -2.1185  0.2217  1.0717  7.5186 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  37.8846     2.0738   18.27  &lt; 2e-16 ***
## cyl          -2.8758     0.3224   -8.92 6.11e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.206 on 30 degrees of freedom
## Multiple R-squared:  0.7262, Adjusted R-squared:  0.7171 
## F-statistic: 79.56 on 1 and 30 DF,  p-value: 6.113e-10</code></pre></div>
<p>Is completely different to this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># model 2</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(cyl), <span class="dt">data=</span>mtcars))
## 
## Call:
## lm(formula = mpg ~ factor(cyl), data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.2636 -1.8357  0.0286  1.3893  7.2364 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   26.6636     0.9718  27.437  &lt; 2e-16 ***
## factor(cyl)6  -6.9208     1.5583  -4.441 0.000119 ***
## factor(cyl)8 -11.5636     1.2986  -8.905 8.57e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.223 on 29 degrees of freedom
## Multiple R-squared:  0.7325, Adjusted R-squared:  0.714 
## F-statistic:  39.7 on 2 and 29 DF,  p-value: 4.979e-09</code></pre></div>
<p>The differences are:</p>
<ul>
<li><p>In model 1, <code>cyl</code> is treated as a continuous predictor. One parameter is used, and <code>cyl</code> is assumed to be a linear predictor of <code>mpg</code>.</p></li>
<li><p>In model 2, <code>cyl</code> is treated as a categorical predictor and is <em>dummy coded</em> (sometimes called treatment-coded). If there are 3 categories (i.e. 4, 6 or 8 cylinders) then there will be 2 parameters used which relate to 2 of the 3 categories. The intercept represents the estimate for the category which has been left out — i.e., it is the base or reference category.</p></li>
</ul>
</div>
<div id="important-difference-2-which-sums-of-squares" class="section level2 unnumbered">
<h2>Important difference 2: Which sums of squares?</h2>
<p>Let’s imagine we have an experiment in which we measure reaction times (<code>rt</code>) under 2 between-subjects conditions: <code>A</code> and <code>B</code>. A has two levels, <code>low</code> or <code>high</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(
    <span class="co"># expand grid will create 1 row for every combination </span>
    <span class="co"># of these variables</span>
    <span class="dt">i =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,
    <span class="dt">A =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>),
    <span class="dt">B =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># make the outcome variable as a function of A and B</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">outcome =</span> 
           <span class="kw">rnorm</span>(<span class="kw">n</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">           </span><span class="co"># main effect of A</span>
<span class="st">           </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(A <span class="op">==</span><span class="st"> &quot;high&quot;</span>) <span class="op">+</span>
<span class="st">           </span><span class="co"># main effect of B</span>
<span class="st">           </span><span class="co"># .5 * (B == &quot;med&quot;) +</span>
<span class="st">           </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(B <span class="op">==</span><span class="st"> &quot;high&quot;</span>) <span class="op">+</span>
<span class="st">           </span><span class="co"># interaction between A:B</span>
<span class="st">           </span><span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(A<span class="op">==</span><span class="st">&quot;high&quot;</span>) <span class="op">*</span><span class="st"> </span>(B <span class="op">==</span><span class="st"> &quot;high&quot;</span>))</code></pre></div>
<p>To add a twist though, let’s say our data not balanced: for example, that we don’t collect as many cases where both <code>A</code> and <code>B</code> are high. The following code deletes approximately 50% of these cases:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment.unbalanced &lt;-<span class="st"> </span>fake.experiment <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># create a marker, which is==1 50% of the time, </span>
<span class="st">  </span><span class="co"># when both A and B == high</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">droprow =</span> 
           <span class="kw">rbinom</span>(<span class="kw">n</span>(), <span class="dv">1</span>, 
                  <span class="dt">prob =</span> (A<span class="op">==</span><span class="st">&quot;high&quot;</span> <span class="op">&amp;</span><span class="st"> </span>B <span class="op">==</span><span class="st"> &quot;high&quot;</span>) <span class="op">*</span><span class="st"> </span>.<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># get rid of marked rows</span>
<span class="st">  </span><span class="kw">filter</span>(droprow <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<p>To check that the data really are unbalanced now, we can use the <code>table()</code> function which builds a contingency table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment.unbalanced <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(A, B) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>table
##       B
## A      low high
##   low   20   20
##   high  20   11</code></pre></div>
<p>We can plot these data and see that the (large) interaction we specified is obvious:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment.unbalanced <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(A, outcome, <span class="dt">color=</span>B, <span class="dt">group=</span>B)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;pointrange&quot;</span>, <span class="dt">fun.data=</span>mean_se) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun.data=</span>mean_se)</code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>After plotting the data, we might want to run a 2x2 Anova to test whether this interaction is statistically significant. This call to <code>lm()</code> specifies the model, and <code>summary()</code> shows that the <code>lm()</code> model included:</p>
<ul>
<li>The intercept, which represents cases where <code>A</code> and <code>B</code> are ‘low’.</li>
<li>The parameter <code>Ahigh</code>, which represents the difference between <code>A==low</code> v.s. <code>A==high</code> when <code>B==low</code></li>
<li>The parameter <code>Bhigh</code>, which represents the difference between <code>B==low</code> v.s. <code>B==high</code>, when <code>A==low</code></li>
<li>The interaction term, <code>Ahigh:Bhigh</code>, which represents the difference in <code>outcome</code> when both <code>A==high</code> AND <code>B==high</code>.</li>
</ul>
<p>The model output is below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.expt.model &lt;-<span class="st"> </span><span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B, <span class="dt">data=</span>fake.experiment.unbalanced)
<span class="kw">summary</span>(fake.expt.model)
## 
## Call:
## lm(formula = outcome ~ A * B, data = fake.experiment.unbalanced)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.71684 -0.62706 -0.04711  0.58437  2.71553 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  -0.1389     0.2382  -0.583  0.56168   
## Ahigh         0.8476     0.3368   2.516  0.01426 * 
## Bhigh         0.9920     0.3368   2.945  0.00444 **
## Ahigh:Bhigh  -1.1504     0.5228  -2.200  0.03123 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.065 on 67 degrees of freedom
## Multiple R-squared:  0.1318, Adjusted R-squared:  0.09294 
## F-statistic: 3.391 on 3 and 67 DF,  p-value: 0.02291</code></pre></div>
<p>The problem with this regression output (i.e. from the <code>summary()</code> function) is that we can only see what are often called the <em>simple contrasts</em>. The parameters represent pairwise contrasts between two cells of the design, and don’t test the <em>overall</em> effect of <code>A</code> or <code>B</code>.</p>
<p>Rather than using multiple, pairwise comparisons, we use Anova to provide a test of the combined effect of <code>A</code>, <code>B</code>, and the interaction of <code>A</code> and <code>B</code>.</p>
</div>
<div id="anova-in-r-for-spss-users" class="section level2 unnumbered">
<h2>Anova in R for SPSS users</h2>
<p>At this point I recognise SPSS users’ main concern will be to reproduce the output SPSS would give by default. The code below uses the <code>Anova()</code> function from the <code>car::</code> package. This function is a replacement for the built in <code>anova()</code> function (note lowercase ‘a’) but adds some additional features, including the ability to specify the type of sums of squares used for the F tests reported:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">car<span class="op">::</span><span class="kw">Anova</span>(fake.expt.model, <span class="dt">type=</span><span class="dv">3</span>)
## Anova Table (Type III tests)
## 
## Response: outcome
##             Sum Sq Df F value   Pr(&gt;F)   
## (Intercept)  0.386  1  0.3402 0.561678   
## A            7.184  1  6.3318 0.014261 * 
## B            9.840  1  8.6720 0.004439 **
## A:B          5.494  1  4.8418 0.031230 * 
## Residuals   76.022 67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>This table should match exactly the result obtained from a 2x2 Anova in SPSS. If, however, we had instead used the base <code>anova()</code> function we would see this output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fake.expt.model)
## Analysis of Variance Table
## 
## Response: outcome
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## A          1  1.524  1.5240  1.3431 0.25060  
## B          1  4.524  4.5242  3.9873 0.04991 *
## A:B        1  5.494  5.4937  4.8418 0.03123 *
## Residuals 67 76.022  1.1347                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>Here the ‘main effects’ are not significant, and the interaction has a different <em>p</em> value from that SPSS would produce.</p>
</div>
<div id="whats-wrong-with-the-base-r-anova-function" class="section level2 unnumbered">
<h2>What’s wrong with the base R <code>anova()</code> function?</h2>
<p>This is a good question. The short answer is that:</p>
<ul>
<li>There’s nothing wrong with it per-se, but</li>
<li>R tests a different hypothesis than SPSS by default, and</li>
<li>It’s probably not the hypothesis you want</li>
<li>You might prefer to report F tests using type 2 or 3 sums of squares</li>
<li>You can get these with the <code>car::Anova()</code> function instead of the base <code>anova()</code> function.</li>
</ul>
<p>A longer answer is given in this <a href="https://stats.stackexchange.com/questions/60362/choice-between-type-i-type-ii-or-type-iii-anova">online discussion on stats.stackechange.com</a> and practical implications are shown in <a href="http://dwoll.de/rexrepos/posts/anovaSStypes.html">this worked example</a>.</p>
<p>An even longer answer, including a much deeper exploration of the philosophical questions involved is given by <span class="citation">Venables (<a href="#ref-venables1998exegeses">1998</a>)</span>. To hammer home the importance of not using the default <code>anova()</code> settings without careful thought, consider the following model output:</p>
<p><em>Example 1</em>, mirroring SPSS default settings, and using type 3 sums of squares:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">car<span class="op">::</span><span class="kw">Anova</span>(<span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span>A <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>A<span class="op">:</span>B, <span class="dt">data=</span>fake.experiment.unbalanced), <span class="dt">type=</span><span class="dv">3</span>)
## Anova Table (Type III tests)
## 
## Response: outcome
##             Sum Sq Df F value   Pr(&gt;F)   
## (Intercept)  0.386  1  0.3402 0.561678   
## A            7.184  1  6.3318 0.014261 * 
## B            9.840  1  8.6720 0.004439 **
## A:B          5.494  1  4.8418 0.031230 * 
## Residuals   76.022 67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p><em>Example 2</em>. using the standard <code>anova()</code> function. The model specifies <code>A</code> first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B, <span class="dt">data=</span>fake.experiment.unbalanced))
## Analysis of Variance Table
## 
## Response: outcome
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## A          1  1.524  1.5240  1.3431 0.25060  
## B          1  4.524  4.5242  3.9873 0.04991 *
## A:B        1  5.494  5.4937  4.8418 0.03123 *
## Residuals 67 76.022  1.1347                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p><em>Example 3</em>: as above, but with B specified first</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span>B <span class="op">*</span><span class="st"> </span>A, <span class="dt">data=</span>fake.experiment.unbalanced))
## Analysis of Variance Table
## 
## Response: outcome
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## B          1  3.707  3.7068  3.2669 0.07518 .
## A          1  2.341  2.3415  2.0636 0.15551  
## B:A        1  5.494  5.4937  4.8418 0.03123 *
## Residuals 67 76.022  1.1347                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>In the first example, <code>car::Anova()</code> provides the same output as SPSS. This is probably what you want, at least in the first instance. In examples 2 and 3, the main effects are ‘not significant’, even though in our simulated data we did create ‘main effects’ of <code>A</code> and <code>B</code>.</p>
<p>To make matters worse,in examples 2 and 3, the <em>order</em> in which we included the predictors <code>A</code> and <code>B</code> changes the F statistics for the main effects. Using a method where our results depend on the order in which we include the factors can lead to confusion, and is best avoided (although see the discussion below for why interpreting main effects in the presence of interactions might be a bad idea anyway).</p>
</div>
<div id="whats-wrong-with-the-spss-defaults" class="section level2 unnumbered">
<h2>What’s wrong with the SPSS defaults?</h2>
<p>Interpreting main effects when there is a significant interaction between predictors doesn’t always make sense, so it’s debateable whether the p values for the main effects in a model containing interactions are useful.</p>
<p>For example, if we look at a bar plot of <code>outcome</code> by <code>A</code>, the confidence intervals are so wide that we wouldn’t want to draw any firm conclusions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment.unbalanced <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(A, outcome, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;pointrange&quot;</span>, <span class="dt">fun.data=</span>mean_cl_normal) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun.data=</span>mean_cl_normal) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Outcome (95% CI)&quot;</span>)</code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>But if we draw the same plot for each level of B, it becomes clear that it wouldn’t make sense to argue there is a ‘main effect’ of A anyway, because the direction of the effect is different for each level of B:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fake.experiment.unbalanced <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(A, outcome, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;pointrange&quot;</span>, <span class="dt">fun.data=</span>mean_cl_normal) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun.data=</span>mean_cl_normal) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Outcome (95% CI)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="kw">paste</span>(<span class="st">&quot;B&quot;</span>, B))</code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Where there is an interaction, the meaning of the main effects changes. <em>The moral of the story is that plotting your data and restating the effect in substantive terms are always crucial.</em></p>
</div>
<div id="important-difference-3-r-works-on-long-format-data-so-you-must-be-careful-with-repeated-measures-models" class="section level2 unnumbered">
<h2>Important difference 3: R works on long-format data (so you must be careful with repeated measures models)</h2>
<p>In R, data tend to be most useful in long format where:</p>
<ul>
<li>each row of the dataframe corresponds to a single measurement occasion</li>
<li>each column corresponds to a variable which is measured</li>
</ul>
<p>For example, in R we might have data like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>head <span class="op">%&gt;%</span><span class="st"> </span>pander</code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="12%" />
<col width="9%" />
<col width="16%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">person</th>
<th align="center">time</th>
<th align="center">predictor</th>
<th align="center">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">4</td>
</tr>
</tbody>
</table>
<p>Whereas in SPSS we might have the same data structured like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.wide <span class="op">%&gt;%</span><span class="st"> </span>head <span class="op">%&gt;%</span><span class="st"> </span>pander</code></pre></div>
<table style="width:67%;">
<colgroup>
<col width="12%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">person</th>
<th align="center">predictor</th>
<th align="center">Time 1</th>
<th align="center">Time 2</th>
<th align="center">Time 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">6</td>
<td align="center">11</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">9</td>
<td align="center">5</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">2</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">4</td>
<td align="center">10</td>
<td align="center">11</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">4</td>
<td align="center">11</td>
<td align="center">3</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">1</td>
<td align="center">7</td>
<td align="center">12</td>
<td align="center">16</td>
</tr>
</tbody>
</table>
<p><em>What this means is that there is no automatic way for R to know which rows belong to which person (assuming individual people are the unit of error in your model).</em></p>
<p>If you are running a model where individuals are sampled more than once — for example in a repeated measures design — then you need to be explicit about which variables identifies subjects in your data.</p>
<p>For example, in the <code>lme4::sleepstudy</code> data, <code>Reaction</code> time is measuresd for each <code>Subject</code> on 10 <code>Day</code>’s:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span>pander</code></pre></div>
<table style="width:38%;">
<colgroup>
<col width="15%" />
<col width="9%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Reaction</th>
<th align="center">Days</th>
<th align="center">Subject</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">249.6</td>
<td align="center">0</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">258.7</td>
<td align="center">1</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">250.8</td>
<td align="center">2</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">321.4</td>
<td align="center">3</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">356.9</td>
<td align="center">4</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">414.7</td>
<td align="center">5</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">382.2</td>
<td align="center">6</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">290.1</td>
<td align="center">7</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">430.6</td>
<td align="center">8</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">466.4</td>
<td align="center">9</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">222.7</td>
<td align="center">0</td>
<td align="center">309</td>
</tr>
<tr class="even">
<td align="center">205.3</td>
<td align="center">1</td>
<td align="center">309</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(Days), Reaction)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Days&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;RT (ms)&quot;</span>)</code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Let’s say we want to test whether there were differences in <code>distance</code> at different ages. The following model is inappropriate because it <em>ignores that <code>distance</code> is measured repeatedly from the same subject</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stupid.model &lt;-<span class="st"> </span><span class="kw">lm</span>(Reaction<span class="op">~</span><span class="kw">factor</span>(Days), <span class="dt">data=</span>lme4<span class="op">::</span>sleepstudy)
<span class="kw">anova</span>(stupid.model)
## Analysis of Variance Table
## 
## Response: Reaction
##               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## factor(Days)   9 166235 18470.6  7.8164 1.317e-09 ***
## Residuals    170 401719  2363.1                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>Instead, I’d recommend you run a linear mixed model using the <code>lmer()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">more.sensible.model &lt;-<span class="st"> </span><span class="kw">lmer</span>(Reaction <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(Days) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Subject), <span class="dt">data=</span>lme4<span class="op">::</span>sleepstudy)
lmerTest<span class="op">::</span><span class="kw">anova</span>(more.sensible.model)
## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##              Sum Sq Mean Sq NumDF DenDF F.value    Pr(&gt;F)    
## factor(Days) 166235   18471     9   153  18.703 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>It is possible to run traditional repeat-measures Anova in R using the <code>afex</code> package (and others, athough this is the best) but it probably isn’t worth the effort (see the <a href="anova-cookbook.html">Anova cookbook section on repeat measures data for details</a>).</p>
</div>
<div id="general-anova-recommendations" class="section level2">
<h2><span class="header-section-number">11.2</span> General Anova recommendations</h2>
<p>As should be obvious from the above:</p>
<ul>
<li><p>Use <code>lm()</code> to specify your model.</p></li>
<li><p>Use the <code>car::Anova()</code> function to get the Anova table, using <code>type=3</code> until you have thought more about it, and want something different.</p></li>
<li><p>Where there is an interaction (even if it is not quite statistically significant) be careful about interpreting main effects in your model.</p></li>
<li><p>Keep your data in long form and be careful when specifying repeat measures Anova</p></li>
<li><p>Use <a href="multilevel-models.html">mixed models</a> rather than repeat measures Anova unless you have a special reason.</p></li>
</ul>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-venables1998exegeses">
<p>Venables, WN. 1998. “Exegeses on Linear Models.” In <em>S-Plus User’s Conference, Washington Dc</em>. <a href="http://www.stats.ox.ac.uk/pub/MASS3/Exegeses.pdf" class="uri">http://www.stats.ox.ac.uk/pub/MASS3/Exegeses.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models-simple.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-cookbook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Just enough R.pdf", "Just enough R.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
