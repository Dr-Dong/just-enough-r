<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just enough R</title>
  <meta name="description" content="‘Just enough’ R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Just enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="working-with-dataframes.html">
<link rel="next" href="graphics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-the-guide-is-structured"><i class="fa fa-check"></i><b>1.1</b> How the guide is structured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#part-1-must-read"><i class="fa fa-check"></i><b>1.1.1</b> Part 1: Must read</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#part-2-nice-to-know"><i class="fa fa-check"></i><b>1.1.2</b> Part 2: Nice to know</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#part-3-loose-ends"><i class="fa fa-check"></i><b>1.1.3</b> Part 3: Loose ends</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-warning"><i class="fa fa-check"></i><b>1.2</b> A warning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start_here.html"><a href="start_here.html"><i class="fa fa-check"></i><b>2</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="start_here.html"><a href="start_here.html#using-rmarkdown-to-record-and-share-work"><i class="fa fa-check"></i><b>2.1</b> Using RMarkdown to record and share work</a></li>
<li class="chapter" data-level="2.2" data-path="start_here.html"><a href="start_here.html#writing-and-knitting-rmarkdown"><i class="fa fa-check"></i><b>2.2</b> Writing and ‘knitting’ RMarkdown</a></li>
<li class="chapter" data-level="2.3" data-path="start_here.html"><a href="start_here.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="start_here.html"><a href="start_here.html#your-first-r-commands"><i class="fa fa-check"></i><b>2.4</b> Your first R commands</a></li>
<li class="chapter" data-level="2.5" data-path="start_here.html"><a href="start_here.html#naming-things-variable-assignment"><i class="fa fa-check"></i><b>2.5</b> Naming things: <em>variable assignment</em></a></li>
<li class="chapter" data-level="2.6" data-path="start_here.html"><a href="start_here.html#vectors-and-lists"><i class="fa fa-check"></i><b>2.6</b> Vectors and lists</a></li>
<li class="chapter" data-level="2.7" data-path="start_here.html"><a href="start_here.html#vectors"><i class="fa fa-check"></i><b>2.7</b> Vectors</a><ul>
<li class="chapter" data-level="2.7.1" data-path="start_here.html"><a href="start_here.html#accessing-elements-within-vectors"><i class="fa fa-check"></i><b>2.7.1</b> Accessing elements within vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="start_here.html"><a href="start_here.html#selecting-more-than-one-element-in-a-vector"><i class="fa fa-check"></i><b>2.8</b> Selecting more than one element in a vector</a><ul>
<li class="chapter" data-level="2.8.1" data-path="start_here.html"><a href="start_here.html#processing-vectors"><i class="fa fa-check"></i><b>2.8.1</b> Processing vectors</a></li>
<li class="chapter" data-level="2.8.2" data-path="start_here.html"><a href="start_here.html#processing-vectors-to-make-new-vectors"><i class="fa fa-check"></i><b>2.8.2</b> Processing vectors to make new vectors</a></li>
<li class="chapter" data-level="2.8.3" data-path="start_here.html"><a href="start_here.html#making-up-data-new-vectors"><i class="fa fa-check"></i><b>2.8.3</b> Making up data (new vectors)</a></li>
<li class="chapter" data-level="2.8.4" data-path="start_here.html"><a href="start_here.html#useful-functions-to-learn-now"><i class="fa fa-check"></i><b>2.8.4</b> Useful functions to learn now</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="start_here.html"><a href="start_here.html#lists"><i class="fa fa-check"></i><b>2.9</b> Lists</a></li>
<li class="chapter" data-level="2.10" data-path="start_here.html"><a href="start_here.html#questions-on-vectors-and-lists"><i class="fa fa-check"></i><b>2.10</b> Questions on vectors and lists</a><ul>
<li class="chapter" data-level="2.10.1" data-path="start_here.html"><a href="start_here.html#extended-questions"><i class="fa fa-check"></i><b>2.10.1</b> Extended questions:</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="start_here.html"><a href="start_here.html#what-next"><i class="fa fa-check"></i><b>2.11</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>3</b> Datasets and dataframes</a><ul>
<li class="chapter" data-level="3.1" data-path="datasets.html"><a href="datasets.html#using-built-in-data"><i class="fa fa-check"></i><b>3.1</b> Using ‘built in’ data</a></li>
<li class="chapter" data-level="3.2" data-path="datasets.html"><a href="datasets.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>3.2</b> Importing and exporting data</a></li>
<li class="chapter" data-level="3.3" data-path="datasets.html"><a href="datasets.html#importing-data-over-the-web"><i class="fa fa-check"></i><b>3.3</b> Importing data over the web</a></li>
<li class="chapter" data-level="3.4" data-path="datasets.html"><a href="datasets.html#importing-from-spss-and-other-packages"><i class="fa fa-check"></i><b>3.4</b> Importing from SPSS and other packages</a></li>
<li class="chapter" data-level="3.5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>3.5</b> Working with dataframes</a></li>
<li class="chapter" data-level="3.6" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#introducing-the-tidyverse"><i class="fa fa-check"></i><b>3.6</b> Introducing the <code>tidyverse</code></a></li>
<li class="chapter" data-level="3.7" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-columns-from-a-dataframe"><i class="fa fa-check"></i><b>3.7</b> Selecting columns from a dataframe</a></li>
<li class="chapter" data-level="3.8" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-rows-of-data"><i class="fa fa-check"></i><b>3.8</b> Selecting rows of data</a></li>
<li class="chapter" data-level="3.9" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#combining-column-selections-and-filters-with-dplyr"><i class="fa fa-check"></i><b>3.9</b> Combining column selections and filters with <code>dplyr</code></a></li>
<li class="chapter" data-level="3.10" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#modifying-and-creating-new-columns"><i class="fa fa-check"></i><b>3.10</b> Modifying and creating new columns</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>4</b> Summarising data</a><ul>
<li class="chapter" data-level="4.1" data-path="summarising-data.html"><a href="summarising-data.html#summaries-of-dataframes"><i class="fa fa-check"></i><b>4.1</b> Summaries of dataframes</a></li>
<li class="chapter" data-level="4.2" data-path="summarising-data.html"><a href="summarising-data.html#split-apply-combine"><i class="fa fa-check"></i><b>4.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="4.3" data-path="summarising-data.html"><a href="summarising-data.html#split-breaking-the-data-into-groups"><i class="fa fa-check"></i><b>4.3</b> Split: breaking the data into groups</a></li>
<li class="chapter" data-level="4.4" data-path="summarising-data.html"><a href="summarising-data.html#apply-and-combine"><i class="fa fa-check"></i><b>4.4</b> Apply and combine</a></li>
<li class="chapter" data-level="4.5" data-path="summarising-data.html"><a href="summarising-data.html#a-real-example"><i class="fa fa-check"></i><b>4.5</b> A ‘real’ example</a></li>
<li class="chapter" data-level="4.6" data-path="summarising-data.html"><a href="summarising-data.html#sorting-data"><i class="fa fa-check"></i><b>4.6</b> Sorting data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#benefits-of-visualising-data"><i class="fa fa-check"></i><b>5.1</b> Benefits of visualising data</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#choosing-a-plot-type"><i class="fa fa-check"></i><b>5.2</b> Choosing a plot type</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#layering-graphics"><i class="fa fa-check"></i><b>5.3</b> Layering graphics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>6</b> Simple linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#describing-our-models-formulas"><i class="fa fa-check"></i><b>6.1</b> Describing our models (formulas)</a></li>
<li class="chapter" data-level="6.2" data-path="linear-models-simple.html"><a href="linear-models-simple.html#running-a-linear-model"><i class="fa fa-check"></i><b>6.2</b> Running a linear model</a></li>
<li class="chapter" data-level="6.3" data-path="linear-models-simple.html"><a href="linear-models-simple.html#more-on-formulas"><i class="fa fa-check"></i><b>6.3</b> More on formulas</a><ul>
<li class="chapter" data-level="6.3.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#other-formula-shortcuts"><i class="fa fa-check"></i><b>6.3.1</b>  Other formula shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-models-simple.html"><a href="linear-models-simple.html#what-next-1"><i class="fa fa-check"></i><b>6.4</b> What next</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>7</b> Working with ‘real’ data</a><ul>
<li class="chapter" data-level="7.1" data-path="real-data.html"><a href="real-data.html#tidy-data"><i class="fa fa-check"></i><b>7.1</b> ‘Tidy’ data</a></li>
<li class="chapter" data-level="7.2" data-path="real-data.html"><a href="real-data.html#dealing-with-multiple-files"><i class="fa fa-check"></i><b>7.2</b> Dealing with multiple files</a></li>
<li class="chapter" data-level="7.3" data-path="real-data.html"><a href="real-data.html#error-checking"><i class="fa fa-check"></i><b>7.3</b> Error checking</a></li>
<li class="chapter" data-level="7.4" data-path="real-data.html"><a href="real-data.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing values</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>8</b> Correlations</a><ul>
<li class="chapter" data-level="8.1" data-path="correlations.html"><a href="correlations.html#obtaining-a-correlation-matrix"><i class="fa fa-check"></i><b>8.1</b> Obtaining a correlation matrix</a></li>
<li class="chapter" data-level="8.2" data-path="correlations.html"><a href="correlations.html#making-correlation-tables-for-publication"><i class="fa fa-check"></i><b>8.2</b> Making correlation tables for publication</a></li>
<li class="chapter" data-level="8.3" data-path="correlations.html"><a href="correlations.html#other-types-of-correlation"><i class="fa fa-check"></i><b>8.3</b> Other types of correlation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i><b>9</b> t-tests</a><ul>
<li class="chapter" data-level="9.1" data-path="t-tests.html"><a href="t-tests.html#running-t-tests"><i class="fa fa-check"></i><b>9.1</b> Running t-tests</a><ul>
<li class="chapter" data-level="9.1.1" data-path="t-tests.html"><a href="t-tests.html#independent-groups"><i class="fa fa-check"></i><b>9.1.1</b> 2 independent groups:</a></li>
<li class="chapter" data-level="9.1.2" data-path="t-tests.html"><a href="t-tests.html#unequal-variances"><i class="fa fa-check"></i><b>9.1.2</b> Unequal variances</a></li>
<li class="chapter" data-level="9.1.3" data-path="t-tests.html"><a href="t-tests.html#paired-samples"><i class="fa fa-check"></i><b>9.1.3</b> Paired samples</a></li>
<li class="chapter" data-level="9.1.4" data-path="t-tests.html"><a href="t-tests.html#one-sample-test"><i class="fa fa-check"></i><b>9.1.4</b> One-sample test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>10</b> Anova</a><ul>
<li class="chapter" data-level="10.1" data-path="anova.html"><a href="anova.html#anova-for-between-subjects-designs"><i class="fa fa-check"></i><b>10.1</b> Anova for between subjects designs</a></li>
<li class="chapter" data-level="10.2" data-path="anova.html"><a href="anova.html#repeated-measures"><i class="fa fa-check"></i><b>10.2</b> Repeated measures</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>11</b> Understanding interactions (part 1)</a><ul>
<li class="chapter" data-level="11.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-is-an-interaction"><i class="fa fa-check"></i><b>11.1</b> What is an interaction?</a><ul>
<li class="chapter" data-level="11.1.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#example-interaction-visualised"><i class="fa fa-check"></i><b>11.1.1</b> Example interaction visualised</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="understanding-interactions.html"><a href="understanding-interactions.html#visualising-interactions-in-raw-data"><i class="fa fa-check"></i><b>11.2</b> Visualising interactions in raw data</a></li>
<li class="chapter" data-level="11.3" data-path="understanding-interactions.html"><a href="understanding-interactions.html#continuous-predictors"><i class="fa fa-check"></i><b>11.3</b> Continuous predictors</a></li>
<li class="chapter" data-level="11.4" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-next-2"><i class="fa fa-check"></i><b>11.4</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html"><i class="fa fa-check"></i><b>12</b> Making predictions</a><ul>
<li class="chapter" data-level="12.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predictions-vs-margins"><i class="fa fa-check"></i><b>12.1</b> Predictions vs margins</a></li>
<li class="chapter" data-level="12.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means"><i class="fa fa-check"></i><b>12.2</b> Predicted means</a></li>
<li class="chapter" data-level="12.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#effects-margins"><i class="fa fa-check"></i><b>12.3</b> <em>Effects</em> (margins)</a></li>
<li class="chapter" data-level="12.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#continuous-predictors-1"><i class="fa fa-check"></i><b>12.4</b> Continuous predictors</a></li>
<li class="chapter" data-level="12.5" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means-and-margins-using-lm"><i class="fa fa-check"></i><b>12.5</b> Predicted means and margins using <code>lm()</code></a><ul>
<li class="chapter" data-level="12.5.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#running-the-model"><i class="fa fa-check"></i><b>12.5.1</b> Running the model</a></li>
<li class="chapter" data-level="12.5.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-predictions-for-means"><i class="fa fa-check"></i><b>12.5.2</b> Making predictions for means</a></li>
<li class="chapter" data-level="12.5.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-1-make-a-new-dataframe"><i class="fa fa-check"></i><b>12.5.3</b> Step 1: Make a new dataframe</a></li>
<li class="chapter" data-level="12.5.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-2-make-the-predictions"><i class="fa fa-check"></i><b>12.5.4</b> Step 2: Make the predictions</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-prdictions-for-margins-effects-of-predictors"><i class="fa fa-check"></i><b>12.6</b> Making prdictions for margins (<em>effects</em> of predictors)</a></li>
<li class="chapter" data-level="12.7" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#marginal-effects"><i class="fa fa-check"></i><b>12.7</b> Marginal effects</a></li>
<li class="chapter" data-level="12.8" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#with-continuous-covariates"><i class="fa fa-check"></i><b>12.8</b> With continuous covariates</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#visualising-interactions-from-linear-models"><i class="fa fa-check"></i><b>13</b> Visualising interactions from linear models</a></li>
<li class="chapter" data-level="14" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>14</b> Mediation</a></li>
<li class="chapter" data-level="15" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>15</b> Multilevel models</a></li>
<li class="chapter" data-level="16" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>16</b> Confirmatory factor analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="cfa.html"><a href="cfa.html#defining-the-model"><i class="fa fa-check"></i><b>16.1</b> Defining the model</a></li>
<li class="chapter" data-level="16.2" data-path="cfa.html"><a href="cfa.html#model-fit"><i class="fa fa-check"></i><b>16.2</b> Model fit</a></li>
<li class="chapter" data-level="16.3" data-path="cfa.html"><a href="cfa.html#modification-indices"><i class="fa fa-check"></i><b>16.3</b> Modification indices</a></li>
<li class="chapter" data-level="16.4" data-path="cfa.html"><a href="cfa.html#missing-data"><i class="fa fa-check"></i><b>16.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>17</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="18" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>18</b> Loading packages</a></li>
<li class="chapter" data-level="19" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>19</b> Getting help</a></li>
<li class="chapter" data-level="20" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>20</b> Missing values</a></li>
<li class="chapter" data-level="21" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html"><i class="fa fa-check"></i><b>21</b> Tips and tricks with RMarkdown</a></li>
<li class="chapter" data-level="22" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html"><i class="fa fa-check"></i><b>22</b> Confidence, credible and prediction intervals</a><ul>
<li class="chapter" data-level="22.1" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#the-problem-with-confidence-intervals"><i class="fa fa-check"></i><b>22.1</b> The problem with confidence intervals</a></li>
<li class="chapter" data-level="22.2" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#forgetting-that-the-ci-depends-on-sample-size."><i class="fa fa-check"></i><b>22.2</b> Forgetting that the CI depends on sample size.</a></li>
<li class="chapter" data-level="22.3" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#what-does-this-mean-for-my-work-on-insert-speciality-here"><i class="fa fa-check"></i><b>22.3</b> What does this mean for my work on [insert speciality here]?</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘Just enough’ R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summarising-data" class="section level1">
<h1><span class="header-section-number">4</span> Summarising data</h1>
<p>Before you begin this section, make sure you have fully understood the section on <a href="datasets.html">datasets and dataframes</a>, and in particular that you are happy using the <code>%&gt;%</code> symbol to describe a flow of data.</p>
<div id="summaries-of-dataframes" class="section level2">
<h2><span class="header-section-number">4.1</span> Summaries of dataframes</h2>
<p>So far you have seen a number of functions which provide summaries of a dataframe. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(angry.moods)
##      Gender          Sports        Anger.Out        Anger.In    
##  Min.   :1.000   Min.   :1.000   Min.   : 9.00   Min.   :10.00  
##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:13.00   1st Qu.:15.00  
##  Median :2.000   Median :2.000   Median :16.00   Median :18.50  
##  Mean   :1.615   Mean   :1.679   Mean   :16.08   Mean   :18.58  
##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:18.00   3rd Qu.:22.00  
##  Max.   :2.000   Max.   :2.000   Max.   :27.00   Max.   :31.00  
##   Control.Out      Control.In    Anger.Expression
##  Min.   :14.00   Min.   :11.00   Min.   : 7.00   
##  1st Qu.:21.00   1st Qu.:18.25   1st Qu.:27.00   
##  Median :24.00   Median :22.00   Median :36.00   
##  Mean   :23.69   Mean   :21.96   Mean   :37.00   
##  3rd Qu.:27.00   3rd Qu.:24.75   3rd Qu.:44.75   
##  Max.   :32.00   Max.   :32.00   Max.   :68.00</code></pre></div>
<p>Or</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psych::<span class="kw">describe</span>(angry.moods, <span class="dt">skew=</span><span class="ot">FALSE</span>)
##                  vars  n  mean    sd min max range   se
## Gender              1 78  1.62  0.49   1   2     1 0.06
## Sports              2 78  1.68  0.47   1   2     1 0.05
## Anger.Out           3 78 16.08  4.22   9  27    18 0.48
## Anger.In            4 78 18.58  4.70  10  31    21 0.53
## Control.Out         5 78 23.69  4.69  14  32    18 0.53
## Control.In          6 78 21.96  4.95  11  32    21 0.56
## Anger.Expression    7 78 37.00 12.94   7  68    61 1.47</code></pre></div>
<p>However, these functions operate on the dataset as a whole. What if we want to get summaries grouped by one of our variables, for example <code>Gender</code>? Or perhaps we want to use our summary data in a further analysis: for example, we might want to compute average reaction times in each block of an experiment to run an Anova or regression model.</p>
<p>What we really want is a summary function <em>which gives us back a dataframe</em>. The <code>dplyr::summarise()</code> does just that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">angry.moods %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean.anger.out=</span><span class="kw">mean</span>(Anger.Out), 
    <span class="dt">sd.anger.out=</span><span class="kw">sd</span>(Anger.Out)
  )
## # A tibble: 1 × 2
##   mean.anger.out sd.anger.out
##            &lt;dbl&gt;        &lt;dbl&gt;
## 1       16.07692      4.21737</code></pre></div>
<p>This has returned a dataframe, which we could store and use as before, although in this instance the dataframe only has one row. What if we want the numbers for men and women separately?</p>
</div>
<div id="split-apply-combine" class="section level2">
<h2><span class="header-section-number">4.2</span> Split, apply, combine</h2>
<p>Let’s think more about the case where we want to compute statistics on men and women separately.</p>
<p>Although many packages would have functions with options to do this (for example, perhaps you would specify grouping variables in a summary function), there’s a more general pattern at work. We want to:</p>
<ul>
<li><em>Split</em> our data (into men and women)</li>
<li><em>Apply</em> some function to them (e.g. calculate the mean) and then</li>
<li><em>Combine</em> it into a single table again (for more processing or analysis)</li>
</ul>
<p>It’s helpful to think of this <em>split <span class="math inline">\(\rightarrow\)</span> apply <span class="math inline">\(\rightarrow\)</span> combine</em> pattern whenever we are processing data because it makes explicit what it is that we want to do.</p>
</div>
<div id="split-breaking-the-data-into-groups" class="section level2">
<h2><span class="header-section-number">4.3</span> Split: breaking the data into groups</h2>
<p>The first task is to organise our dataframe into the relevant groups. To do this we use <code>group_by()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">angry.moods %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Gender) %&gt;%<span class="st"> </span>
<span class="st">  </span>head
## Source: local data frame [6 x 7]
## Groups: Gender [2]
## 
##   Gender Sports Anger.Out Anger.In Control.Out Control.In Anger.Expression
##    &lt;int&gt;  &lt;int&gt;     &lt;int&gt;    &lt;int&gt;       &lt;int&gt;      &lt;int&gt;            &lt;int&gt;
## 1      2      1        18       13          23         20               36
## 2      2      1        14       17          25         24               30
## 3      2      1        13       14          28         28               19
## 4      2      1        17       24          23         23               43
## 5      1      1        16       17          26         28               27
## 6      1      1        16       22          25         23               38</code></pre></div>
<p>Weirdly, this doesn’t seem to have done anything. The data aren’t sorted by <code>Gender</code>, and there is no visible sign of the grouping, but stick with it…</p>
</div>
<div id="apply-and-combine" class="section level2">
<h2><span class="header-section-number">4.4</span> Apply and combine</h2>
<p>Continuing the example above, once we have grouped our data we can then <em>apply</em> a function to it — for exmaple, summarise:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">angry.moods %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Gender) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean.anger.out=</span><span class="kw">mean</span>(Anger.Out)
  )
## # A tibble: 2 × 2
##   Gender mean.anger.out
##    &lt;int&gt;          &lt;dbl&gt;
## 1      1       16.56667
## 2      2       15.77083</code></pre></div>
<p>And R and <code>dplyr</code> have done as we asked:</p>
<ul>
<li><em>split</em> the data by <code>Gender</code>, using <code>group_by()</code></li>
<li><em>apply</em> the <code>summarise()</code> function</li>
<li><em>combine</em> the results into a new data frame</li>
</ul>
</div>
<div id="a-real-example" class="section level2">
<h2><span class="header-section-number">4.5</span> A ‘real’ example</h2>
<p>In the previous section on datasets, we saw some found some raw data from a study which had measured depression with the PHQ-9. Patients were measured on numerous occasions (<code>month</code> is recorded) and were split into treatment and control groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phq9.df &lt;-<span class="st"> </span>readr::<span class="kw">read_csv</span>(<span class="st">&quot;phq.csv&quot;</span>)
## Parsed with column specification:
## cols(
##   patient = col_integer(),
##   phq9_01 = col_integer(),
##   phq9_02 = col_integer(),
##   phq9_03 = col_integer(),
##   phq9_04 = col_integer(),
##   phq9_05 = col_integer(),
##   phq9_06 = col_integer(),
##   phq9_07 = col_integer(),
##   phq9_08 = col_integer(),
##   phq9_09 = col_integer(),
##   month = col_integer(),
##   group = col_integer()
## )
<span class="kw">glimpse</span>(phq9.df)
## Observations: 2,429
## Variables: 12
## $ patient &lt;int&gt; 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, ...
## $ phq9_01 &lt;int&gt; 3, 1, 1, 2, 2, 2, 3, 2, 3, 3, 1, 3, 2, 1, 2, 3, 3, 3, ...
## $ phq9_02 &lt;int&gt; 3, 2, 2, 2, 3, 3, 3, 2, 3, 3, 1, 3, 2, 1, 3, 3, 3, 3, ...
## $ phq9_03 &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3, 2, 3, 3, ...
## $ phq9_04 &lt;int&gt; 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, ...
## $ phq9_05 &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 2, 1, 2, ...
## $ phq9_06 &lt;int&gt; 3, 2, 2, 2, 3, 3, 2, 1, 2, 3, 3, 3, 2, 1, 3, 3, 3, 3, ...
## $ phq9_07 &lt;int&gt; 3, 3, 1, 1, 2, 1, 2, 2, 1, 3, 2, 2, 2, 2, 3, 2, 1, 1, ...
## $ phq9_08 &lt;int&gt; 0, 2, 2, 1, 1, 1, 1, 2, 1, 3, 1, 2, 1, 0, 2, 1, 0, 1, ...
## $ phq9_09 &lt;int&gt; 2, 2, 1, 1, 2, 2, 2, 1, 1, 3, 1, 2, 1, 1, 3, 3, 3, 3, ...
## $ month   &lt;int&gt; 0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 18, 0, 1,...
## $ group   &lt;int&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, ...</code></pre></div>
<p>If this were our data we might want to:</p>
<ul>
<li>Calculate the sum of the PHQ-9 variables (the PHQ-9 <em>score</em>)</li>
<li>Calculate the average PHQ-9 score at each month, and in each group</li>
<li>Show these means by group for months 0, 7 and 12</li>
</ul>
<p>Using only the commands above<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a> we can write:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phq9.summary.df &lt;-<span class="st"> </span>phq9.df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">phq9 =</span> phq9_01 +<span class="st"> </span>phq9_02 +<span class="st"> </span>phq9_03 +<span class="st"> </span>
<span class="st">                    </span>phq9_04 +<span class="st"> </span>phq9_05 +<span class="st"> </span>phq9_06 +<span class="st"> </span>
<span class="st">                    </span>phq9_07 +<span class="st"> </span>phq9_08 +<span class="st"> </span>phq9_09
  ) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(patient, group, month, phq9) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="co"># remove rows with missing values</span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(phq9)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="co"># split</span>
<span class="st">  </span><span class="kw">group_by</span>(month, group) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="co"># apply and combine</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">phq.mean =</span> <span class="kw">mean</span>(phq9))


phq9.summary.df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(month %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">12</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span>pander::<span class="kw">pander</span>()</code></pre></div>
<table style="width:36%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">month</th>
<th align="center">group</th>
<th align="center">phq.mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">19.75904</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">18.97368</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">0</td>
<td align="center">16.61818</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">1</td>
<td align="center">13.42056</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">0</td>
<td align="center">16.15385</td>
</tr>
<tr class="even">
<td align="center">12</td>
<td align="center">1</td>
<td align="center">12.54082</td>
</tr>
</tbody>
</table>
</div>
<div id="sorting-data" class="section level2">
<h2><span class="header-section-number">4.6</span> Sorting data</h2>
<p>Sorting data is easy with <code>dplyr::arrange()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Ozone) %&gt;%<span class="st"> </span>
<span class="st">  </span>head
##   Ozone Solar.R Wind Temp Month Day
## 1     1       8  9.7   59     5  21
## 2     4      25  9.7   61     5  23
## 3     6      78 18.4   57     5  18
## 4     7      NA  6.9   74     5  11
## 5     7      48 14.3   80     7  15
## 6     7      49 10.3   69     9  24</code></pre></div>
<p>By default sorting is ascending, but you can use a minus sign to reverse this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(-Ozone) %&gt;%<span class="st"> </span>
<span class="st">  </span>head
##   Ozone Solar.R Wind Temp Month Day
## 1   168     238  3.4   81     8  25
## 2   135     269  4.1   84     7   1
## 3   122     255  4.0   89     8   7
## 4   118     225  2.3   94     8  29
## 5   115     223  5.7   79     5  30
## 6   110     207  8.0   90     8   9</code></pre></div>
<p>You can sort on multiple columns too:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Month, Ozone) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Month, -Ozone) %&gt;%<span class="st"> </span>
<span class="st">  </span>head
##   Month Ozone
## 1     5   115
## 2     5    45
## 3     5    41
## 4     5    37
## 5     5    36
## 6     5    34</code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>You might have noticed I sneaked something new in here: the call to <code>pander()</code>. This is a weirdly named but useful function when writing RMarkdown documents. It converts any R object into more readable output: here it makes a nice table for us in the compiled document. We cover more <a href="rmarkdown-tricks.html">tips and tricks for formatting RMarkdown documents here</a>. You might also want to check <a href="missing-values.html">this page on missing values</a> to explain the filter which uses <code>!is.na()</code>, but you could leave it for later.<a href="summarising-data.html#fnref14">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-dataframes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Just enough R.pdf", "Just enough R.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
