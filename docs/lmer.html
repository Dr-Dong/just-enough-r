<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just enough R</title>
  <meta name="description" content="‘Just enough’ R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Just enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="multilevel-models.html">
<link rel="next" href="replicating-amd-extending-traditional-rm-anova.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="start-here.html"><a href="start-here.html"><i class="fa fa-check"></i><b>1</b> Workflow</a></li>
<li class="part"><span><b>I Working with data</b></span></li>
<li class="chapter" data-level="2" data-path="datasets-dataframes.html"><a href="datasets-dataframes.html"><i class="fa fa-check"></i><b>2</b> Datasets and dataframes</a></li>
<li class="chapter" data-level="3" data-path="placeholder.html"><a href="placeholder.html"><i class="fa fa-check"></i><b>3</b> Placeholder</a></li>
<li class="chapter" data-level="4" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>4</b> Working with ‘real’ data</a></li>
<li class="chapter" data-level="5" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>5</b> Summarising data</a></li>
<li class="chapter" data-level="6" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>6</b> Graphics</a></li>
<li class="chapter" data-level="7" data-path="placeholder-1.html"><a href="placeholder-1.html"><i class="fa fa-check"></i><b>7</b> Placeholder</a></li>
<li class="part"><span><b>II Analysis</b></span></li>
<li class="chapter" data-level="8" data-path="basic-inferential-statistics.html"><a href="basic-inferential-statistics.html"><i class="fa fa-check"></i><b>8</b> Basic inferential statistics</a></li>
<li class="chapter" data-level="9" data-path="access-the-chi2-value-alone.html"><a href="access-the-chi2-value-alone.html"><i class="fa fa-check"></i><b>9</b> access the chi2 value alone</a></li>
<li class="chapter" data-level="10" data-path="placeholder-2.html"><a href="placeholder-2.html"><i class="fa fa-check"></i><b>10</b> Placeholder</a></li>
<li class="chapter" data-level="11" data-path="test-if-mean-of-outcome-variable-is-different-from-2.html"><a href="test-if-mean-of-outcome-variable-is-different-from-2.html"><i class="fa fa-check"></i><b>11</b> test if mean of <code>outcome</code> variable is different from 2</a></li>
<li class="chapter" data-level="12" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>12</b> Regression</a></li>
<li class="chapter" data-level="13" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>13</b> Anova</a></li>
<li class="chapter" data-level="14" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>14</b> Understanding interactions</a></li>
<li class="chapter" data-level="15" data-path="placeholder-3.html"><a href="placeholder-3.html"><i class="fa fa-check"></i><b>15</b> Placeholder</a></li>
<li class="chapter" data-level="16" data-path="general-linear-models.html"><a href="general-linear-models.html"><i class="fa fa-check"></i><b>16</b> General linear models</a></li>
<li class="chapter" data-level="17" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>17</b> Mediation</a></li>
<li class="chapter" data-level="18" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>18</b> Multilevel models</a><ul>
<li class="chapter" data-level="18.1" data-path="lmer.html"><a href="lmer.html"><i class="fa fa-check"></i><b>18.1</b> <code>lmer()</code></a></li>
<li class="chapter" data-level="" data-path="replicating-amd-extending-traditional-rm-anova.html"><a href="replicating-amd-extending-traditional-rm-anova.html"><i class="fa fa-check"></i>Replicating amd extending traditional RM Anova</a><ul>
<li><a href="replicating-amd-extending-traditional-rm-anova.html#fit-a-simple-slope-for-days">Fit a simple slope for <code>Days</code></a></li>
<li class="chapter" data-level="" data-path="replicating-amd-extending-traditional-rm-anova.html"><a href="replicating-amd-extending-traditional-rm-anova.html#allow-the-effect-of-sleep-deprivation-to-vary-for-different-participants"><i class="fa fa-check"></i>Allow the effect of sleep deprivation to vary for different participants</a></li>
<li><a href="replicating-amd-extending-traditional-rm-anova.html#growth-curve-sleep-example">Fitting a curve for the effect of <code>Days</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="icc-and-vpc.html"><a href="icc-and-vpc.html"><i class="fa fa-check"></i>Variance partition coefficients and intraclass correlations</a></li>
<li class="chapter" data-level="" data-path="arguments-for-fitting-mixed-models-via-mcmc.html"><a href="arguments-for-fitting-mixed-models-via-mcmc.html"><i class="fa fa-check"></i>Arguments for fitting mixed models via MCMC</a></li>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html"><i class="fa fa-check"></i>Troubleshooting</a><ul>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html#simplifying-mixed-models"><i class="fa fa-check"></i>Convergence problems and simplifying the random effects structure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="covariance-modelling.html"><a href="covariance-modelling.html"><i class="fa fa-check"></i><b>19</b> Covariance modelling</a></li>
<li class="chapter" data-level="20" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>20</b> Power analysis in R</a></li>
<li class="chapter" data-level="21" data-path="additional-stub-articles.html"><a href="additional-stub-articles.html"><i class="fa fa-check"></i><b>21</b> Additional stub articles</a></li>
<li class="chapter" data-level="22" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html"><i class="fa fa-check"></i><b>22</b> Baysian linear model fitting with MCMC</a></li>
<li class="part"><span><b>III Loose ends</b></span></li>
<li class="chapter" data-level="23" data-path="placeholder-4.html"><a href="placeholder-4.html"><i class="fa fa-check"></i><b>23</b> Placeholder</a></li>
<li class="chapter" data-level="24" data-path="calculate-pairwise-contrasts.html"><a href="calculate-pairwise-contrasts.html"><i class="fa fa-check"></i><b>24</b> calculate pairwise contrasts</a></li>
<li class="chapter" data-level="25" data-path="placeholder-5.html"><a href="placeholder-5.html"><i class="fa fa-check"></i><b>25</b> Placeholder</a></li>
<li class="chapter" data-level="26" data-path="placeholder-6.html"><a href="placeholder-6.html"><i class="fa fa-check"></i><b>26</b> Placeholder</a></li>
<li class="chapter" data-level="27" data-path="placeholder-7.html"><a href="placeholder-7.html"><i class="fa fa-check"></i><b>27</b> Placeholder</a></li>
<li class="chapter" data-level="28" data-path="r-details.html"><a href="r-details.html"><i class="fa fa-check"></i><b>28</b> R details</a></li>
<li class="chapter" data-level="29" data-path="placeholder-8.html"><a href="placeholder-8.html"><i class="fa fa-check"></i><b>29</b> Placeholder</a></li>
<li class="chapter" data-level="30" data-path="placeholder-9.html"><a href="placeholder-9.html"><i class="fa fa-check"></i><b>30</b> Placeholder</a></li>
<li class="chapter" data-level="31" data-path="placeholder-10.html"><a href="placeholder-10.html"><i class="fa fa-check"></i><b>31</b> Placeholder</a></li>
<li class="chapter" data-level="32" data-path="placeholder-11.html"><a href="placeholder-11.html"><i class="fa fa-check"></i><b>32</b> Placeholder</a></li>
<li class="chapter" data-level="33" data-path="placeholder-12.html"><a href="placeholder-12.html"><i class="fa fa-check"></i><b>33</b> Placeholder</a></li>
<li class="part"><span><b>IV Sharing</b></span></li>
<li class="chapter" data-level="34" data-path="sharing-and-publication.html"><a href="sharing-and-publication.html"><i class="fa fa-check"></i><b>34</b> Sharing and publishing your work</a></li>
<li class="chapter" data-level="35" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>35</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘Just enough’ R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lmer" class="section level2">
<h2><span class="header-section-number">18.1</span> <code>lmer()</code></h2>
<p>Although there are mutiple R packages which can fit mixed-effects regression models, the <code>lmer</code> and <code>glmer</code> functions within the <code>lme4</code> package are the most frequently used, for good reason.</p>
<div id="p-values-in-mixed-models" class="section level4 unnumbered">
<h4><em>p</em> values in mixed models</h4>
<p>For various philosophical and statistical reasons the author of lme4, Doug Bates, has always refused to display <em>p</em> values in the output of lmer models (his reasoning <a href="https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html">is explained here</a>).</p>
<!-- See also http://glmm.wikidot.com/faq#df ? But outdated in places-->
<p>That notwithstanding, many people have wanted to use the various methods to calculate p values for parameters in mixed models, and calculate F tests for effects and interactions. Various methods have been developed over the years which address at least some of Bates’ concerns, and these techniques have been implemented in R in the <code>lmerTest::</code> package. In particular, <code>lmerTest</code> implements an <code>anova</code> function for <code>lmer</code> models, which is very helpful.</p>
</div>
<div id="dont-worry" class="section level4 unnumbered admonition">
<h4>Don’t worry!</h4>
<p>All you need to do is to load the <code>lmerTest</code> package rather than <code>lme4</code>. This loads updated versions of <code>lmer</code>, <code>glmer</code>, and extra functions for things like calculating <em>F</em> tests and the Anova table.</p>
</div>
<div id="lmer-syntax" class="section level4 unnumbered">
<h4>The <code>lmer</code> model syntax</h4>
<p>Specifying <code>lmer</code> models is very similar to the syntax for <code>lm</code>.</p>
<p>The simplest model which allows a <a href="#random-slopes-intercepts">‘random inctercept’</a> for each level in the grouping looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>( outcome <span class="op">~</span><span class="st"> </span>predictors <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>grouping), <span class="dt">data=</span>df)</code></pre></div>
<p>Here the outcome and predictors are specified in a formula, just like for <code>lm</code>. The only difference is that we add a ‘random part’ to the model: in this case, <code>(1|grouping)</code>. The <code>1</code> refers to an intercept, and so this means ‘add a random intercept for each level of <code>grouping</code>’.</p>
<p>If we want to add a <a href="#random-slopes-intercepts">random slope</a> to the model, we could adjust the random part like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>( outcome <span class="op">~</span><span class="st"> </span>predictor <span class="op">+</span><span class="st"> </span>(predictor<span class="op">|</span>grouping), <span class="dt">data=</span>df)</code></pre></div>
<p>This implicitly adds a random intercept too, so in English this formula says something like: let <code>outcome</code> be predicted by <code>predictor</code>; let variation in outcome to vary between levels of <code>grouping</code>, and also allow the effect of <code>predictor</code> to vary between levels of <code>grouping</code>.</p>
<p>The <code>lmer</code> syntax for the random part is very powerful, and allows complex combinations of random intercepts and slopes and control over how these random effects are allowed to correlate with one another. For a detailed guide to fitting two and three level models, with various covariance structures, see: <a href="http://rpsychologist.com/r-guide-longitudinal-lme-lmer" class="uri">http://rpsychologist.com/r-guide-longitudinal-lme-lmer</a></p>
<!-- 
TODO ADD 

https://dynamicecology.wordpress.com/2015/11/04/is-it-a-fixed-or-random-effect/


+ gelmans 5 definitions
https://stats.stackexchange.com/questions/4700/what-is-the-difference-between-fixed-effect-random-effect-and-mixed-effect-mode


 -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multilevel-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="replicating-amd-extending-traditional-rm-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Just enough R.pdf", "Just enough R.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
