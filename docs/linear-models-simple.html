<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just enough R</title>
  <meta name="description" content="‘Just enough’ R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Just enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="graphics.html">
<link rel="next" href="real-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-the-guide-is-structured"><i class="fa fa-check"></i><b>1.1</b> How the guide is structured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#part-1-must-read"><i class="fa fa-check"></i><b>1.1.1</b> Part 1: Must read</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#part-2-nice-to-know"><i class="fa fa-check"></i><b>1.1.2</b> Part 2: Nice to know</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#part-3-loose-ends"><i class="fa fa-check"></i><b>1.1.3</b> Part 3: Loose ends</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-warning"><i class="fa fa-check"></i><b>1.2</b> A warning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start_here.html"><a href="start_here.html"><i class="fa fa-check"></i><b>2</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="start_here.html"><a href="start_here.html#using-rmarkdown-to-record-and-share-work"><i class="fa fa-check"></i><b>2.1</b> Using RMarkdown to record and share work</a></li>
<li class="chapter" data-level="2.2" data-path="start_here.html"><a href="start_here.html#writing-and-knitting-rmarkdown"><i class="fa fa-check"></i><b>2.2</b> Writing and ‘knitting’ RMarkdown</a></li>
<li class="chapter" data-level="2.3" data-path="start_here.html"><a href="start_here.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="start_here.html"><a href="start_here.html#your-first-r-commands"><i class="fa fa-check"></i><b>2.4</b> Your first R commands</a></li>
<li class="chapter" data-level="2.5" data-path="start_here.html"><a href="start_here.html#naming-things-variable-assignment"><i class="fa fa-check"></i><b>2.5</b> Naming things: <em>variable assignment</em></a></li>
<li class="chapter" data-level="2.6" data-path="start_here.html"><a href="start_here.html#vectors-and-lists"><i class="fa fa-check"></i><b>2.6</b> Vectors and lists</a></li>
<li class="chapter" data-level="2.7" data-path="start_here.html"><a href="start_here.html#vectors"><i class="fa fa-check"></i><b>2.7</b> Vectors</a><ul>
<li class="chapter" data-level="2.7.1" data-path="start_here.html"><a href="start_here.html#accessing-elements-within-vectors"><i class="fa fa-check"></i><b>2.7.1</b> Accessing elements within vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="start_here.html"><a href="start_here.html#selecting-more-than-one-element-in-a-vector"><i class="fa fa-check"></i><b>2.8</b> Selecting more than one element in a vector</a><ul>
<li class="chapter" data-level="2.8.1" data-path="start_here.html"><a href="start_here.html#processing-vectors"><i class="fa fa-check"></i><b>2.8.1</b> Processing vectors</a></li>
<li class="chapter" data-level="2.8.2" data-path="start_here.html"><a href="start_here.html#processing-vectors-to-make-new-vectors"><i class="fa fa-check"></i><b>2.8.2</b> Processing vectors to make new vectors</a></li>
<li class="chapter" data-level="2.8.3" data-path="start_here.html"><a href="start_here.html#making-up-data-new-vectors"><i class="fa fa-check"></i><b>2.8.3</b> Making up data (new vectors)</a></li>
<li class="chapter" data-level="2.8.4" data-path="start_here.html"><a href="start_here.html#useful-functions-to-learn-now"><i class="fa fa-check"></i><b>2.8.4</b> Useful functions to learn now</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="start_here.html"><a href="start_here.html#lists"><i class="fa fa-check"></i><b>2.9</b> Lists</a></li>
<li class="chapter" data-level="2.10" data-path="start_here.html"><a href="start_here.html#questions-on-vectors-and-lists"><i class="fa fa-check"></i><b>2.10</b> Questions on vectors and lists</a><ul>
<li class="chapter" data-level="2.10.1" data-path="start_here.html"><a href="start_here.html#extended-questions"><i class="fa fa-check"></i><b>2.10.1</b> Extended questions:</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="start_here.html"><a href="start_here.html#what-next"><i class="fa fa-check"></i><b>2.11</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>3</b> Datasets and dataframes</a><ul>
<li class="chapter" data-level="3.1" data-path="datasets.html"><a href="datasets.html#using-built-in-data"><i class="fa fa-check"></i><b>3.1</b> Using ‘built in’ data</a></li>
<li class="chapter" data-level="3.2" data-path="datasets.html"><a href="datasets.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>3.2</b> Importing and exporting data</a></li>
<li class="chapter" data-level="3.3" data-path="datasets.html"><a href="datasets.html#importing-data-over-the-web"><i class="fa fa-check"></i><b>3.3</b> Importing data over the web</a></li>
<li class="chapter" data-level="3.4" data-path="datasets.html"><a href="datasets.html#importing-from-spss-and-other-packages"><i class="fa fa-check"></i><b>3.4</b> Importing from SPSS and other packages</a></li>
<li class="chapter" data-level="3.5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>3.5</b> Working with dataframes</a></li>
<li class="chapter" data-level="3.6" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#introducing-the-tidyverse"><i class="fa fa-check"></i><b>3.6</b> Introducing the <code>tidyverse</code></a></li>
<li class="chapter" data-level="3.7" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-columns-from-a-dataframe"><i class="fa fa-check"></i><b>3.7</b> Selecting columns from a dataframe</a></li>
<li class="chapter" data-level="3.8" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-rows-of-data"><i class="fa fa-check"></i><b>3.8</b> Selecting rows of data</a></li>
<li class="chapter" data-level="3.9" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#combining-column-selections-and-filters-with-dplyr"><i class="fa fa-check"></i><b>3.9</b> Combining column selections and filters with <code>dplyr</code></a></li>
<li class="chapter" data-level="3.10" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#modifying-and-creating-new-columns"><i class="fa fa-check"></i><b>3.10</b> Modifying and creating new columns</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>4</b> Summarising data</a><ul>
<li class="chapter" data-level="4.1" data-path="summarising-data.html"><a href="summarising-data.html#summaries-of-dataframes"><i class="fa fa-check"></i><b>4.1</b> Summaries of dataframes</a></li>
<li class="chapter" data-level="4.2" data-path="summarising-data.html"><a href="summarising-data.html#split-apply-combine"><i class="fa fa-check"></i><b>4.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="4.3" data-path="summarising-data.html"><a href="summarising-data.html#split-breaking-the-data-into-groups"><i class="fa fa-check"></i><b>4.3</b> Split: breaking the data into groups</a></li>
<li class="chapter" data-level="4.4" data-path="summarising-data.html"><a href="summarising-data.html#apply-and-combine"><i class="fa fa-check"></i><b>4.4</b> Apply and combine</a></li>
<li class="chapter" data-level="4.5" data-path="summarising-data.html"><a href="summarising-data.html#a-real-example"><i class="fa fa-check"></i><b>4.5</b> A ‘real’ example</a></li>
<li class="chapter" data-level="4.6" data-path="summarising-data.html"><a href="summarising-data.html#sorting-data"><i class="fa fa-check"></i><b>4.6</b> Sorting data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#benefits-of-visualising-data"><i class="fa fa-check"></i><b>5.1</b> Benefits of visualising data</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#choosing-a-plot-type"><i class="fa fa-check"></i><b>5.2</b> Choosing a plot type</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#layering-graphics"><i class="fa fa-check"></i><b>5.3</b> Layering graphics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>6</b> Simple linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#describing-our-models-formulas"><i class="fa fa-check"></i><b>6.1</b> Describing our models (formulas)</a></li>
<li class="chapter" data-level="6.2" data-path="linear-models-simple.html"><a href="linear-models-simple.html#running-a-linear-model"><i class="fa fa-check"></i><b>6.2</b> Running a linear model</a></li>
<li class="chapter" data-level="6.3" data-path="linear-models-simple.html"><a href="linear-models-simple.html#more-on-formulas"><i class="fa fa-check"></i><b>6.3</b> More on formulas</a><ul>
<li class="chapter" data-level="6.3.1" data-path="linear-models-simple.html"><a href="linear-models-simple.html#other-formula-shortcuts"><i class="fa fa-check"></i><b>6.3.1</b>  Other formula shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-models-simple.html"><a href="linear-models-simple.html#what-next-1"><i class="fa fa-check"></i><b>6.4</b> What next</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>7</b> Working with ‘real’ data</a><ul>
<li class="chapter" data-level="7.1" data-path="real-data.html"><a href="real-data.html#tidy-data"><i class="fa fa-check"></i><b>7.1</b> ‘Tidy’ data</a></li>
<li class="chapter" data-level="7.2" data-path="real-data.html"><a href="real-data.html#dealing-with-multiple-files"><i class="fa fa-check"></i><b>7.2</b> Dealing with multiple files</a></li>
<li class="chapter" data-level="7.3" data-path="real-data.html"><a href="real-data.html#error-checking"><i class="fa fa-check"></i><b>7.3</b> Error checking</a></li>
<li class="chapter" data-level="7.4" data-path="real-data.html"><a href="real-data.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing values</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>8</b> Correlations</a><ul>
<li class="chapter" data-level="8.1" data-path="correlations.html"><a href="correlations.html#obtaining-a-correlation-matrix"><i class="fa fa-check"></i><b>8.1</b> Obtaining a correlation matrix</a></li>
<li class="chapter" data-level="8.2" data-path="correlations.html"><a href="correlations.html#making-correlation-tables-for-publication"><i class="fa fa-check"></i><b>8.2</b> Making correlation tables for publication</a></li>
<li class="chapter" data-level="8.3" data-path="correlations.html"><a href="correlations.html#other-types-of-correlation"><i class="fa fa-check"></i><b>8.3</b> Other types of correlation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i><b>9</b> t-tests</a><ul>
<li class="chapter" data-level="9.1" data-path="t-tests.html"><a href="t-tests.html#running-t-tests"><i class="fa fa-check"></i><b>9.1</b> Running t-tests</a><ul>
<li class="chapter" data-level="9.1.1" data-path="t-tests.html"><a href="t-tests.html#independent-groups"><i class="fa fa-check"></i><b>9.1.1</b> 2 independent groups:</a></li>
<li class="chapter" data-level="9.1.2" data-path="t-tests.html"><a href="t-tests.html#unequal-variances"><i class="fa fa-check"></i><b>9.1.2</b> Unequal variances</a></li>
<li class="chapter" data-level="9.1.3" data-path="t-tests.html"><a href="t-tests.html#paired-samples"><i class="fa fa-check"></i><b>9.1.3</b> Paired samples</a></li>
<li class="chapter" data-level="9.1.4" data-path="t-tests.html"><a href="t-tests.html#one-sample-test"><i class="fa fa-check"></i><b>9.1.4</b> One-sample test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>10</b> Anova</a><ul>
<li class="chapter" data-level="10.1" data-path="anova.html"><a href="anova.html#anova-for-between-subjects-designs"><i class="fa fa-check"></i><b>10.1</b> Anova for between subjects designs</a></li>
<li class="chapter" data-level="10.2" data-path="anova.html"><a href="anova.html#repeated-measures"><i class="fa fa-check"></i><b>10.2</b> Repeated measures</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>11</b> Understanding interactions (part 1)</a><ul>
<li class="chapter" data-level="11.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-is-an-interaction"><i class="fa fa-check"></i><b>11.1</b> What is an interaction?</a><ul>
<li class="chapter" data-level="11.1.1" data-path="understanding-interactions.html"><a href="understanding-interactions.html#example-interaction-visualised"><i class="fa fa-check"></i><b>11.1.1</b> Example interaction visualised</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="understanding-interactions.html"><a href="understanding-interactions.html#visualising-interactions-in-raw-data"><i class="fa fa-check"></i><b>11.2</b> Visualising interactions in raw data</a></li>
<li class="chapter" data-level="11.3" data-path="understanding-interactions.html"><a href="understanding-interactions.html#continuous-predictors"><i class="fa fa-check"></i><b>11.3</b> Continuous predictors</a></li>
<li class="chapter" data-level="11.4" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-next-2"><i class="fa fa-check"></i><b>11.4</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html"><i class="fa fa-check"></i><b>12</b> Making predictions</a><ul>
<li class="chapter" data-level="12.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predictions-vs-margins"><i class="fa fa-check"></i><b>12.1</b> Predictions vs margins</a></li>
<li class="chapter" data-level="12.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means"><i class="fa fa-check"></i><b>12.2</b> Predicted means</a></li>
<li class="chapter" data-level="12.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#effects-margins"><i class="fa fa-check"></i><b>12.3</b> <em>Effects</em> (margins)</a></li>
<li class="chapter" data-level="12.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#continuous-predictors-1"><i class="fa fa-check"></i><b>12.4</b> Continuous predictors</a></li>
<li class="chapter" data-level="12.5" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means-and-margins-using-lm"><i class="fa fa-check"></i><b>12.5</b> Predicted means and margins using <code>lm()</code></a><ul>
<li class="chapter" data-level="12.5.1" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#running-the-model"><i class="fa fa-check"></i><b>12.5.1</b> Running the model</a></li>
<li class="chapter" data-level="12.5.2" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-predictions-for-means"><i class="fa fa-check"></i><b>12.5.2</b> Making predictions for means</a></li>
<li class="chapter" data-level="12.5.3" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-1-make-a-new-dataframe"><i class="fa fa-check"></i><b>12.5.3</b> Step 1: Make a new dataframe</a></li>
<li class="chapter" data-level="12.5.4" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#step-2-make-the-predictions"><i class="fa fa-check"></i><b>12.5.4</b> Step 2: Make the predictions</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#making-prdictions-for-margins-effects-of-predictors"><i class="fa fa-check"></i><b>12.6</b> Making prdictions for margins (<em>effects</em> of predictors)</a></li>
<li class="chapter" data-level="12.7" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#marginal-effects"><i class="fa fa-check"></i><b>12.7</b> Marginal effects</a></li>
<li class="chapter" data-level="12.8" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#with-continuous-covariates"><i class="fa fa-check"></i><b>12.8</b> With continuous covariates</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#visualising-interactions-from-linear-models"><i class="fa fa-check"></i><b>13</b> Visualising interactions from linear models</a></li>
<li class="chapter" data-level="14" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>14</b> Mediation</a></li>
<li class="chapter" data-level="15" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>15</b> Multilevel models</a></li>
<li class="chapter" data-level="16" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>16</b> Confirmatory factor analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="cfa.html"><a href="cfa.html#defining-the-model"><i class="fa fa-check"></i><b>16.1</b> Defining the model</a></li>
<li class="chapter" data-level="16.2" data-path="cfa.html"><a href="cfa.html#model-fit"><i class="fa fa-check"></i><b>16.2</b> Model fit</a></li>
<li class="chapter" data-level="16.3" data-path="cfa.html"><a href="cfa.html#modification-indices"><i class="fa fa-check"></i><b>16.3</b> Modification indices</a></li>
<li class="chapter" data-level="16.4" data-path="cfa.html"><a href="cfa.html#missing-data"><i class="fa fa-check"></i><b>16.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>17</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="18" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>18</b> Loading packages</a></li>
<li class="chapter" data-level="19" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>19</b> Getting help</a></li>
<li class="chapter" data-level="20" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>20</b> Missing values</a></li>
<li class="chapter" data-level="21" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html"><i class="fa fa-check"></i><b>21</b> Tips and tricks with RMarkdown</a></li>
<li class="chapter" data-level="22" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html"><i class="fa fa-check"></i><b>22</b> Confidence, credible and prediction intervals</a><ul>
<li class="chapter" data-level="22.1" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#the-problem-with-confidence-intervals"><i class="fa fa-check"></i><b>22.1</b> The problem with confidence intervals</a></li>
<li class="chapter" data-level="22.2" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#forgetting-that-the-ci-depends-on-sample-size."><i class="fa fa-check"></i><b>22.2</b> Forgetting that the CI depends on sample size.</a></li>
<li class="chapter" data-level="22.3" data-path="confidence-vs-prediction-intervals.html"><a href="confidence-vs-prediction-intervals.html#what-does-this-mean-for-my-work-on-insert-speciality-here"><i class="fa fa-check"></i><b>22.3</b> What does this mean for my work on [insert speciality here]?</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘Just enough’ R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-linear-models" class="section level1">
<h1><span class="header-section-number">6</span> Simple linear models</h1>
<p>This section assumes most readers will have done an introductory statistics course and had practce running multiple regression and or Anova in SPSS or a similar package.</p>
<!-- If you haven't, don't rush out to do that though XXX what should they do instead? Recommend some MOOC? XXX? -->
<div id="describing-our-models-formulas" class="section level2">
<h2><span class="header-section-number">6.1</span> Describing our models (formulas)</h2>
<p>R requires that you are explicit about the statistical model you want to run, but provides a neat, concise way of describing a model, called a <code>formula</code>. For multiple regression and simple Anova, the formulas we write map closely onto the underlying <em>linear model</em>. The formula syntax provides shortcuts to quickly describe all the models you are likely to need.</p>
<p>Formulas have two parts: the left hand side and the right hand side, which are separated by the tilde symbol: <code>~</code>. Here, the tilde just means ‘is predicted by’.</p>
<p>For example, for formula <code>height ~ age + gender</code> specifies a regression model where <code>height</code> is the outcome, and <code>age</code> and <code>gender</code> are the predictor variables.<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a></p>
<p>There are lots more useful tricks to learn when writing formulas, which are covered below. In the interests of instant gratification, let’s work through a simple example first:</p>
</div>
<div id="running-a-linear-model" class="section level2">
<h2><span class="header-section-number">6.2</span> Running a linear model</h2>
<p>Linear models (including Anova and multiple regression) are run using the <code>lm</code> function, short for ‘linear model’. We will use the <code>mtcars</code> dataset, which is built into R, for our first example.</p>
<p>First, we have a quick look at the data. The pairs plot suggests that <code>mpg</code> might be related to a number of the other variables including <code>disp</code> (engine size) and <code>wt</code> (car weight):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(mpg, disp, wt) %&gt;%<span class="st"> </span>
<span class="st">    </span>pairs</code></pre></div>
<p><img src="Just_enough_R_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>Before running any model, we should ask outselves what question we are trying to answer? In this instance, we can see that both weight and engine size are related to <code>mpg</code>, but they are also correlated with one another.</p>
<p>We might want to know, “are weight and engine size independent predictors of <code>mpg</code>?” That is, if we know a car’s weight, do we gain additional information about it’s <code>mpg</code> by measuring engine size?</p>
<p>To answer this, we could use multiple regression, including both <code>wt</code> and <code>disp</code> as predictors of <code>mpg</code>. The formula for this would be <code>mpg ~ wt + disp</code>. The command below runs the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(mpg ~<span class="st"> </span>wt +<span class="st"> </span>disp, <span class="dt">data=</span>mtcars)
## 
## Call:
## lm(formula = mpg ~ wt + disp, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt         disp  
##    34.96055     -3.35083     -0.01772</code></pre></div>
<p>For readers used to wading through SPSS output, R might seem concise to the point of rudeness.</p>
<p>By default, the <code>lm</code> commands displays very little, only repeating the formula and listing the coefficients for each predictor in the model.</p>
<p>So what next? Unlike SPSS, we must be explicit and tell R exactly what we want. The most convenient way to do this is to first store the results of the <code>lm()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>wt +<span class="st"> </span>disp, <span class="dt">data=</span>mtcars)</code></pre></div>
<p>This stores the results of <code>lm</code> in a variable named <code>m.1</code><a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a>. We can then use other functions to get more information about the model. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m<span class="fl">.1</span>)
## 
## Call:
## lm(formula = mpg ~ wt + disp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10</code></pre></div>
<p>Although still compact, the <code>summary</code> function provides familiar output, including the estimate, <em>SE</em>, and <em>p</em> value for each parameter.</p>
<p>Take a moment to find the following statistics in the output above:</p>
<ul>
<li>The coefficients and p values for each predictor</li>
<li>The <em>R</em><sup>2</sup> for the overall model. What % of variance in <code>mpg</code> is explained?</li>
</ul>
<p>Answer the original question: ‘accounting for weight, does <code>disp</code> tell us anything extra about a car’s <code>mpg</code>?’</p>
</div>
<div id="more-on-formulas" class="section level2">
<h2><span class="header-section-number">6.3</span> More on formulas</h2>
<p>Above we briefly introduced R’s formula syntax. Formulas for linear models have the following structure:</p>
<p><code>left_hand_side ~ right_hand_side</code></p>
<p>For linear models <em>the left side is our outcome</em>, which is must be a continous variable (i.e. not categorical or binary)<a href="#fn17" class="footnoteRef" id="fnref17"><sup>17</sup></a>.</p>
<p><em>The right hand side lists our predictors</em>. In the example above we used the <code>+</code> symbol to separate the predictors <code>wt</code> and <code>disp</code>. This told R to simply add each predictor to the model. However, many times we want to specify relationships <em>between</em> our predictors.</p>
<p>For example, we might want to run an Anova with 2 categorical predictors, each with 2 levels (e.g. a 2x2 between-subjects design).</p>
<p>Below, we define and run a linear model with both <code>vs</code> and <code>am</code> as predictors, along with the interaction of <code>vs:am</code>. We save this model, and use the <code>anova</code> command to print the standard Anova table for the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>vs +<span class="st"> </span>am +<span class="st"> </span>vs:am, <span class="dt">data=</span>mtcars)
<span class="kw">anova</span>(m<span class="fl">.2</span>)
## Analysis of Variance Table
## 
## Response: mpg
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## vs         1 496.53  496.53 41.1963 5.981e-07 ***
## am         1 276.03  276.03 22.9021 4.984e-05 ***
## vs:am      1  16.01   16.01  1.3283    0.2589    
## Residuals 28 337.48   12.05                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>This might seem odd to some readers (running the linear model before the Anova), but it’s important to understand that printing an Anova table is just one of the things you can do with a linear model — allbeit an important one for experimental psychologists.</p>
<div id="other-formula-shortcuts" class="section level3">
<h3><span class="header-section-number">6.3.1</span>  Other formula shortcuts</h3>
<p>In addition to the <code>+</code> symbol, we can use other shortcuts to create linear models.</p>
<p>As seen above, the colon (<code>:</code>) operator indicates the interaction between two terms. So <code>a:b</code> is equivalent to creating a new variable in the data frame where <code>a</code> is multiplied by <code>b</code>.</p>
<p>The <code>*</code> symbol indicates the expansion of other terms in the model. So, <code>a*b</code> is the equivalent of <code>a + b + a:b</code>.</p>
<p>Finally, it’s good to know that other functions can be used within R formulas to save work. For example, if you wanted to transform your dependent variable then <code>log(y) ~ x</code> will do what you might expect, and saves creating temporary variables in your dataset.</p>
<p>The formula syntax is very powerful, and the above only shows the basics, but you can read the <code>formulae</code> help pages in RStudio for more details.</p>
<p>As an exercise, run the following models using the mtcars dataset:</p>
<ul>
<li>With <code>mpg</code> as the outcome, and with <code>cyl</code> and <code>hp</code> as predictors</li>
<li>As above, but adding the interaction of <code>cyl</code> and <code>hp</code>.</li>
<li>Repeat the model above, but write the formula a different way (make the formula either more or less explicit, but retaining the same predictors in the model).</li>
</ul>
</div>
</div>
<div id="what-next-1" class="section level2">
<h2><span class="header-section-number">6.4</span> What next</h2>
<p><strong><em>It is strongly recommended that you read the <a href="anova.html">section on Anova</a> before doing anything else.</em></strong></p>
<p>R has a number of important differences in it’s default settings, as compared to packages like Stata or SPSS, and these can make important differences to the way you interpret the output of Anova models.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="15">
<li id="fn15"><p>I avoid the terms dependent/independent variables because they are confusing to many students, and because they can be misleading when discussing non-experimental data. ‘Outcome’ and ‘predictors’ are preferred instead.<a href="linear-models-simple.html#fnref15">↩</a></p></li>
<li id="fn16"><p>This is actually a pretty terrible variable name. Try to give descriptive names to variables you create in your code; this prevents errors and makes code easier to read.<a href="linear-models-simple.html#fnref16">↩</a></p></li>
<li id="fn17"><p>Other types of model (e.g. generalised linear models using the <code>glm()</code> function) can accept binary or categorical outcomes.<a href="linear-models-simple.html#fnref17">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="real-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Just enough R.pdf", "Just enough R.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
