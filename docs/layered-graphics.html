<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just enough R</title>
  <meta name="description" content="‘Just enough’ R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Just enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="graphics-approaches.html">
<link rel="next" href="utility-plotting-functions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-warning"><i class="fa fa-check"></i>A warning</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start-here.html"><a href="start-here.html"><i class="fa fa-check"></i><b>2</b> Workflow</a><ul>
<li class="chapter" data-level="" data-path="start-here.html"><a href="start-here.html#rmarkdown"><i class="fa fa-check"></i>Using RMarkdown to record and share work</a></li>
<li class="chapter" data-level="" data-path="start-here.html"><a href="start-here.html#writing-and-knitting-rmarkdown"><i class="fa fa-check"></i>Writing and ‘knitting’ RMarkdown</a></li>
<li class="chapter" data-level="" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#first-commands"><i class="fa fa-check"></i>First commands</a></li>
<li><a href="r-basics.html#variables">Naming things: <em>variable assignment</em></a></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#vectors-and-lists"><i class="fa fa-check"></i>Vectors and lists</a></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#lists"><i class="fa fa-check"></i>Lists</a></li>
</ul></li>
<li class="part"><span><b>II Working with data</b></span></li>
<li class="chapter" data-level="4" data-path="datasets-dataframes.html"><a href="datasets-dataframes.html"><i class="fa fa-check"></i><b>4</b> Datasets and dataframes</a><ul>
<li class="chapter" data-level="" data-path="looking-at-data.html"><a href="looking-at-data.html"><i class="fa fa-check"></i>Looking at data</a></li>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i>Importing and exporting data</a><ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#importing-data-from-the-web"><i class="fa fa-check"></i>Importing data over the web</a></li>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#importing-proprietary-formats"><i class="fa fa-check"></i>Importing from SPSS and other packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i>Working with dataframes</a><ul>
<li><a href="working-with-dataframes.html#tidyverse">Introducing the <code>tidyverse</code></a></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-columns"><i class="fa fa-check"></i>Selecting columns from a dataframe</a></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#selecting-rows"><i class="fa fa-check"></i>Selecting rows of data</a></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#combining-column-selections-and-row-filters"><i class="fa fa-check"></i>Combining column selections and row filters</a></li>
<li><a href="working-with-dataframes.html#pipes"></a></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#mutate"><i class="fa fa-check"></i>Modifying and creating new columns</a></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#sorting"><i class="fa fa-check"></i>Sorting data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>5</b> Working with ‘real’ data</a><ul>
<li class="chapter" data-level="" data-path="storing-data.html"><a href="storing-data.html"><i class="fa fa-check"></i>Storing your data</a><ul>
<li class="chapter" data-level="" data-path="storing-data.html"><a href="storing-data.html#use-csv"><i class="fa fa-check"></i>CSV files are your friend</a></li>
<li class="chapter" data-level="" data-path="storing-data.html"><a href="storing-data.html#save-intermediate-steps"><i class="fa fa-check"></i>Save processes, not outcomes</a></li>
<li class="chapter" data-level="" data-path="storing-data.html"><a href="storing-data.html#rds-files"><i class="fa fa-check"></i>RDS files can be useful to preserve R objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html"><i class="fa fa-check"></i>Types of variable</a><ul>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#numeric-variables"><i class="fa fa-check"></i>Numeric variables</a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#character-and-factor"><i class="fa fa-check"></i>Characters, factors (and booleans)</a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#dates"><i class="fa fa-check"></i>Dates</a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#missing-values"><i class="fa fa-check"></i>Missing values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="missing.html"><a href="missing.html"><i class="fa fa-check"></i>Missing values</a></li>
<li class="chapter" data-level="" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i>Tidying data</a><ul>
<li class="chapter" data-level="" data-path="tidying-data.html"><a href="tidying-data.html#reshaping"><i class="fa fa-check"></i>Reshaping</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dealing-with-multiple-files.html"><a href="dealing-with-multiple-files.html"><i class="fa fa-check"></i>Dealing with multiple files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>6</b> Summarising data</a><ul>
<li class="chapter" data-level="" data-path="utility-functions-for-descriptive-statistics.html"><a href="utility-functions-for-descriptive-statistics.html"><i class="fa fa-check"></i>Utility functions for descriptive statistics</a><ul>
<li class="chapter" data-level="" data-path="utility-functions-for-descriptive-statistics.html"><a href="utility-functions-for-descriptive-statistics.html#frequency-tables"><i class="fa fa-check"></i>Frequency tables</a></li>
<li class="chapter" data-level="" data-path="utility-functions-for-descriptive-statistics.html"><a href="utility-functions-for-descriptive-statistics.html#summary-statistics"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="utility-functions-for-descriptive-statistics.html"><a href="utility-functions-for-descriptive-statistics.html#creating-a-data-frame-of-summary-statistics"><i class="fa fa-check"></i>Creating a data frame of summary statistics</a></li>
<li class="chapter" data-level="6.0.1" data-path="utility-functions-for-descriptive-statistics.html"><a href="utility-functions-for-descriptive-statistics.html#computing-statistics-by-groups--v"><i class="fa fa-check"></i><b>6.0.1</b> Computing statistics by-groups {-}v</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="split-apply-combine.html"><a href="split-apply-combine.html"><i class="fa fa-check"></i>A generalised approach: Split, apply, combine</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>7</b> Graphics</a><ul>
<li class="chapter" data-level="" data-path="graphics-benefits.html"><a href="graphics-benefits.html"><i class="fa fa-check"></i>Benefits of visualising data</a></li>
<li class="chapter" data-level="" data-path="graphics-approaches.html"><a href="graphics-approaches.html"><i class="fa fa-check"></i>Which tool to use?</a></li>
<li><a href="layered-graphics.html#layered-graphics">Layered graphics with <code>ggplot</code></a><ul>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html"><i class="fa fa-check"></i>A thought on ‘chart chooser’ guides</a></li>
<li><a href="layered-graphics.html#thinking-like-ggplot">Thinking like <code>ggplot</code></a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#relationships"><i class="fa fa-check"></i>‘Relationships’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#distributions"><i class="fa fa-check"></i>‘Distributions’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#comparisons"><i class="fa fa-check"></i>‘Comparisons’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#composition"><i class="fa fa-check"></i>‘Composition’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html"><i class="fa fa-check"></i>‘Quick and dirty’ (utility) plots</a><ul>
<li class="chapter" data-level="7.0.1" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#distributions-1"><i class="fa fa-check"></i><b>7.0.1</b> Distributions</a></li>
<li class="chapter" data-level="7.0.2" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#relationships-1"><i class="fa fa-check"></i><b>7.0.2</b> Relationships</a></li>
<li class="chapter" data-level="7.0.3" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#quantities"><i class="fa fa-check"></i><b>7.0.3</b> Quantities</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html"><i class="fa fa-check"></i>Tricks with ggplot</a><ul>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html#facetting-plots"><i class="fa fa-check"></i>More ways to facet a plot</a></li>
<li><a href="ggplot-details.html#facet_wrap"><code>facet_wrap</code></a></li>
<li><a href="ggplot-details.html#facet_grid"><code>facet_grid</code></a></li>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html#combining-plots"><i class="fa fa-check"></i>Combining separate plots in a grid</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exporting-graphics.html"><a href="exporting-graphics.html"><i class="fa fa-check"></i>Exporting for print</a></li>
</ul></li>
<li class="part"><span><b>III Analysis</b></span></li>
<li class="chapter" data-level="8" data-path="basic-inferential-statistics.html"><a href="basic-inferential-statistics.html"><i class="fa fa-check"></i><b>8</b> Basic inferential statistics</a><ul>
<li><a href="crosstabs.html#crosstabs">Crosstabulations and <sup>2</sup></a><ul>
<li class="chapter" data-level="" data-path="crosstabs.html"><a href="crosstabs.html"><i class="fa fa-check"></i>Three-way tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i>Correlations</a><ul>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-matrix"><i class="fa fa-check"></i>Creating a correlation matrix</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#working-with-correlation-matrices"><i class="fa fa-check"></i>Working with correlation matrices</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-tables-for-publication"><i class="fa fa-check"></i>Tables for publication</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-methods"><i class="fa fa-check"></i>Other methods for correlation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i>t-tests</a><ul>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html#visualising-your-data-first"><i class="fa fa-check"></i>Visualising your data first</a></li>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html#running-a-t-test"><i class="fa fa-check"></i>Running a t-test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>9</b> Regression</a><ul>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#formulae"><i class="fa fa-check"></i>Describing statistical models using formulae</a></li>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#running-a-linear-model"><i class="fa fa-check"></i>Running a linear model</a></li>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#more-on-formulas"><i class="fa fa-check"></i>More on formulas</a></li>
<li class="chapter" data-level="" data-path="factors-and-variable-codings.html"><a href="factors-and-variable-codings.html"><i class="fa fa-check"></i>Factors and variable codings</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html"><i class="fa fa-check"></i>Model specification</a><ul>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#regression-coding"><i class="fa fa-check"></i>Effect/dummy coding and contrasts</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#centering"><i class="fa fa-check"></i>Centering (is often helpful)</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#scaling-regression-inputs"><i class="fa fa-check"></i>Scaling inputs</a></li>
<li class="chapter" data-level="9.0.1" data-path="parameterisation.html"><a href="parameterisation.html#alternatives-to-rescaling"><i class="fa fa-check"></i><b>9.0.1</b> Alternatives to rescaling</a></li>
<li class="chapter" data-level="9.0.2" data-path="parameterisation.html"><a href="parameterisation.html#what-next"><i class="fa fa-check"></i><b>9.0.2</b> What next</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>10</b> Anova</a><ul>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#rules-for-using-anova-in-r"><i class="fa fa-check"></i>Rules for using Anova in R</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#anova-recommendations"><i class="fa fa-check"></i>Recommendations for doing Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html"><i class="fa fa-check"></i>Anova ‘Cookbook’</a><ul>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#between-subjects-anova"><i class="fa fa-check"></i>Between-subjects Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#repeated-measures"><i class="fa fa-check"></i>Repeated measures or ‘split plot’ designs</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#trad-rm-anova"><i class="fa fa-check"></i>Traditional repeated measures Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#comparison-with-a-multilevel-model"><i class="fa fa-check"></i>Comparison with a multilevel model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="checking-assumptions.html"><a href="checking-assumptions.html"><i class="fa fa-check"></i>Checking assumptions</a></li>
<li class="chapter" data-level="" data-path="followup-tests.html"><a href="followup-tests.html"><i class="fa fa-check"></i>Followup tests</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>11</b> Understanding interactions</a><ul>
<li class="chapter" data-level="" data-path="what-is-an-interaction.html"><a href="what-is-an-interaction.html"><i class="fa fa-check"></i>What is an interaction?</a></li>
<li class="chapter" data-level="" data-path="visualising-interactions-from-raw-data.html"><a href="visualising-interactions-from-raw-data.html"><i class="fa fa-check"></i>Visualising interactions from raw data</a><ul>
<li class="chapter" data-level="" data-path="visualising-interactions-from-raw-data.html"><a href="visualising-interactions-from-raw-data.html#pain-music-data"><i class="fa fa-check"></i>A painful example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="continuous-predictors.html"><a href="continuous-predictors.html"><i class="fa fa-check"></i>Continuous predictors</a></li>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html"><i class="fa fa-check"></i>Making predictions</a><ul>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predictions-vs-margins"><i class="fa fa-check"></i>Predictions vs margins</a></li>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means"><i class="fa fa-check"></i>Predicted means</a></li>
<li><a href="predictions-and-margins.html#effects-margins"><em>Effects</em> (margins)</a></li>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#continuous-predictors-1"><i class="fa fa-check"></i>Continuous predictors</a></li>
</ul></li>
<li><a href="predicted-means-and-margins-using-lm.html#predicted-means-and-margins-using-lm">Predicted means and margins using <code>lm()</code></a><ul>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html"><i class="fa fa-check"></i>Running the model</a></li>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html#making-predictions-for-means"><i class="fa fa-check"></i>Making predictions for means</a></li>
<li><a href="predicted-means-and-margins-using-lm.html#making-prdictions-for-margins-effects-of-predictors">Making prdictions for margins (<em>effects</em> of predictors)</a></li>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html#marginal-effects"><i class="fa fa-check"></i>Marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="predictions-with-continuous-covariates.html"><a href="predictions-with-continuous-covariates.html"><i class="fa fa-check"></i>Predictions with continuous covariates</a></li>
<li class="chapter" data-level="" data-path="visualising-interactions.html"><a href="visualising-interactions.html"><i class="fa fa-check"></i>Visualising interactions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="general-linear-models.html"><a href="general-linear-models.html"><i class="fa fa-check"></i><b>12</b> General linear models</a><ul>
<li class="chapter" data-level="" data-path="general-linear-models.html"><a href="general-linear-models.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>13</b> Mediation</a></li>
<li class="chapter" data-level="14" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>14</b> Multilevel models</a><ul>
<li><a href="the-sleepstudy-data-and-traditional-rm-anova.html#the-sleepstudy-data-and-traditional-rm-anova">The <code>sleepstudy</code> data and traditional RM Anova</a><ul>
<li><a href="the-sleepstudy-data-and-traditional-rm-anova.html#fit-a-simple-slope-for-days">Fit a simple slope for <code>Days</code></a></li>
<li class="chapter" data-level="" data-path="the-sleepstudy-data-and-traditional-rm-anova.html"><a href="the-sleepstudy-data-and-traditional-rm-anova.html"><i class="fa fa-check"></i>Allow the effect of sleep deprivation to vary for different participants</a></li>
<li><a href="the-sleepstudy-data-and-traditional-rm-anova.html#fitting-a-curve-for-the-effect-of-days">Fitting a curve for the effect of <code>Days</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="icc-and-vpc.html"><a href="icc-and-vpc.html"><i class="fa fa-check"></i>Intraclass correlations</a></li>
<li class="chapter" data-level="" data-path="arguments-for-fitting-mixed-models-via-mcmc.html"><a href="arguments-for-fitting-mixed-models-via-mcmc.html"><i class="fa fa-check"></i>Arguments for fitting mixed models via MCMC</a></li>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html"><i class="fa fa-check"></i>Troubleshooting</a><ul>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html#simplifying-mixed-models"><i class="fa fa-check"></i>Convergence problems and simplifying the random effects structure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="covariance-modelling.html"><a href="covariance-modelling.html"><i class="fa fa-check"></i><b>15</b> Covariance modelling</a><ul>
<li class="chapter" data-level="" data-path="path-models.html"><a href="path-models.html"><i class="fa fa-check"></i>Path models</a><ul>
<li class="chapter" data-level="" data-path="path-models.html"><a href="path-models.html#defining-the-model"><i class="fa fa-check"></i>Defining the model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory factor analysis (CFA)</a><ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#defining-the-model-1"><i class="fa fa-check"></i>Defining the model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-fit.html"><a href="model-fit.html"><i class="fa fa-check"></i>Model fit</a></li>
<li class="chapter" data-level="" data-path="modification-indices.html"><a href="modification-indices.html"><i class="fa fa-check"></i>Modification indices</a></li>
<li class="chapter" data-level="" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i>Missing data</a></li>
<li class="chapter" data-level="" data-path="sem.html"><a href="sem.html"><i class="fa fa-check"></i>Structural eqution modelling</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>16</b> Power analysis in R</a><ul>
<li class="chapter" data-level="" data-path="power-analysis.html"><a href="power-analysis.html#for-most-inferential-statistics"><i class="fa fa-check"></i>For most inferential statistics</a></li>
<li class="chapter" data-level="" data-path="power-analysis.html"><a href="power-analysis.html#for-multilevel-or-generalised-linear-models"><i class="fa fa-check"></i>For multilevel or generalised linear models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="additional-stub-articles.html"><a href="additional-stub-articles.html"><i class="fa fa-check"></i><b>17</b> Additional stub articles</a><ul>
<li class="chapter" data-level="" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i>Meta analysis</a></li>
<li class="chapter" data-level="" data-path="bayes-factors.html"><a href="bayes-factors.html"><i class="fa fa-check"></i>Bayes factors</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html"><i class="fa fa-check"></i><b>18</b> Baysian linear model fitting with MCMC</a><ul>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#posterior-probabilities-for-parameters"><i class="fa fa-check"></i>Posterior probabilities for parameters</a></li>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#credible-intervals"><i class="fa fa-check"></i>Credible intervals</a></li>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#bayesian-p-values-for-parameters"><i class="fa fa-check"></i>Bayesian ‘p values’ for parameters</a></li>
</ul></li>
<li class="part"><span><b>IV Loose ends</b></span></li>
<li class="chapter" data-level="19" data-path="statistical-explanations.html"><a href="statistical-explanations.html"><i class="fa fa-check"></i><b>19</b> Statistical explanations</a><ul>
<li class="chapter" data-level="" data-path="intervals.html"><a href="intervals.html"><i class="fa fa-check"></i>Confidence, credible and prediction intervals</a><ul>
<li class="chapter" data-level="" data-path="intervals.html"><a href="intervals.html#the-problem-with-confidence-intervals"><i class="fa fa-check"></i>The problem with confidence intervals</a></li>
<li class="chapter" data-level="" data-path="intervals.html"><a href="intervals.html#forgetting-that-the-ci-depends-on-sample-size."><i class="fa fa-check"></i>Forgetting that the CI depends on sample size.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i>Multiple comparisons</a><ul>
<li class="chapter" data-level="19.0.1" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#p-values-and-false-discoveries"><i class="fa fa-check"></i><b>19.0.1</b> <em>p</em> values and ‘false discoveries’</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-tests-on-the-same-data"><i class="fa fa-check"></i>Multiple tests on the same data</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#what-to-do-about-it"><i class="fa fa-check"></i>What to do about it?</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#practical-examples"><i class="fa fa-check"></i>Practical examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="link-functions.html"><a href="link-functions.html"><i class="fa fa-check"></i>Link functions and transformation</a><ul>
<li class="chapter" data-level="" data-path="link-functions.html"><a href="link-functions.html#logistic-link-function"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-comparison-and-selection.html"><a href="model-comparison-and-selection.html"><i class="fa fa-check"></i>Model comparison and selection</a><ul>
<li class="chapter" data-level="" data-path="model-comparison-and-selection.html"><a href="model-comparison-and-selection.html#models-are-imperfect"><i class="fa fa-check"></i>Models are imperfect</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-selection.html"><a href="model-comparison-and-selection.html#over-fitting"><i class="fa fa-check"></i>Overfitting/underfitting</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-selection.html"><a href="model-comparison-and-selection.html#variable-selection"><i class="fa fa-check"></i>Choosing the ‘right variables’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i>Goodness of fit statistics</a><ul>
<li class="chapter" data-level="" data-path="gof.html"><a href="gof.html#model-improvement"><i class="fa fa-check"></i>Model modification and improvment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="r-details.html"><a href="r-details.html"><i class="fa fa-check"></i><b>20</b> R details</a><ul>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html"><i class="fa fa-check"></i>Installation</a><ul>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html#rstudio-server"><i class="fa fa-check"></i>RStudio Server</a></li>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html#local-install"><i class="fa fa-check"></i>Installing on your own machine.</a></li>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html#dependencies"><i class="fa fa-check"></i>Package dependencies</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>Loading packages</a></li>
<li class="chapter" data-level="" data-path="named-colours.html"><a href="named-colours.html"><i class="fa fa-check"></i>Named colours in R</a><ul>
<li class="chapter" data-level="" data-path="named-colours.html"><a href="named-colours.html#color-brewer"><i class="fa fa-check"></i>ColourBrewer with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i>Getting help</a><ul>
<li class="chapter" data-level="" data-path="getting-help.html"><a href="getting-help.html#backtick-location"><i class="fa fa-check"></i>Finding the backtick on your keyboard</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code-reuse.html"><a href="code-reuse.html"><i class="fa fa-check"></i>Re-using code</a><ul>
<li class="chapter" data-level="" data-path="code-reuse.html"><a href="code-reuse.html#helper-functions"><i class="fa fa-check"></i>Writing helper functions</a></li>
<li><a href="code-reuse.html#ggplot-reuse">Re-using code with <code>ggplot</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Sharing</b></span></li>
<li class="chapter" data-level="21" data-path="sharing-and-publication.html"><a href="sharing-and-publication.html"><i class="fa fa-check"></i><b>21</b> Sharing and publishing your work</a><ul>
<li class="chapter" data-level="" data-path="extract-results-from-models.html"><a href="extract-results-from-models.html"><i class="fa fa-check"></i>Extracting results from models</a></li>
<li class="chapter" data-level="" data-path="process-model-results.html"><a href="process-model-results.html"><i class="fa fa-check"></i>Process your results</a></li>
<li class="chapter" data-level="" data-path="output-tables.html"><a href="output-tables.html"><i class="fa fa-check"></i>Printing tables</a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html"><i class="fa fa-check"></i>APA formatting for free</a><ul>
<li><a href="apa-output.html#chi2">Chi<sup>2</sup></a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html#t-test"><i class="fa fa-check"></i>T-test</a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html#anova-1"><i class="fa fa-check"></i>Anova</a></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-models"><i class="fa fa-check"></i>Multilevel models</a></li>
<li class="chapter" data-level="21.0.1" data-path="apa-output.html"><a href="apa-output.html#publication"><i class="fa fa-check"></i><b>21.0.1</b> Publication</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>22</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘Just enough’ R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="layered-graphics" class="section level2 unnumbered">
<h2>Layered graphics with <code>ggplot</code></h2>
<p>If you’ve never given much thought to data visualisation before, you might be surprised at the sheer variety of graphs types available.</p>
<p>One way to cut through the multituyde of options is to determine what the purpose of your plot is. Although not a complete list, it’s likely your plot will show at least one of:</p>
<ul>
<li>Relationships</li>
<li>Distributions</li>
<li>Comparison</li>
<li>Composition</li>
</ul>
<p>The <code>ggplot</code> library makes it easy to produce high quality graphics which serve these ends, and to layer them to produce information-dense plots which are really effective forms of communication.</p>
<div class="figure"><span id="fig:unnamed-chunk-3"></span>
<img src="graphics_files/figure-html/unnamed-chunk-3-1.png" alt="Examples of charts showing comaprisons, relationships, distribution and composition. The comparison, distribution and composition plots show 2 variables, but the relationship plot includes 3, increasing the density of the information displayed. " width="768" />
<p class="caption">
Figure 7.1: Examples of charts showing comaprisons, relationships, distribution and composition. The comparison, distribution and composition plots show 2 variables, but the relationship plot includes 3, increasing the density of the information displayed.
</p>
</div>
<div id="a-thought-on-chart-chooser-guides" class="section level3 unnumbered explainer">
<h3>A thought on ‘chart chooser’ guides</h3>
<p>There are various simple chart selection guides available online, of which these are quite nice examples:</p>
<ul>
<li><a href="http://extremepresentation.typepad.com/blog/2006/09/choosing_a_good.html">Chart selection guide (pdf)</a>]</li>
<li><a href="https://www.perceptualedge.com/articles/misc/Graph_Selection_Matrix.pdf">‘Show me the numbers’ chart guide (pdf)</a></li>
</ul>
<div class="figure">
<img src="media/choosing_a_good_chart.jpg" />

</div>
<p><em>However</em>, guides which attempt to be comprehensive and show you a full range of plot types are perhaps not as useful as those which reflect our knowledge of which plots are the most effective forms of communication.</p>
<p>For example, almost all guides to plotting, and especially R textbooks, will show you how to plot a simple bar graph. But bar graphs have numerous disadvantages over other plots which can show the same information.</p>
<p>Specifically, they:</p>
<ul>
<li><p>are low in information density (and so inefficient in use of space)</p></li>
<li><p>make comparisons between multiple data series very difficult (for example in <a href="understanding-interactions.html#understanding-interactions">interaction plots</a>), and</p></li>
<li><p>perhaps most importantly, even when they include error bars, readers consistently misinterpret the quantitative information in bar graphs (specifically, when bar graphs are used to display estimates which contain error, readers assume points above the bar are less likely than points within the bar, even though this is typically not the case).</p></li>
</ul>
<p>You should be guided in choosing plots not by mechanical rules based on the number or type of variables you want to display. Instead, you should be guided by the evidence from basic studies of human perception, and applied data on how different types of infromation displays are really used by readers.</p>
<p>This guide is restricted to examples likely to be useful and effective for experiemental and applied psychologists.</p>
</div>
<div id="thinking-like-ggplot" class="section level3 unnumbered">
<h3>Thinking like <code>ggplot</code></h3>
<p>When using <code>ggplot</code> it helps to think of five separate steps to making a plot (2 are optional, but commonly used):</p>
<ol style="list-style-type: decimal">
<li><p>Choose the data you want to plot.</p></li>
<li><p>Map variables to axes or other features of the plot (e.g. sizes or colours).</p></li>
<li><p>(Optionally) use <code>ggplot</code> functions to summarise your data before the plot is drawn (e.g. to calulate means and standard errors for point-range plots).</p></li>
<li><p>Add visual display layers.</p></li>
<li><p>(Optionally) Split the plot up across multiple panels using groupings in the data.</p></li>
</ol>
<p>You can then customise the plot labels and title, and tweak other presentation parameters, although this often isn’t necessary unless sending a graphic for publication. You can also export graphics in multiple high quality formats.</p>
<p>The simplest way to demonstrate these steps is with an example, and we begin with a plot showing the relationship betwen variables:</p>
</div>
<div id="relationships" class="section level3 unnumbered">
<h3>‘Relationships’</h3>
<p>Problem to be solved: <em>You want to check/show whether variables are related in a linear fashion, e.g. before running linear regression</em></p>
<div id="step-1-select-data-to-plot" class="section level5 unnumbered">
<h5>Step 1: Select data to plot</h5>
<p>Step 1 is to select our data. As is typical in R, <code>ggplot</code> works best with long-format data. In the examples below we will use the <code>mtcars</code> dataset for convenience, so our first line of code is to use the <code>dplyr</code> pipe symbol (operator) to send the <code>mtcars</code> dataset to the next line of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>...</code></pre></div>
</div>
<div id="step-2-map-variables-to-axes-colours-and-other-features" class="section level5 unnumbered">
<h5>Step 2: Map variables to axes, colours, and other features</h5>
<p>Step 2 is to map the variables we want to axes or other features of the plot (e.g. the colours of points, or the linetypes used in line plots).</p>
<p>The specify these mappings we use the <code>aes()</code> function, which is slightly cryptic, but short for ‘aesthetics mapping’. Depending on the plot type you will specify different aesthetics, and they can also have different effects depending on the plot type, but you will commonly specify:</p>
<ul>
<li><code>x</code> the variable to use as the x axis</li>
<li><code>y</code> the variable to use as the y axis</li>
<li><code>colour</code>: the variable to use to colour points or lines</li>
</ul>
<p>Here we tell <code>ggplot</code> to use <code>disp</code> (engine size) on the x axis, and <code>mpg</code> on the y axis. We also tell it to colour the points differently depending on the value of <code>hp</code> (engine horsepower).</p>
<p>At this point <code>ggplot</code> will create and label the axes and plot area, but doesn’t yet display any of our data. For this we need to add visual display layers (in the next step).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg, <span class="dt">colour=</span>hp))</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="aesthetics" class="section level6 unnumbered explainer">
<h6>Other aesthetics</h6>
<p>There are many other aesthetics which can be specified. Some of the most useful are:</p>
<ul>
<li><code>ymin</code> and <code>ymax</code>: for upper and lower bounds, e.g. on error bars</li>
<li><code>group</code>:which tells ggplot to group observations by some variable and, for example, plot a different line per-group)</li>
<li><code>fill</code>: like <code>colour</code> but for areas/shapes</li>
<li><code>alpha</code> and <code>size</code>: control the size and opacity of visual features (useful for de-emphasising some features of a plot to make others stand out)</li>
</ul>
<p>See the ggplot documentation for more details: <a href="http://ggplot2.tidyverse.org/reference/#section-aesthetics" class="uri">http://ggplot2.tidyverse.org/reference/#section-aesthetics</a></p>
</div>
</div>
<div id="step-3" class="section level5 unnumbered">
<h5>Step 3</h5>
<p>We skip step 3 for this example (asking ggplot to automatically make summaries of our data before plotting), but will cover it below - see the <code>stat_summary()</code> function.</p>
</div>
<div id="step-4-display-data" class="section level5 unnumbered">
<h5>Step 4: Display data</h5>
<p>To display data, we have to add a visual layer to the plot. For example, let’s say we want to make a scatter plot, and so draw points for each row of data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg, <span class="dt">colour=</span>hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>And we have a pretty slick graph: <code>ggplot</code> has now added points for each pair of <code>disp</code> and <code>mpg</code> values, and coloured them according to the value of <code>hp</code> (see choosing colours below XXX).</p>
<p><span class="exercise">Use the <code>airquality</code> dataset and create your own scatterplot and try to colour the points using the <code>Month</code> variable. Should <code>Month</code> be used as a factor or a numeric variable when colouring the points?</span></p>
<p>What’s even neater about <code>ggplot</code> though is how easy it is to <em>layer</em> different visualisations of the same data. These visual layers are called <code>geom</code>’s and the functions which add them are all prefixed with <code>geom_</code>, so <code>geom_point()</code> for scatter plots, or <code>geom_line()</code> for line plots, or <code>geom_smooth()</code> for a smoothed line plot. We can add this to the scatter plot like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg, <span class="dt">colour=</span>hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F, <span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>) </code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>In the example above, I have also customised the smoothed line, making it grey to avoid over-intrusion into our perception of the points. Often less is more when plotting graphs: not everything can be emphasised at once, and <em>it’s important to make decisions about what should be given visual priority</em>.</p>
</div>
<div id="step-5-splitting-up-or-repeating-the-plot." class="section level5 unnumbered">
<h5>Step 5: ‘Splitting up’ or repeating the plot.</h5>
<p>Very often, you will have drawn plot and think things like <em>I wonder what that would look like if I drew it for men and women separately?</em>. In <code>ggplot</code> this is called facetting, and is easy to achieve, provided your data are in a long format.</p>
<p>Using the same <code>mtcars</code> example, let’s say we wanted separate panels for American vs. Foreign cars (information held in the <code>am</code> variable). We simply add the <code>facet_wrap()</code>, and specify the <code>&quot;am&quot;</code> variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg, <span class="dt">colour=</span>hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F, <span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;am&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>One trick is to make sure factors are labelled nicely, because these labels appear on the final plot. Here the <code>mutate()</code> call <a href="real-data.html#factors-and-numerics">relabels the factor</a> which makes the plot easier to read:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">american =</span> <span class="kw">factor</span>(am, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;American&quot;</span>, <span class="st">&quot;Foreign&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> disp, <span class="dt">y =</span> mpg, <span class="dt">colour=</span>hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F, <span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;american&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><a href="http://ggplot2.tidyverse.org/reference/#section-facetting">See the ggplot documentation on facetting for more details</a>.</p>
</div>
</div>
<div id="distributions" class="section level3 unnumbered">
<h3>‘Distributions’</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reaction)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Imagine we wanted to compare distributions for individuals. Simply overlaying the lines is confusing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reaction, <span class="dt">group=</span>Subject)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Facetting produces a nicer result:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reaction)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="st">&quot;Subject&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>But we could present the same information more compactly, and with better facility to compare between subjects, if we use a bottleplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Subject, Reaction)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>() </code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>We might want to plot our Subjects in order of their mean RT:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.ranked.sleep &lt;-<span class="st"> </span>lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Subject) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># calculate mean RT</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">RTm =</span> <span class="kw">mean</span>(Reaction)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># sort by mean RT</span>
<span class="st">  </span><span class="kw">arrange</span>(RTm, Days) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># create a rank score but conert to factor right away </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SubjectRank =</span> <span class="kw">factor</span>(<span class="kw">dense_rank</span>(RTm)))

mean.ranked.sleep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(SubjectRank, Reaction)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">aspect.ratio =</span> .<span class="dv">33</span>)  <span class="co"># change the aspect ratio to make long and wide</span></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Or we might want to compare individuals against the combined distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># duplicate all the data, assigning one-replication to a single subject, &quot;All&quot;</span>
sleep.repeat &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(lme4<span class="op">::</span>sleepstudy,
                          lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Subject=</span><span class="st">&quot;All&quot;</span>))
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector

sleep.repeat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">all =</span> Subject<span class="op">==</span><span class="st">&quot;All&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Subject, Reaction, <span class="dt">color=</span>all)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="co"># turn off he legend because we don&#39;t really need it</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">aspect.ratio =</span> .<span class="dv">25</span>)  <span class="co"># change the aspect ratio to make long and wide</span></code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Boxplots can also work well to show distributions, and have the advantage of showing the median explicitly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.ranked.sleep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(SubjectRank, Reaction)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() </code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>If we plot the same data by-day, we can clearly see the effect of sleep deprivation, and the increase in variability between subjects as sime goes on: the lack of sleeps seems to be affecting some subjects more than others</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme4<span class="op">::</span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(Days), Reaction)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() </code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="comparisons" class="section level3 unnumbered">
<h3>‘Comparisons’</h3>
<p>Imagine we have rainfall and temperature data for various regions, across months:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DAAG<span class="op">::</span>bomregions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>psych<span class="op">::</span><span class="kw">describe</span>(<span class="dt">fast=</span>T) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>pander</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="21%" />
<col width="9%" />
<col width="5%" />
<col width="13%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">vars</th>
<th align="center">n</th>
<th align="center">mean</th>
<th align="center">sd</th>
<th align="center">min</th>
<th align="center">max</th>
<th align="center">range</th>
<th align="center">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Year</strong></td>
<td align="center">1</td>
<td align="center">109</td>
<td align="center">1954</td>
<td align="center">31.61</td>
<td align="center">1900</td>
<td align="center">2008</td>
<td align="center">108</td>
<td align="center">3.028</td>
</tr>
<tr class="even">
<td align="center"><strong>eastAVt</strong></td>
<td align="center">2</td>
<td align="center">99</td>
<td align="center">20.43</td>
<td align="center">0.4585</td>
<td align="center">19.35</td>
<td align="center">21.61</td>
<td align="center">2.255</td>
<td align="center">0.04608</td>
</tr>
<tr class="odd">
<td align="center"><strong>seAVt</strong></td>
<td align="center">3</td>
<td align="center">99</td>
<td align="center">14.59</td>
<td align="center">0.4547</td>
<td align="center">13.62</td>
<td align="center">15.94</td>
<td align="center">2.32</td>
<td align="center">0.0457</td>
</tr>
<tr class="even">
<td align="center"><strong>southAVt</strong></td>
<td align="center">4</td>
<td align="center">99</td>
<td align="center">18.48</td>
<td align="center">0.4584</td>
<td align="center">17.43</td>
<td align="center">19.53</td>
<td align="center">2.1</td>
<td align="center">0.04607</td>
</tr>
<tr class="odd">
<td align="center"><strong>swAVt</strong></td>
<td align="center">5</td>
<td align="center">99</td>
<td align="center">16.18</td>
<td align="center">0.4734</td>
<td align="center">15.08</td>
<td align="center">17.05</td>
<td align="center">1.97</td>
<td align="center">0.04758</td>
</tr>
<tr class="even">
<td align="center"><strong>westAVt</strong></td>
<td align="center">6</td>
<td align="center">99</td>
<td align="center">22.33</td>
<td align="center">0.4548</td>
<td align="center">21.22</td>
<td align="center">23.39</td>
<td align="center">2.165</td>
<td align="center">0.04571</td>
</tr>
<tr class="odd">
<td align="center"><strong>northAVt</strong></td>
<td align="center">7</td>
<td align="center">99</td>
<td align="center">24.6</td>
<td align="center">0.5042</td>
<td align="center">23.57</td>
<td align="center">25.94</td>
<td align="center">2.365</td>
<td align="center">0.05067</td>
</tr>
<tr class="even">
<td align="center"><strong>mdbAVt</strong></td>
<td align="center">8</td>
<td align="center">99</td>
<td align="center">17.59</td>
<td align="center">0.4958</td>
<td align="center">16.36</td>
<td align="center">18.79</td>
<td align="center">2.425</td>
<td align="center">0.04983</td>
</tr>
<tr class="odd">
<td align="center"><strong>auAVt</strong></td>
<td align="center">9</td>
<td align="center">99</td>
<td align="center">21.71</td>
<td align="center">0.4429</td>
<td align="center">20.67</td>
<td align="center">22.87</td>
<td align="center">2.195</td>
<td align="center">0.04452</td>
</tr>
<tr class="even">
<td align="center"><strong>eastRain</strong></td>
<td align="center">10</td>
<td align="center">109</td>
<td align="center">601.6</td>
<td align="center">123.8</td>
<td align="center">315.3</td>
<td align="center">1030</td>
<td align="center">715</td>
<td align="center">11.85</td>
</tr>
<tr class="odd">
<td align="center"><strong>seRain</strong></td>
<td align="center">11</td>
<td align="center">109</td>
<td align="center">598.1</td>
<td align="center">104.6</td>
<td align="center">354.9</td>
<td align="center">900.6</td>
<td align="center">545.7</td>
<td align="center">10.02</td>
</tr>
<tr class="even">
<td align="center"><strong>southRain</strong></td>
<td align="center">12</td>
<td align="center">109</td>
<td align="center">381.7</td>
<td align="center">68.63</td>
<td align="center">236</td>
<td align="center">618.2</td>
<td align="center">382.1</td>
<td align="center">6.574</td>
</tr>
<tr class="odd">
<td align="center"><strong>swRain</strong></td>
<td align="center">13</td>
<td align="center">109</td>
<td align="center">657.8</td>
<td align="center">103</td>
<td align="center">420.5</td>
<td align="center">988.8</td>
<td align="center">568.4</td>
<td align="center">9.861</td>
</tr>
<tr class="even">
<td align="center"><strong>westRain</strong></td>
<td align="center">14</td>
<td align="center">109</td>
<td align="center">352.2</td>
<td align="center">84.55</td>
<td align="center">173.5</td>
<td align="center">646.5</td>
<td align="center">473</td>
<td align="center">8.098</td>
</tr>
<tr class="odd">
<td align="center"><strong>northRain</strong></td>
<td align="center">15</td>
<td align="center">109</td>
<td align="center">520.7</td>
<td align="center">110.2</td>
<td align="center">312.8</td>
<td align="center">946.9</td>
<td align="center">634</td>
<td align="center">10.55</td>
</tr>
<tr class="even">
<td align="center"><strong>mdbRain</strong></td>
<td align="center">16</td>
<td align="center">109</td>
<td align="center">476</td>
<td align="center">110.9</td>
<td align="center">255.8</td>
<td align="center">821</td>
<td align="center">565.2</td>
<td align="center">10.62</td>
</tr>
<tr class="odd">
<td align="center"><strong>auRain</strong></td>
<td align="center">17</td>
<td align="center">109</td>
<td align="center">457.1</td>
<td align="center">82.55</td>
<td align="center">317.2</td>
<td align="center">785.3</td>
<td align="center">468.1</td>
<td align="center">7.906</td>
</tr>
<tr class="even">
<td align="center"><strong>SOI</strong></td>
<td align="center">18</td>
<td align="center">109</td>
<td align="center">-0.002676</td>
<td align="center">6.845</td>
<td align="center">-20.01</td>
<td align="center">20.79</td>
<td align="center">40.8</td>
<td align="center">0.6556</td>
</tr>
<tr class="odd">
<td align="center"><strong>co2mlo</strong></td>
<td align="center">19</td>
<td align="center">50</td>
<td align="center">345.6</td>
<td align="center">21.01</td>
<td align="center">316</td>
<td align="center">385.4</td>
<td align="center">69.47</td>
<td align="center">2.972</td>
</tr>
<tr class="even">
<td align="center"><strong>co2law</strong></td>
<td align="center">20</td>
<td align="center">79</td>
<td align="center">310.4</td>
<td align="center">9.586</td>
<td align="center">295.8</td>
<td align="center">333.7</td>
<td align="center">37.9</td>
<td align="center">1.078</td>
</tr>
<tr class="odd">
<td align="center"><strong>CO2</strong></td>
<td align="center">21</td>
<td align="center">109</td>
<td align="center">324.3</td>
<td align="center">24.59</td>
<td align="center">296.3</td>
<td align="center">385.4</td>
<td align="center">89.19</td>
<td align="center">2.355</td>
</tr>
<tr class="even">
<td align="center"><strong>sunspot</strong></td>
<td align="center">22</td>
<td align="center">109</td>
<td align="center">60.08</td>
<td align="center">47.69</td>
<td align="center">1.4</td>
<td align="center">190.2</td>
<td align="center">188.8</td>
<td align="center">4.568</td>
</tr>
</tbody>
</table>
<div id="extract-to-split-column-names" class="section level5 unnumbered">
<h5></h5>
<p>Because these data are in wide format (multiple columns have contain the same type of data) we need to first convert to long format. This process has become known as <a href="http://tidyr.tidyverse.org">tidying</a>.</p>
<p>The code below selects the columns related to rainfall and temperature and then ‘melts’ the data to long format: one row per observation. We then <code>extract</code> the region and the type of measurement from the <code>variable</code> column which is created by using a regular expression:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weather.data.long &lt;-<span class="st"> </span>DAAG<span class="op">::</span>bomregions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Year, <span class="kw">ends_with</span>(<span class="st">&#39;Rain&#39;</span>), <span class="kw">ends_with</span>(<span class="st">&#39;AVt&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>reshape2<span class="op">::</span><span class="kw">melt</span>(<span class="dt">id.var=</span><span class="st">&quot;Year&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">extract</span>(variable, 
          <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="st">&quot;variable&quot;</span>), 
          <span class="dt">regex=</span><span class="st">&quot;(east|north|se|south|west|sw|au)(</span><span class="ch">\\</span><span class="st">w+)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(variable))

weather.data.long <span class="op">%&gt;%</span><span class="st"> </span>head
##   Year Region variable  value
## 1 1900   east     Rain 429.98
## 2 1901   east     Rain 500.12
## 3 1902   east     Rain 315.33
## 4 1903   east     Rain 694.09
## 5 1904   east     Rain 564.86
## 6 1905   east     Rain 443.11</code></pre></div>
</div>
<div id="section-8" class="section level5 exercise">
<h5><span class="header-section-number">7.0.0.0.1</span> </h5>
<p>Try stepping through the code above line by line and see what is produced at each step.</p>
<p>With our data in long form we can use <code>ggplot</code> to plot our data over time. In the plot below, we use <code>filter()</code> to select only the rainfall measurements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rain &lt;-<span class="st"> </span>
<span class="st">  </span>weather.data.long <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(variable<span class="op">==</span><span class="st">&#39;Rain&#39;</span>)

rain <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Rainfall (mm)&#39;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>There are many ways to extract structure from these data, and make comparisons over time. One is to use colour:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rain <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, value, <span class="dt">color=</span>Region)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Rainfall (mm)&#39;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>It’s now easy to see the crude differences between the regions (west appears the driest, sw the wettest), but it’s still hard to compare between regions, or over time.</p>
<p>For this we can use various forms of summaries, for example a smoothed line plot (the shaded area is the standard error), which clearly shows the relative changes in rainfall in each region over time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rain <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, value, <span class="dt">color=</span>Region)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Rainfall (mm)&#39;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>It can sometimes be desireable to include points to preserve the relationship between the summary and the raw data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rain <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;west&#39;</span>, <span class="st">&#39;se&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, value, <span class="dt">color=</span>Region)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>, <span class="dt">size=</span>.<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Rainfall (mm)&#39;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>If we weren’t interested in the time series and just wanted to focus on the most recent year, we might take a different approach. Here a bar plot is used to compare between regions, with the national average (au) highlighted in blue:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rain <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(Year)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Region, value, <span class="dt">fill=</span>Region<span class="op">==</span><span class="st">&quot;au&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Rainfall (mm)&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span>F)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Finally, we shouldn’t forget that this dataset included both rainfall and temperature data, and we can display these in different ways, depending on what our research question was.</p>
<p>In this case we can use facetting to display temperature and rainfall data side by side. Because AVt and Rain are on such different scales we need to allow the y axis to vary between variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weather.data.long <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, value, <span class="dt">color=</span>Region)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>)
## Warning: Removed 70 rows containing non-finite values (stat_smooth).</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<!-- ```{r} -->
<!-- dataurl <- function(year, country){ -->
<!--   sprintf("https://www.census.gov/population/international/data/idb/region.php?N=Results&T=10&A=separate&RT=0&Y=%.0f&R=-1&C=%s", 2017, "UK") -->
<!-- } -->
<!-- df <- read.csv(dataurl(2017, 'UK')) -->
<!-- ``` -->
</div>
</div>
<div id="composition" class="section level3 unnumbered">
<h3>‘Composition’</h3>
<div id="waffle-plots-or-pictograms" class="section level4 unnumbered">
<h4>Waffle plots or ‘pictograms’</h4>
<p>Waffle plots are neat way of showing the relative frequency of different categories.</p>
<p>In applied settings it’s well known that when considering the risks or benefits of interventions clinicans, patients and researchers benefit from statements made using ‘natural frequencies’ <span class="citation">(Gigerenzer and Edwards <a href="#ref-gigerenzer2003simple">2003</a>)</span>, and pictographs or ‘waffle plots’ have been shown to provide patients and their families with a better understanding of the risks of treatments <span class="citation">(Tait et al. <a href="#ref-tait2010presenting">2010</a>)</span>.</p>
<p>Waffle plots can be implemented in R via the <code>waffle::</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outcomes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gained weight&quot;</span>=<span class="dv">13</span>, 
              <span class="st">&quot;no change&quot;</span>=<span class="dv">27</span>, 
              <span class="st">&quot;lost 2kg or more&quot;</span> =<span class="st"> </span><span class="dv">44</span>, 
              <span class="st">&quot;lost 5kg or more&quot;</span> =<span class="st"> </span><span class="dv">16</span>)

waffle<span class="op">::</span><span class="kw">waffle</span>(outcomes)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p><span class="tip">Calculating these summary figures is left as an exercise to for the reader, but see the section on <a href="split-apply-combine.html#split-apply-combine">summarising data with dplyr</a>.</span></p>
<p>This is one of those occasions where the default ggplot colours could probably be improved, and we can do this by passing the <a href="named-colours.html#named-colours">names of the colours</a> we would like to use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight.loss.colours &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;firebrick2&#39;</span>, <span class="st">&#39;darkgoldenrod1&#39;</span>, <span class="st">&#39;palegreen3&#39;</span>, <span class="st">&#39;palegreen4&#39;</span>)
waffle<span class="op">::</span><span class="kw">waffle</span>(outcomes, <span class="dt">colors =</span> weight.loss.colours)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Selecting colours by hand isn’t always the best way though: the <a href="named-colours.html#color-brewer"><code>colourbrewer</code> library provides some nice shortcuts</a> for using palletes from the excellent <a href="http://colorbrewer2.org">ColourBrewer website</a>.</p>
</div>
<div id="stacked-bars" class="section level4 unnumbered">
<h4>Stacked bars</h4>
<p>The <code>reshape2</code> package includes data on tipping habits in restaurants for male and female bill-payers, and where the party was fo various <code>size</code>s:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reshape2<span class="op">::</span>tips <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>pander</code></pre></div>
<table style="width:76%;">
<colgroup>
<col width="18%" />
<col width="8%" />
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">total_bill</th>
<th align="center">tip</th>
<th align="center">sex</th>
<th align="center">smoker</th>
<th align="center">day</th>
<th align="center">time</th>
<th align="center">size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">16.99</td>
<td align="center">1.01</td>
<td align="center">Female</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">10.34</td>
<td align="center">1.66</td>
<td align="center">Male</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">21.01</td>
<td align="center">3.5</td>
<td align="center">Male</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">23.68</td>
<td align="center">3.31</td>
<td align="center">Male</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">24.59</td>
<td align="center">3.61</td>
<td align="center">Female</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">25.29</td>
<td align="center">4.71</td>
<td align="center">Male</td>
<td align="center">No</td>
<td align="center">Sun</td>
<td align="center">Dinner</td>
<td align="center">4</td>
</tr>
</tbody>
</table>
<p>To begin, we might like to plot tips by time of day:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reshape2<span class="op">::</span>tips <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(time, tip)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>And to facilitate the comparison between men and women we could colour portions of the bars using <code>position_stack()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reshape2<span class="op">::</span>tips <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(time, tip, <span class="dt">fill=</span>sex)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>, <span class="dt">position=</span><span class="kw">position_stack</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Tip ($)&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Or to reverse the comparisons:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reshape2<span class="op">::</span>tips <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(sex, tip, <span class="dt">fill=</span>time)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>, <span class="dt">position=</span><span class="kw">position_stack</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Tip ($)&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-gigerenzer2003simple">
<p>Gigerenzer, Gerd, and Adrian Edwards. 2003. “Simple Tools for Understanding Risks: From Innumeracy to Insight.” <em>BMJ: British Medical Journal</em> 327 (7417). BMJ Publishing Group: 741.</p>
</div>
<div id="ref-tait2010presenting">
<p>Tait, Alan R, Terri Voepel-Lewis, Brian J Zikmund-Fisher, and Angela Fagerlin. 2010. “Presenting Research Risks and Benefits to Parents: Does Format Matter?” <em>Anesthesia and Analgesia</em> 111 (3). NIH Public Access: 718.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphics-approaches.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="utility-plotting-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Just enough R.pdf", "Just enough R.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
