<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Just Enough R</title>
  <meta name="description" content="Just Enough R">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Just Enough R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Just Enough R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="crosstabs.html">
<link rel="next" href="t-tests.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Just enough R</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> Working with R</a><ul>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html"><i class="fa fa-check"></i>Installation</a><ul>
<li class="chapter" data-level="" data-path="installation-intro.html"><a href="installation-intro.html#start-here"><i class="fa fa-check"></i>Workflow</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i>RMarkdown</a></li>
<li class="chapter" data-level="" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="first-commands.html"><a href="first-commands.html"><i class="fa fa-check"></i>First commands</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i>Naming things</a></li>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html"><i class="fa fa-check"></i>Vectors and lists</a><ul>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html#vector"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html#access-vector-elements"><i class="fa fa-check"></i>Accessing elements</a></li>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html#selecting-more-than-one-element"><i class="fa fa-check"></i>Selecting more than one element</a></li>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html#making-sequences"><i class="fa fa-check"></i>Making and slicing with sequences</a></li>
<li class="chapter" data-level="" data-path="vectors-and-lists.html"><a href="vectors-and-lists.html#conditional-slices"><i class="fa fa-check"></i>Conditional slicing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="processing-vectors.html"><a href="processing-vectors.html"><i class="fa fa-check"></i>Processing vectors</a><ul>
<li class="chapter" data-level="" data-path="processing-vectors.html"><a href="processing-vectors.html#making-new-vectors"><i class="fa fa-check"></i>Making new vectors</a></li>
<li class="chapter" data-level="" data-path="processing-vectors.html"><a href="processing-vectors.html#making-up-data-new-vectors"><i class="fa fa-check"></i>Making up data (new vectors)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="functions-to-learn-now.html"><a href="functions-to-learn-now.html"><i class="fa fa-check"></i>Functions to learn now</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i>Lists</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="2" data-path="datasets-dataframes.html"><a href="datasets-dataframes.html"><i class="fa fa-check"></i><b>2</b> Datasets and dataframes</a><ul>
<li class="chapter" data-level="" data-path="looking-at-data.html"><a href="looking-at-data.html"><i class="fa fa-check"></i>Looking at data</a><ul>
<li class="chapter" data-level="" data-path="looking-at-data.html"><a href="looking-at-data.html#using-individual-columns"><i class="fa fa-check"></i>Using individual columns</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i>Working with dataframes</a><ul>
<li><a href="working-with-dataframes.html#tidyverse">Introducing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selecting-columns.html"><a href="selecting-columns.html"><i class="fa fa-check"></i>Selecting columns</a></li>
<li class="chapter" data-level="" data-path="selecting-rows.html"><a href="selecting-rows.html"><i class="fa fa-check"></i>Selecting rows</a></li>
<li class="chapter" data-level="" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i>‘Operators’</a></li>
<li class="chapter" data-level="" data-path="sorting.html"><a href="sorting.html"><i class="fa fa-check"></i>Sorting</a></li>
<li class="chapter" data-level="" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i>Pipes</a></li>
<li class="chapter" data-level="" data-path="mutate.html"><a href="mutate.html"><i class="fa fa-check"></i>Modifying and creating new columns</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>3</b> ‘Real’ data</a><ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i>Importing data</a><ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#importing-data-from-the-web"><i class="fa fa-check"></i>Importing data over the web</a></li>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#importing-proprietary-formats"><i class="fa fa-check"></i>Importing from SPSS and other packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="saving-and-exporting.html"><a href="saving-and-exporting.html"><i class="fa fa-check"></i>Saving and exporting</a><ul>
<li class="chapter" data-level="" data-path="saving-and-exporting.html"><a href="saving-and-exporting.html#use-csv"><i class="fa fa-check"></i>Use CSV files</a></li>
<li class="chapter" data-level="" data-path="saving-and-exporting.html"><a href="saving-and-exporting.html#archiving-publication-and-sharing"><i class="fa fa-check"></i>Archiving, publication and sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-raw-data-files.html"><a href="multiple-raw-data-files.html"><i class="fa fa-check"></i>Dealing with multiple files</a></li>
<li class="chapter" data-level="" data-path="joining-data.html"><a href="joining-data.html"><i class="fa fa-check"></i>Joining different datasets</a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html"><i class="fa fa-check"></i>Types of variable</a><ul>
<li><a href="factors-and-numerics.html#diffsinquantity">Differences in <em>quantity</em>: numeric variables</a></li>
<li><a href="factors-and-numerics.html#character-and-factor">Differences in <em>quality or kind</em></a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#facsforcategs"><i class="fa fa-check"></i>Factors for categorical data</a></li>
<li class="chapter" data-level="" data-path="factors-and-numerics.html"><a href="factors-and-numerics.html#storingdates"><i class="fa fa-check"></i>Dates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="missingvalues.html"><a href="missingvalues.html"><i class="fa fa-check"></i>Missing values</a></li>
<li class="chapter" data-level="" data-path="tidyingdata.html"><a href="tidyingdata.html"><i class="fa fa-check"></i>Tidying data</a></li>
<li class="chapter" data-level="" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i>Reshaping</a><ul>
<li class="chapter" data-level="" data-path="reshaping.html"><a href="reshaping.html#which-reshape-package"><i class="fa fa-check"></i>Which package should you use to reshape data?</a></li>
<li class="chapter" data-level="" data-path="reshaping.html"><a href="reshaping.html#aggregating-and-reshaping-at-the-same-time"><i class="fa fa-check"></i>Aggregating and reshaping at the same time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>4</b> Summaries</a><ul>
<li class="chapter" data-level="" data-path="quick-and-dirty.html"><a href="quick-and-dirty.html"><i class="fa fa-check"></i>“Quick and dirty”</a><ul>
<li class="chapter" data-level="" data-path="quick-and-dirty.html"><a href="quick-and-dirty.html#frequency-tables"><i class="fa fa-check"></i>Frequency tables</a></li>
<li class="chapter" data-level="" data-path="quick-and-dirty.html"><a href="quick-and-dirty.html#summary-statistics"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="quick-and-dirty.html"><a href="quick-and-dirty.html#creating-a-data-frame-of-summary-statistics"><i class="fa fa-check"></i>Creating a data frame of summary statistics</a></li>
<li class="chapter" data-level="" data-path="quick-and-dirty.html"><a href="quick-and-dirty.html#computing-statistics-by-groups"><i class="fa fa-check"></i>Computing statistics by-groups</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-generalised-approach.html"><a href="a-generalised-approach.html"><i class="fa fa-check"></i>A generalised approach</a><ul>
<li class="chapter" data-level="" data-path="a-generalised-approach.html"><a href="a-generalised-approach.html#fancy-reshaping"><i class="fa fa-check"></i>Fancy reshaping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="" data-path="graphics-benefits.html"><a href="graphics-benefits.html"><i class="fa fa-check"></i>Benefits of visualising data</a></li>
<li class="chapter" data-level="" data-path="graphics-approaches.html"><a href="graphics-approaches.html"><i class="fa fa-check"></i>Which tool to use?</a></li>
<li><a href="layered-graphics.html#layered-graphics">Layered graphics with <code>ggplot</code></a><ul>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html"><i class="fa fa-check"></i>A thought on ‘chart chooser’ guides</a></li>
<li><a href="layered-graphics.html#thinking-like-ggplot">Thinking like <code>ggplot</code></a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#relationships"><i class="fa fa-check"></i>‘Relationships’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#distributions"><i class="fa fa-check"></i>‘Distributions’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#comparisons"><i class="fa fa-check"></i>‘Comparisons’</a></li>
<li class="chapter" data-level="" data-path="layered-graphics.html"><a href="layered-graphics.html#composition"><i class="fa fa-check"></i>‘Composition’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html"><i class="fa fa-check"></i>‘Quick and dirty’ (utility) plots</a><ul>
<li class="chapter" data-level="5.0.1" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#distributions-1"><i class="fa fa-check"></i><b>5.0.1</b> Distributions</a></li>
<li class="chapter" data-level="5.0.2" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#relationships-1"><i class="fa fa-check"></i><b>5.0.2</b> Relationships</a></li>
<li class="chapter" data-level="5.0.3" data-path="utility-plotting-functions.html"><a href="utility-plotting-functions.html#quantities"><i class="fa fa-check"></i><b>5.0.3</b> Quantities</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html"><i class="fa fa-check"></i>Tricks with ggplot</a><ul>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html#facetting-plots"><i class="fa fa-check"></i>More ways to facet a plot</a></li>
<li><a href="ggplot-details.html#facet_wrap"><code>facet_wrap</code></a></li>
<li><a href="ggplot-details.html#facet_grid"><code>facet_grid</code></a></li>
<li class="chapter" data-level="" data-path="ggplot-details.html"><a href="ggplot-details.html#combining-plots"><i class="fa fa-check"></i>Combining separate plots in a grid</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exporting-graphics.html"><a href="exporting-graphics.html"><i class="fa fa-check"></i>Exporting for print</a></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="6" data-path="common-inferential-stats.html"><a href="common-inferential-stats.html"><i class="fa fa-check"></i><b>6</b> Common inferential statistics</a><ul>
<li><a href="crosstabs.html#crosstabs">Crosstabulations and <span class="math inline">\(\chi^2\)</span></a><ul>
<li class="chapter" data-level="" data-path="crosstabs.html"><a href="crosstabs.html"><i class="fa fa-check"></i>Three-way tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i>Correlations</a><ul>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-matrix"><i class="fa fa-check"></i>Creating a correlation matrix</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#working-with-correlation-matrices"><i class="fa fa-check"></i>Working with correlation matrices</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-tables-for-publication"><i class="fa fa-check"></i>Tables for publication</a></li>
<li class="chapter" data-level="" data-path="correlations.html"><a href="correlations.html#correlation-methods"><i class="fa fa-check"></i>Other methods for correlation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i>t-tests</a><ul>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html#visualising-your-data-first"><i class="fa fa-check"></i>Visualising your data first</a></li>
<li class="chapter" data-level="" data-path="t-tests.html"><a href="t-tests.html#running-a-t-test"><i class="fa fa-check"></i>Running a t-test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-models-simple.html"><a href="linear-models-simple.html"><i class="fa fa-check"></i><b>7</b> Regression</a><ul>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#formulae"><i class="fa fa-check"></i>Describing statistical models using formulae</a></li>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#running-a-linear-model"><i class="fa fa-check"></i>Running a linear model</a></li>
<li class="chapter" data-level="" data-path="linear-models-simple.html"><a href="linear-models-simple.html#more-on-formulas"><i class="fa fa-check"></i>More on formulas</a></li>
<li class="chapter" data-level="" data-path="factors-and-variable-codings.html"><a href="factors-and-variable-codings.html"><i class="fa fa-check"></i>Factors and variable codings</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html"><i class="fa fa-check"></i>Model specification</a><ul>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#regression-coding"><i class="fa fa-check"></i>Effect/dummy coding and contrasts</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#centering"><i class="fa fa-check"></i>Centering (is often helpful)</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#scaling-regression-inputs"><i class="fa fa-check"></i>Scaling inputs</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#alternatives-to-rescaling"><i class="fa fa-check"></i>Alternatives to rescaling</a></li>
<li class="chapter" data-level="" data-path="parameterisation.html"><a href="parameterisation.html#what-next"><i class="fa fa-check"></i>What next</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>8</b> Anova</a><ul>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#rules-for-using-anova-in-r"><i class="fa fa-check"></i>Rules for using Anova in R</a></li>
<li class="chapter" data-level="" data-path="anova.html"><a href="anova.html#anova-recommendations"><i class="fa fa-check"></i>Recommendations for doing Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html"><i class="fa fa-check"></i>Anova ‘Cookbook’</a><ul>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#between-subjects-anova"><i class="fa fa-check"></i>Between-subjects Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#repeated-measures"><i class="fa fa-check"></i>Repeated measures or ‘split plot’ designs</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#trad-rm-anova"><i class="fa fa-check"></i>Traditional repeated measures Anova</a></li>
<li class="chapter" data-level="" data-path="anova-cookbook.html"><a href="anova-cookbook.html#comparison-with-a-multilevel-model"><i class="fa fa-check"></i>Comparison with a multilevel model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="checking-assumptions.html"><a href="checking-assumptions.html"><i class="fa fa-check"></i>Checking assumptions</a></li>
<li class="chapter" data-level="" data-path="followup-tests.html"><a href="followup-tests.html"><i class="fa fa-check"></i>Followup tests</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="general-linear-models.html"><a href="general-linear-models.html"><i class="fa fa-check"></i><b>9</b> General linear models</a><ul>
<li class="chapter" data-level="" data-path="general-linear-models.html"><a href="general-linear-models.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>10</b> Multilevel models</a><ul>
<li class="chapter" data-level="" data-path="fitting-models.html"><a href="fitting-models.html"><i class="fa fa-check"></i>Fitting multilevel models in R</a><ul>
<li><a href="fitting-models.html#use-lmer-and-glmer">Use <code>lmer</code> and <code>glmer</code></a></li>
<li><a href="fitting-models.html#p-values-in-multilevel-models"><em>p</em> values in multilevel models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extending-traditional-rm-anova.html"><a href="extending-traditional-rm-anova.html"><i class="fa fa-check"></i>Extending traditional RM Anova</a><ul>
<li><a href="extending-traditional-rm-anova.html#fit-a-simple-slope-for-days">Fit a simple slope for <code>Days</code></a></li>
<li class="chapter" data-level="" data-path="extending-traditional-rm-anova.html"><a href="extending-traditional-rm-anova.html#allow-the-effect-of-sleep-deprivation-to-vary-for-different-participants"><i class="fa fa-check"></i>Allow the effect of sleep deprivation to vary for different participants</a></li>
<li><a href="extending-traditional-rm-anova.html#growth-curve-sleep-example">Fitting a curve for the effect of <code>Days</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="icc-and-vpc.html"><a href="icc-and-vpc.html"><i class="fa fa-check"></i>Variance partition coefficients and intraclass correlations</a></li>
<li class="chapter" data-level="" data-path="threelevel.html"><a href="threelevel.html"><i class="fa fa-check"></i>3 level models with ‘partially crossed’ random effects</a></li>
<li><a href="contrasts-lmer.html#contrasts-lmer">Contrasts and followup tests using <code>lmer</code></a></li>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html"><i class="fa fa-check"></i>Troubleshooting</a><ul>
<li class="chapter" data-level="" data-path="troubleshooting-multilevel-models.html"><a href="troubleshooting-multilevel-models.html#simplifying-mixed-models"><i class="fa fa-check"></i>Convergence problems and simplifying the random effects structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multilevel-bayes-reasons.html"><a href="multilevel-bayes-reasons.html"><i class="fa fa-check"></i>Bayesian multilevel models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mediation-and-covariance-modelling.html"><a href="mediation-and-covariance-modelling.html"><i class="fa fa-check"></i><b>11</b> Mediation and covariance modelling</a><ul>
<li class="chapter" data-level="" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i>Mediation</a></li>
<li class="chapter" data-level="" data-path="covariance-modelling.html"><a href="covariance-modelling.html"><i class="fa fa-check"></i>Covariance modelling</a></li>
<li class="chapter" data-level="" data-path="path-models.html"><a href="path-models.html"><i class="fa fa-check"></i>Path models</a><ul>
<li class="chapter" data-level="" data-path="path-models.html"><a href="path-models.html#defining-a-model"><i class="fa fa-check"></i>Defining a model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory factor analysis (CFA)</a><ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#defining-the-model"><i class="fa fa-check"></i>Defining the model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-fit.html"><a href="model-fit.html"><i class="fa fa-check"></i>Model fit</a></li>
<li class="chapter" data-level="" data-path="modification-indices.html"><a href="modification-indices.html"><i class="fa fa-check"></i>Modification indices</a></li>
<li class="chapter" data-level="" data-path="model-improvement.html"><a href="model-improvement.html"><i class="fa fa-check"></i>Model modification and improvement</a></li>
<li class="chapter" data-level="" data-path="sem.html"><a href="sem.html"><i class="fa fa-check"></i>Structural eqution modelling (SEM)</a></li>
<li class="chapter" data-level="" data-path="identification.html"><a href="identification.html"><i class="fa fa-check"></i>‘Identification’ in CFA and SEM</a></li>
<li class="chapter" data-level="" data-path="cfa-sem-missing-data.html"><a href="cfa-sem-missing-data.html"><i class="fa fa-check"></i>Missing data</a></li>
<li class="chapter" data-level="" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i>Goodness of fit statistics in CFA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html"><i class="fa fa-check"></i><b>12</b> Baysian model fitting</a><ul>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#baysian-fitting-of-linear-models-via-mcmc-methods"><i class="fa fa-check"></i>Baysian fitting of linear models via MCMC methods</a></li>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#posterior-probabilities-for-parameters"><i class="fa fa-check"></i>Posterior probabilities for parameters</a></li>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#credible-intervals"><i class="fa fa-check"></i>Credible intervals</a></li>
<li class="chapter" data-level="" data-path="bayes-mcmc.html"><a href="bayes-mcmc.html#bayesian-p-values-for-parameters"><i class="fa fa-check"></i>Bayesian ‘p values’ for parameters</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>13</b> Power analysis</a><ul>
<li class="chapter" data-level="" data-path="power-analysis.html"><a href="power-analysis.html#for-most-inferential-statistics"><i class="fa fa-check"></i>For most inferential statistics</a></li>
<li class="chapter" data-level="" data-path="power-analysis.html"><a href="power-analysis.html#for-multilevel-or-generalised-linear-models"><i class="fa fa-check"></i>For multilevel or generalised linear models</a></li>
</ul></li>
<li class="part"><span><b>IV Patterns</b></span></li>
<li class="chapter" data-level="14" data-path="learning-key-patterns.html"><a href="learning-key-patterns.html"><i class="fa fa-check"></i><b>14</b> Learning key patterns</a></li>
<li class="chapter" data-level="15" data-path="understanding-interactions.html"><a href="understanding-interactions.html"><i class="fa fa-check"></i><b>15</b> Unpicking interactions</a><ul>
<li class="chapter" data-level="" data-path="understanding-interactions.html"><a href="understanding-interactions.html#what-is-an-interaction"><i class="fa fa-check"></i>What is an interaction?</a></li>
<li class="chapter" data-level="" data-path="understanding-interactions.html"><a href="understanding-interactions.html#visualising-interactions-from-raw-data"><i class="fa fa-check"></i>Visualising interactions from raw data</a></li>
<li class="chapter" data-level="" data-path="understanding-interactions.html"><a href="understanding-interactions.html#pain-music-data"><i class="fa fa-check"></i>A painful example</a></li>
<li class="chapter" data-level="" data-path="understanding-interactions.html"><a href="understanding-interactions.html#continuous-predictors"><i class="fa fa-check"></i>Continuous predictors</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html"><i class="fa fa-check"></i><b>16</b> Making predictions</a><ul>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predictions-vs-margins"><i class="fa fa-check"></i>Predictions vs margins</a></li>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#predicted-means"><i class="fa fa-check"></i>Predicted means</a></li>
<li><a href="predictions-and-margins.html#effects-margins"><em>Effects</em> (margins)</a></li>
<li class="chapter" data-level="" data-path="predictions-and-margins.html"><a href="predictions-and-margins.html#continuous-predictors-1"><i class="fa fa-check"></i>Continuous predictors</a></li>
<li><a href="predicted-means-and-margins-using-lm.html#predicted-means-and-margins-using-lm">Predicted means and margins using <code>lm()</code></a><ul>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html"><i class="fa fa-check"></i>Running the model</a></li>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html#making-predictions-for-means"><i class="fa fa-check"></i>Making predictions for means</a></li>
<li><a href="predicted-means-and-margins-using-lm.html#making-prdictions-for-margins-effects-of-predictors">Making prdictions for margins (<em>effects</em> of predictors)</a></li>
<li class="chapter" data-level="" data-path="predicted-means-and-margins-using-lm.html"><a href="predicted-means-and-margins-using-lm.html#marginal-effects"><i class="fa fa-check"></i>Marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="predictions-with-continuous-covariates.html"><a href="predictions-with-continuous-covariates.html"><i class="fa fa-check"></i>Predictions with continuous covariates</a></li>
<li class="chapter" data-level="" data-path="visualising-interactions.html"><a href="visualising-interactions.html"><i class="fa fa-check"></i>Visualising interactions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="models-are-data-too.html"><a href="models-are-data-too.html"><i class="fa fa-check"></i><b>17</b> Models are data</a><ul>
<li class="chapter" data-level="" data-path="models-are-data-too.html"><a href="models-are-data-too.html#storing-models-in-variables"><i class="fa fa-check"></i>Storing models in variables</a></li>
<li class="chapter" data-level="" data-path="models-are-data-too.html"><a href="models-are-data-too.html#extract-results-from-models"><i class="fa fa-check"></i>Extracting results from models</a></li>
<li><a href="models-are-data-too.html#poking-around-with-and">‘Poking around’ with <code>$</code> and <code>@</code></a></li>
<li class="chapter" data-level="" data-path="models-are-data-too.html"><a href="models-are-data-too.html#broom"><i class="fa fa-check"></i>Save work: use a Broom</a></li>
<li class="chapter" data-level="" data-path="process-model-results.html"><a href="process-model-results.html"><i class="fa fa-check"></i>‘Processing’ results</a></li>
<li class="chapter" data-level="" data-path="output-tables.html"><a href="output-tables.html"><i class="fa fa-check"></i>Printing tables</a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html"><i class="fa fa-check"></i>APA formatting for free</a><ul>
<li><a href="apa-output.html#chi2">Chi<sup>2</sup></a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html#t-test"><i class="fa fa-check"></i>T-test</a></li>
<li class="chapter" data-level="" data-path="apa-output.html"><a href="apa-output.html#anova-1"><i class="fa fa-check"></i>Anova</a></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-models"><i class="fa fa-check"></i>Multilevel models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="code-reuse.html"><a href="code-reuse.html"><i class="fa fa-check"></i>Simplifying and re-using</a><ul>
<li class="chapter" data-level="" data-path="code-reuse.html"><a href="code-reuse.html#helper-functions"><i class="fa fa-check"></i>Writing helper functions</a></li>
<li><a href="code-reuse.html#ggplot-reuse">Re-using code with <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="table1.html"><a href="table1.html"><i class="fa fa-check"></i>“Table 1”</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="quirks.html"><a href="quirks.html"><i class="fa fa-check"></i><b>18</b> Dealing with quirks of R</a><ul>
<li class="chapter" data-level="" data-path="rownames.html"><a href="rownames.html"><i class="fa fa-check"></i>Rownames are evil</a></li>
<li class="chapter" data-level="" data-path="string-handling.html"><a href="string-handling.html"><i class="fa fa-check"></i>Working with character strings</a><ul>
<li class="chapter" data-level="18.0.1" data-path="string-handling.html"><a href="string-handling.html#searching-and-replacing"><i class="fa fa-check"></i><b>18.0.1</b> Searching and replacing</a></li>
<li><a href="processing-vectors.html#paste">Using <code>paste</code> to make labels</a></li>
<li><a href="string-handling.html#separate-and-extract">Fixing up <code>variable</code> after melting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="colours.html"><a href="colours.html"><i class="fa fa-check"></i>Colours</a><ul>
<li class="chapter" data-level="" data-path="colours.html"><a href="colours.html#picking-colours"><i class="fa fa-check"></i>Picking colours for plots</a></li>
<li class="chapter" data-level="" data-path="colours.html"><a href="colours.html#named-colours"><i class="fa fa-check"></i>Named colours in R</a></li>
<li class="chapter" data-level="" data-path="colours.html"><a href="colours.html#color-brewer"><i class="fa fa-check"></i>ColourBrewer with ggplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>19</b> Getting help</a><ul>
<li class="chapter" data-level="" data-path="getting-help.html"><a href="getting-help.html#backtick-location"><i class="fa fa-check"></i>Finding the backtick on your keyboard</a></li>
</ul></li>
<li class="part"><span><b>V Explanations</b></span></li>
<li class="chapter" data-level="20" data-path="intervals.html"><a href="intervals.html"><i class="fa fa-check"></i><b>20</b> Confidence and Intervals</a><ul>
<li class="chapter" data-level="" data-path="intervals.html"><a href="intervals.html#the-problem-with-confidence-intervals"><i class="fa fa-check"></i>The problem with confidence intervals</a></li>
<li class="chapter" data-level="" data-path="intervals.html"><a href="intervals.html#forgetting-that-the-ci-depends-on-sample-size."><i class="fa fa-check"></i>Forgetting that the CI depends on sample size.</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html"><i class="fa fa-check"></i><b>21</b> Multiple comparisons</a><ul>
<li><a href="multiple-comparisons.html#p-values-and-false-discoveries"><em>p</em> values and ‘false discoveries’</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#multiple-tests-on-the-same-data"><i class="fa fa-check"></i>Multiple tests on the same data</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#what-to-do-about-it"><i class="fa fa-check"></i>What to do about it?</a></li>
<li class="chapter" data-level="" data-path="multiple-comparisons.html"><a href="multiple-comparisons.html#contrasts-examples"><i class="fa fa-check"></i>Practical examples</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>22</b> Non-independence</a></li>
<li class="chapter" data-level="23" data-path="fixed-or-random.html"><a href="fixed-or-random.html"><i class="fa fa-check"></i><b>23</b> Fixed and random effects</a></li>
<li class="chapter" data-level="24" data-path="scaling-predictors.html"><a href="scaling-predictors.html"><i class="fa fa-check"></i><b>24</b> Scaling predictor variables</a><ul>
<li class="chapter" data-level="" data-path="standardizing.html"><a href="standardizing.html"><i class="fa fa-check"></i>Standardising</a></li>
<li class="chapter" data-level="" data-path="dichotomising.html"><a href="dichotomising.html"><i class="fa fa-check"></i>Dichotomising continuous predictors (or outcomes)</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="non-scale-outcomes.html"><a href="non-scale-outcomes.html"><i class="fa fa-check"></i><b>25</b> Non-scale outcomes</a><ul>
<li class="chapter" data-level="25.1" data-path="link-functions.html"><a href="link-functions.html"><i class="fa fa-check"></i><b>25.1</b> Link functions</a><ul>
<li class="chapter" data-level="" data-path="link-functions.html"><a href="link-functions.html#logistic-link-function"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="comparison-and-selection.html"><a href="comparison-and-selection.html"><i class="fa fa-check"></i><b>26</b> Building and choosing models</a><ul>
<li class="chapter" data-level="" data-path="comparison-and-selection.html"><a href="comparison-and-selection.html#like-maps-models-are-imperfect-but-useful"><i class="fa fa-check"></i>Like maps, models are imperfect but useful</a></li>
<li class="chapter" data-level="" data-path="comparison-and-selection.html"><a href="comparison-and-selection.html#over-fitting"><i class="fa fa-check"></i>Overfitting/underfitting</a></li>
<li class="chapter" data-level="" data-path="comparison-and-selection.html"><a href="comparison-and-selection.html#variable-selection"><i class="fa fa-check"></i>Choosing the ‘right variables’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Just Enough R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlations" class="section level2 unnumbered">
<h2>Correlations</h2>
<p>The base R <code>cor()</code> function provides a simple way to get Pearson correlations, but to get a correlation matrix as you might expect from SPSS or Stata it’s best to use the <code>corr.test()</code> function in the <code>psych</code> package.</p>
<p>Before you start though, plotting the correlations might be the best way of getting to grips with the patterns of relationship in your data. A pairs plot is a nice way of doing this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Month, <span class="op">-</span>Day) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>pairs</code></pre></div>
<p><img src="correlations_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>If we were satisfied the relationships were (reasonably) linear, we could also visualise correlations themselves with a ‘corrgram’, using the <code>corrgram</code> library:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;corrgram&quot;</span>)
airquality <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Month, <span class="op">-</span>Day) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">corrgram</span>(<span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.ellipse,
         <span class="dt">upper.panel=</span>panel.cor,
         <span class="dt">diag.panel=</span>panel.density)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<img src="correlations_files/figure-html/unnamed-chunk-4-1.png" alt="A corrgram, showing pearson correlations (above the diagonal), variable distributions (on the diagonal) and ellipses and smoothed lines of best fit (below the diagnonal). Long, narrow ellipses denote large correlations; circular ellipses indicate small correlations." width="672" />
<p class="caption">
Figure 5.1: A corrgram, showing pearson correlations (above the diagonal), variable distributions (on the diagonal) and ellipses and smoothed lines of best fit (below the diagnonal). Long, narrow ellipses denote large correlations; circular ellipses indicate small correlations.
</p>
</div>
<p>The ggpairs function from the <code>GGally</code> package is also a nice way of plotting relationships between a combination of categorical and continuous data - it packs a lot of information into a limited space:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cyl =</span> <span class="kw">factor</span>(cyl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(mpg, wt, drat, cyl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>GGally<span class="op">::</span><span class="kw">ggpairs</span>()</code></pre></div>
<p><img src="correlations_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="correlation-matrix" class="section level3 unnumbered">
<h3>Creating a correlation matrix</h3>
<p>The <code>psych::corr.test()</code> function is a quick way to obtain a pairwise correlation matrix for an entire dataset, along with p values and confidence intervals which the base R <code>cor()</code> function will not provide:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycorrelations &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">corr.test</span>(airquality)
mycorrelations
Call<span class="op">:</span>psych<span class="op">::</span><span class="kw">corr.test</span>(<span class="dt">x =</span> airquality)
Correlation matrix 
        Ozone Solar.R  Wind  Temp Month   Day
Ozone    <span class="fl">1.00</span>    <span class="fl">0.35</span> <span class="op">-</span><span class="fl">0.60</span>  <span class="fl">0.70</span>  <span class="fl">0.16</span> <span class="op">-</span><span class="fl">0.01</span>
Solar.R  <span class="fl">0.35</span>    <span class="fl">1.00</span> <span class="op">-</span><span class="fl">0.06</span>  <span class="fl">0.28</span> <span class="op">-</span><span class="fl">0.08</span> <span class="op">-</span><span class="fl">0.15</span>
Wind    <span class="op">-</span><span class="fl">0.60</span>   <span class="op">-</span><span class="fl">0.06</span>  <span class="fl">1.00</span> <span class="op">-</span><span class="fl">0.46</span> <span class="op">-</span><span class="fl">0.18</span>  <span class="fl">0.03</span>
Temp     <span class="fl">0.70</span>    <span class="fl">0.28</span> <span class="op">-</span><span class="fl">0.46</span>  <span class="fl">1.00</span>  <span class="fl">0.42</span> <span class="op">-</span><span class="fl">0.13</span>
Month    <span class="fl">0.16</span>   <span class="op">-</span><span class="fl">0.08</span> <span class="op">-</span><span class="fl">0.18</span>  <span class="fl">0.42</span>  <span class="fl">1.00</span> <span class="op">-</span><span class="fl">0.01</span>
Day     <span class="op">-</span><span class="fl">0.01</span>   <span class="op">-</span><span class="fl">0.15</span>  <span class="fl">0.03</span> <span class="op">-</span><span class="fl">0.13</span> <span class="op">-</span><span class="fl">0.01</span>  <span class="fl">1.00</span>
Sample Size 
        Ozone Solar.R Wind Temp Month Day
Ozone     <span class="dv">116</span>     <span class="dv">111</span>  <span class="dv">116</span>  <span class="dv">116</span>   <span class="dv">116</span> <span class="dv">116</span>
Solar.R   <span class="dv">111</span>     <span class="dv">146</span>  <span class="dv">146</span>  <span class="dv">146</span>   <span class="dv">146</span> <span class="dv">146</span>
Wind      <span class="dv">116</span>     <span class="dv">146</span>  <span class="dv">153</span>  <span class="dv">153</span>   <span class="dv">153</span> <span class="dv">153</span>
Temp      <span class="dv">116</span>     <span class="dv">146</span>  <span class="dv">153</span>  <span class="dv">153</span>   <span class="dv">153</span> <span class="dv">153</span>
Month     <span class="dv">116</span>     <span class="dv">146</span>  <span class="dv">153</span>  <span class="dv">153</span>   <span class="dv">153</span> <span class="dv">153</span>
Day       <span class="dv">116</span>     <span class="dv">146</span>  <span class="dv">153</span>  <span class="dv">153</span>   <span class="dv">153</span> <span class="dv">153</span>
Probability <span class="kw">values</span> (Entries above the diagonal are adjusted <span class="cf">for</span> multiple tests.) 
        Ozone Solar.R Wind Temp Month  Day
Ozone    <span class="fl">0.00</span>    <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span>  <span class="fl">0.56</span> <span class="fl">1.00</span>
Solar.R  <span class="fl">0.00</span>    <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">0.01</span>  <span class="fl">1.00</span> <span class="fl">0.56</span>
Wind     <span class="fl">0.00</span>    <span class="fl">0.50</span> <span class="fl">0.00</span> <span class="fl">0.00</span>  <span class="fl">0.25</span> <span class="fl">1.00</span>
Temp     <span class="fl">0.00</span>    <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span>  <span class="fl">0.00</span> <span class="fl">0.65</span>
Month    <span class="fl">0.08</span>    <span class="fl">0.37</span> <span class="fl">0.03</span> <span class="fl">0.00</span>  <span class="fl">0.00</span> <span class="fl">1.00</span>
Day      <span class="fl">0.89</span>    <span class="fl">0.07</span> <span class="fl">0.74</span> <span class="fl">0.11</span>  <span class="fl">0.92</span> <span class="fl">0.00</span>

 To see confidence intervals of the correlations, print with the short=<span class="ot">FALSE</span> option</code></pre></div>
<p>One thing to be aware of is that by default <code>corr.test()</code> produces p values that are adjusted for multiple comparisons in the top right hand triangle (i.e. above the diagonal). If you want the uncorrected values use the values below the diagonal (or pass <code>adjust=FALSE</code> when calling the function).</p>
</div>
<div id="working-with-correlation-matrices" class="section level3 unnumbered">
<h3>Working with correlation matrices</h3>
<p>It’s important to realise that, as with all R objects, we can work with correlation matrices to continue our data ananalyses.</p>
<p>For example, as part of exploring your data, you might want to know whether correlations you observe in one sample are similar to those from another sample, when using the same questions. For example, let’s say we ran a survey measuring variables from the theory of planned behaviour first in students, and later in older adults:</p>
<p>We could run correlations for each sample separately:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corr.students &lt;-<span class="st"> </span><span class="kw">cor</span>(students)
corr.public &lt;-<span class="st"> </span><span class="kw">cor</span>(public)</code></pre></div>
<p>And we could ‘eyeball’ both of these correlation matrices and try and spot patterns or differences between them, but this is quite hard:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corr.students <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="15%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">behaviour</th>
<th align="center">intention</th>
<th align="center">control</th>
<th align="center">social.norm</th>
<th align="center">attitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>behaviour</strong></td>
<td align="center">1.000</td>
<td align="center">0.55</td>
<td align="center">0.648</td>
<td align="center">0.072</td>
<td align="center">0.132</td>
</tr>
<tr class="even">
<td align="center"><strong>intention</strong></td>
<td align="center">0.551</td>
<td align="center">1.00</td>
<td align="center">0.394</td>
<td align="center">0.298</td>
<td align="center">0.438</td>
</tr>
<tr class="odd">
<td align="center"><strong>control</strong></td>
<td align="center">0.648</td>
<td align="center">0.39</td>
<td align="center">1.000</td>
<td align="center">0.017</td>
<td align="center">0.014</td>
</tr>
<tr class="even">
<td align="center"><strong>social.norm</strong></td>
<td align="center">0.072</td>
<td align="center">0.30</td>
<td align="center">0.017</td>
<td align="center">1.000</td>
<td align="center">-0.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>attitude</strong></td>
<td align="center">0.132</td>
<td align="center">0.44</td>
<td align="center">0.014</td>
<td align="center">-0.011</td>
<td align="center">1.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corr.public <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>pander</code></pre></div>
<table>
<colgroup>
<col width="23%" />
<col width="15%" />
<col width="15%" />
<col width="17%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">behaviour</th>
<th align="center">intention</th>
<th align="center">social.norm</th>
<th align="center">attitude</th>
<th align="center">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>behaviour</strong></td>
<td align="center">1.00</td>
<td align="center">0.54</td>
<td align="center">0.282</td>
<td align="center">0.231</td>
<td align="center">0.141</td>
</tr>
<tr class="even">
<td align="center"><strong>intention</strong></td>
<td align="center">0.54</td>
<td align="center">1.00</td>
<td align="center">0.356</td>
<td align="center">0.376</td>
<td align="center">0.290</td>
</tr>
<tr class="odd">
<td align="center"><strong>social.norm</strong></td>
<td align="center">0.28</td>
<td align="center">0.36</td>
<td align="center">1.000</td>
<td align="center">-0.081</td>
<td align="center">0.010</td>
</tr>
<tr class="even">
<td align="center"><strong>attitude</strong></td>
<td align="center">0.23</td>
<td align="center">0.38</td>
<td align="center">-0.081</td>
<td align="center">1.000</td>
<td align="center">0.049</td>
</tr>
<tr class="odd">
<td align="center"><strong>control</strong></td>
<td align="center">0.14</td>
<td align="center">0.29</td>
<td align="center">0.010</td>
<td align="center">0.049</td>
<td align="center">1.000</td>
</tr>
</tbody>
</table>
<p>But we could also simply <em>subtract</em> one matrix from the other to show the difference directly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(corr.students <span class="op">-</span><span class="st"> </span>corr.public) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="15%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">behaviour</th>
<th align="center">intention</th>
<th align="center">control</th>
<th align="center">social.norm</th>
<th align="center">attitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>behaviour</strong></td>
<td align="center">0.000</td>
<td align="center">0.013</td>
<td align="center">0.366</td>
<td align="center">-0.159</td>
<td align="center">-0.009</td>
</tr>
<tr class="even">
<td align="center"><strong>intention</strong></td>
<td align="center">0.013</td>
<td align="center">0.000</td>
<td align="center">0.038</td>
<td align="center">-0.078</td>
<td align="center">0.148</td>
</tr>
<tr class="odd">
<td align="center"><strong>control</strong></td>
<td align="center">0.366</td>
<td align="center">0.038</td>
<td align="center">0.000</td>
<td align="center">0.097</td>
<td align="center">0.004</td>
</tr>
<tr class="even">
<td align="center"><strong>social.norm</strong></td>
<td align="center">-0.159</td>
<td align="center">-0.078</td>
<td align="center">0.097</td>
<td align="center">0.000</td>
<td align="center">-0.059</td>
</tr>
<tr class="odd">
<td align="center"><strong>attitude</strong></td>
<td align="center">-0.009</td>
<td align="center">0.148</td>
<td align="center">0.004</td>
<td align="center">-0.059</td>
<td align="center">0.000</td>
</tr>
</tbody>
</table>
<p>Now it’s much more obvious that the behaviour/control correlation differs between the samples (it’s higher in the students).</p>
<p>The point here is not that this is an analysis you are likely to actually report — although you might find it useful when exploring the data and interpreting your findings.</p>
<p>But rather this show that a correlation matrix, in common with the results of all the statistical tests we run, are themselves <em>just data points</em>. We can do whatever we like with our results — storing them in data frames to display later, or process as we need.</p>
<p>In reality, if you wanted to test the difference in correlations (slopes) in two groups for one outcome variable you probably want to use <a href="#regression">multiple regression</a>, and if you wanted to test a complex model like the theory of planned behaviour, you might consider <a href="cfa.html#cfa">CFA</a> and/or <a href="sem.html#sem">SEM</a>).</p>
</div>
<div id="correlation-tables-for-publication" class="section level3 unnumbered">
<h3>Tables for publication</h3>
<div id="using-apatables" class="section level4 unnumbered">
<h4>Using <code>apaTables</code></h4>
<p>If you want to produce nice correlation tables for publication the <code>apaTables</code> package might be useful. This block saves an APA formatted correlation table to an <a href="Table1_APA.doc">external Word document like this</a>.</p>
<p>Note though, that the APA table format does encourage ‘star gazing’ to some degree. Try to avoid interpreting correlation tables solely based on the significance (or not) of the <em>r</em> values. The <code>pairs</code> or <code>corrgram</code> plots shown above are a much better summary of the data, and are can be just as compact.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw">apa.cor.table</span>(airquality, <span class="dt">filename=</span><span class="st">&quot;Table1_APA.doc&quot;</span>, <span class="dt">show.conf.interval=</span>F)


Means, standard deviations, and correlations
 

  Variable   M      SD    <span class="dv">1</span>      <span class="dv">2</span>     <span class="dv">3</span>      <span class="dv">4</span>     <span class="dv">5</span>   
  <span class="dv">1</span>. Ozone   <span class="fl">42.13</span>  <span class="fl">32.99</span>                               
                                                        
  <span class="dv">2</span>. Solar.R <span class="fl">185.93</span> <span class="fl">90.06</span> .<span class="dv">35</span><span class="op">**</span><span class="st">                         </span>
<span class="st">                                                        </span>
<span class="st">  </span><span class="dv">3</span>. Wind    <span class="fl">9.96</span>   <span class="fl">3.52</span>  <span class="op">-</span>.<span class="dv">60</span><span class="op">**</span><span class="st"> </span><span class="op">-</span>.<span class="dv">06</span>                   
                                                        
  <span class="dv">4</span>. Temp    <span class="fl">77.88</span>  <span class="fl">9.47</span>  .<span class="dv">70</span><span class="op">**</span><span class="st">  </span>.<span class="dv">28</span><span class="op">**</span><span class="st"> </span><span class="op">-</span>.<span class="dv">46</span><span class="op">**</span><span class="st">           </span>
<span class="st">                                                        </span>
<span class="st">  </span><span class="dv">5</span>. Month   <span class="fl">6.99</span>   <span class="fl">1.42</span>  .<span class="dv">16</span>    <span class="op">-</span>.<span class="dv">08</span>  <span class="op">-</span>.<span class="dv">18</span><span class="op">*</span><span class="st">  </span>.<span class="dv">42</span><span class="op">**</span><span class="st">     </span>
<span class="st">                                                        </span>
<span class="st">  </span><span class="dv">6</span>. Day     <span class="fl">15.80</span>  <span class="fl">8.86</span>  <span class="op">-</span>.<span class="dv">01</span>   <span class="op">-</span>.<span class="dv">15</span>  .<span class="dv">03</span>    <span class="op">-</span>.<span class="dv">13</span>  <span class="op">-</span>.<span class="dv">01</span>
                                                        

Note. <span class="op">*</span><span class="st"> </span>indicates p <span class="op">&lt;</span><span class="st"> </span>.<span class="dv">05</span>; <span class="op">**</span><span class="st"> </span>indicates p <span class="op">&lt;</span><span class="st"> </span>.<span class="dv">01</span>.
M and SD are used to represent mean and standard deviation, respectively.
 </code></pre></div>
</div>
<div id="by-hand" class="section level4 unnumbered">
<h4>By hand</h4>
<p>If you’re not bothered about strict APA format, you might still want to extract <em>r</em> and <em>p</em> values as dataframes which can then be saved to a csv and opened in Excel, or converted to a table some other way.</p>
<p>You can do this by storing the <code>corr.test</code> output in a variable, and the accessing the <code>$r</code> and <code>$p</code> values within it.</p>
<p>First, we create the <code>corr.test</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycorrelations &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">corr.test</span>(airquality)</code></pre></div>
<p>Then extract the <em>r</em> values as a table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycorrelations<span class="op">$</span>r <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:94%;">
<colgroup>
<col width="19%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Ozone</th>
<th align="center">Solar.R</th>
<th align="center">Wind</th>
<th align="center">Temp</th>
<th align="center">Month</th>
<th align="center">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Ozone</strong></td>
<td align="center">1.000</td>
<td align="center">0.348</td>
<td align="center">-0.602</td>
<td align="center">0.70</td>
<td align="center">0.165</td>
<td align="center">-0.013</td>
</tr>
<tr class="even">
<td align="center"><strong>Solar.R</strong></td>
<td align="center">0.348</td>
<td align="center">1.000</td>
<td align="center">-0.057</td>
<td align="center">0.28</td>
<td align="center">-0.075</td>
<td align="center">-0.150</td>
</tr>
<tr class="odd">
<td align="center"><strong>Wind</strong></td>
<td align="center">-0.602</td>
<td align="center">-0.057</td>
<td align="center">1.000</td>
<td align="center">-0.46</td>
<td align="center">-0.178</td>
<td align="center">0.027</td>
</tr>
<tr class="even">
<td align="center"><strong>Temp</strong></td>
<td align="center">0.698</td>
<td align="center">0.276</td>
<td align="center">-0.458</td>
<td align="center">1.00</td>
<td align="center">0.421</td>
<td align="center">-0.131</td>
</tr>
<tr class="odd">
<td align="center"><strong>Month</strong></td>
<td align="center">0.165</td>
<td align="center">-0.075</td>
<td align="center">-0.178</td>
<td align="center">0.42</td>
<td align="center">1.000</td>
<td align="center">-0.008</td>
</tr>
<tr class="even">
<td align="center"><strong>Day</strong></td>
<td align="center">-0.013</td>
<td align="center">-0.150</td>
<td align="center">0.027</td>
<td align="center">-0.13</td>
<td align="center">-0.008</td>
<td align="center">1.000</td>
</tr>
</tbody>
</table>
<p>And we can also extract p values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycorrelations<span class="op">$</span>p <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:89%;">
<colgroup>
<col width="19%" />
<col width="11%" />
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Ozone</th>
<th align="center">Solar.R</th>
<th align="center">Wind</th>
<th align="center">Temp</th>
<th align="center">Month</th>
<th align="center">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Ozone</strong></td>
<td align="center">0.000</td>
<td align="center">0.002</td>
<td align="center">0.000</td>
<td align="center">0.000</td>
<td align="center">0.56</td>
<td align="center">1.00</td>
</tr>
<tr class="even">
<td align="center"><strong>Solar.R</strong></td>
<td align="center">0.000</td>
<td align="center">0.000</td>
<td align="center">1.000</td>
<td align="center">0.008</td>
<td align="center">1.00</td>
<td align="center">0.56</td>
</tr>
<tr class="odd">
<td align="center"><strong>Wind</strong></td>
<td align="center">0.000</td>
<td align="center">0.496</td>
<td align="center">0.000</td>
<td align="center">0.000</td>
<td align="center">0.25</td>
<td align="center">1.00</td>
</tr>
<tr class="even">
<td align="center"><strong>Temp</strong></td>
<td align="center">0.000</td>
<td align="center">0.001</td>
<td align="center">0.000</td>
<td align="center">0.000</td>
<td align="center">0.00</td>
<td align="center">0.65</td>
</tr>
<tr class="odd">
<td align="center"><strong>Month</strong></td>
<td align="center">0.078</td>
<td align="center">0.366</td>
<td align="center">0.027</td>
<td align="center">0.000</td>
<td align="center">0.00</td>
<td align="center">1.00</td>
</tr>
<tr class="even">
<td align="center"><strong>Day</strong></td>
<td align="center">0.888</td>
<td align="center">0.070</td>
<td align="center">0.739</td>
<td align="center">0.108</td>
<td align="center">0.92</td>
<td align="center">0.00</td>
</tr>
</tbody>
</table>
<p>Saving as a .csv is the same as for other dataframes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(mycorrelations<span class="op">$</span>r, <span class="dt">file=</span><span class="st">&quot;airquality-r-values.csv&quot;</span>)</code></pre></div>
<p>And can also access the CI for each pariwise correlation as a table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycorrelations<span class="op">$</span>ci <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption=</span><span class="st">&quot;First 6 rows of the table of CI&#39;s for the correlation matrix.&quot;</span>)</code></pre></div>
<table style="width:72%;">
<caption>First 6 rows of the table of CI’s for the correlation matrix.</caption>
<colgroup>
<col width="25%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">lower</th>
<th align="center">r</th>
<th align="center">upper</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Ozone-Slr.R</strong></td>
<td align="center">0.173</td>
<td align="center">0.348</td>
<td align="center">0.50</td>
<td align="center">0.000</td>
</tr>
<tr class="even">
<td align="center"><strong>Ozone-Wind</strong></td>
<td align="center">-0.706</td>
<td align="center">-0.602</td>
<td align="center">-0.47</td>
<td align="center">0.000</td>
</tr>
<tr class="odd">
<td align="center"><strong>Ozone-Temp</strong></td>
<td align="center">0.591</td>
<td align="center">0.698</td>
<td align="center">0.78</td>
<td align="center">0.000</td>
</tr>
<tr class="even">
<td align="center"><strong>Ozone-Month</strong></td>
<td align="center">-0.018</td>
<td align="center">0.165</td>
<td align="center">0.34</td>
<td align="center">0.078</td>
</tr>
<tr class="odd">
<td align="center"><strong>Ozone-Day</strong></td>
<td align="center">-0.195</td>
<td align="center">-0.013</td>
<td align="center">0.17</td>
<td align="center">0.888</td>
</tr>
<tr class="even">
<td align="center"><strong>Slr.R-Wind</strong></td>
<td align="center">-0.217</td>
<td align="center">-0.057</td>
<td align="center">0.11</td>
<td align="center">0.496</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="correlation-methods" class="section level3 unnumbered">
<h3>Other methods for correlation</h3>
<p>By default <code>corr.test</code> produces Pearson correlations, but You can pass the <code>method</code> argument <code>psych::corr.test()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psych<span class="op">::</span><span class="kw">corr.test</span>(airquality, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)
psych<span class="op">::</span><span class="kw">corr.test</span>(airquality, <span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="crosstabs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="t-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
