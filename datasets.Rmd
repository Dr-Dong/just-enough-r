---
title: 'Datasets and dataframes'
---
  

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse=TRUE, cache=TRUE)
library(tidyverse)
library(tufte)
```


# (PART) Data {- #data}


# Datasets and dataframes {#datasets-dataframes}

A dataframe is an object which can store data as you might encounter it in SPSS, Stata, or other statistics packages. 

It's much like a spreadsheet, but with some constraints applied. 
'Constraints' sound bad, but are helpful here: they make dataframes more structured and predictable to work with:

- Each column is a [vector](#vectors-and-lists), and so can [only store one type of data](#vectors-and-lists).

- Every column has to be the same length (although missing values are allowed).

- Each column should have a name.


Put another way, a dataframe behaves like a *list* of *vectors*, which means we can use a lot of the same rules to [access elements within them](#access-vector-elements) (more on this below).



#### Using 'built in' data {- #built-in-data}


The quickest way to see a dataframe in action is to use one that is [built in to R](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html). For example:

```{r}
head(airquality)
```

Or

```{r}
head(mtcars)
```

In both these examples the datasets (`airquality` and `mtcars`) are already loaded and available to be used in the `head()` function.

[To find a list of all the built in datasets you can type `help(datasets)` or see <https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html>. Familiarise yourself with some of the other included datasets, e.g. `datasets::attitude`. Watch out that not all the included datasets are *dataframes*: Some are just vectors of observations (e.g. the `airmiles` data) and some are 'time-series', (e.g. the `co2` data)]{.exercise}





## Looking at data {- #looking-at-data}

As we've already seen, using `print(df)` within an RMarkdown document creates a nice interactive table you can use to look at your data.

However you won't want to print your whole data file when you Knit your RMarkdown document. The `head` function can be useful if you just want to show a few rows:

```{r}
head(mtcars)
```


Or we can use `glimpse()` function from the `dplyr::` package (see the [section on loading and using packages](#packages)) for a different view of the first few rows of the `mtcars` data. This flips the dataframe so the variables are listed in the first column of the output:

```{r}
glimpse(mtcars)
```


You can use the `pander()` function (from the `pander::` package) to format tables nicely, for when you Knit a document to HTML, Word or PDF. For example:

```{r}
library(pander)
pander(head(airquality), caption="Tables always need a caption.")
```


See the section on [sharing and publishing for more ways to format and present tables](#sharing-and-publication).


Other useful functions for looking at and exploring datasets include:

```{r}
summary(airquality)
```


Or the more compact and useful output from `describe()` which is in the `pysch` package:

```{r}
# fast = T just skips some of the available stats (e.g. kurtosis)
psych::describe(airquality, fast = T) %>% 
  pander(caption="Summary statistics generated by the `psych::describe()` function.")
```


There are also some helpful plotting functions which accept a whole dataframe:

```{r, fig.cap="Box plot of all variables in a dataset."}
boxplot(airquality)
```

```{r, fig.cap="Correlation heatmap of all variables in a dataset. Colours indicate size of the correlation between pairs of variables."}
psych::cor.plot(airquality)
```

These plots might not be worth including in a final write-up, but are very useful when exploring your data.




### Using individual columns {-}

Because dataframes are like a list of vectors, we can access individual columns using the `$` symbol. This extracts the column as a vector, so we can pass it to functions:

```{r}
mean(mtcars$mpg)
```

Or slice it:


```{r}
(first.mpg <- mtcars$mpg[1])
(worst.mpg <- sort(mtcars$mpg)[1])
(best.mpg <- rev(sort(mtcars$mpg))[1])
```



[The problem with extracting individual columns in this way is that it's easy for data to be taken out of context: for example, if you sort individual columns then your data might get mixed up.  In general if you are accessing individual columns of data in this way it's a sign your code may be brittle and vulnerable to errors. In later sections we introduce methods for working on the whole dataset, which tends to be safer.]{.admonition}











