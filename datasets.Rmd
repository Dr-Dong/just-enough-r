---
title: 'Datasets and dataframes'
output: 
  bookdown::tufte_html2
---
  

```{r, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, collapse=TRUE, cache=TRUE)
library(tidyverse)
library(tufte)

```



# (PART) Working with data {-}


# Datasets and dataframes {#datasets-dataframes}

A dataframe is an object which can store data as you might encounter it in SPSS, Stata, or other statistics packages. 

It's much like a spreadsheet, but with some constraints applied. 
'Constraints' sound bad, but are helpful here: they make dataframes more structured and predictable to work with:

- Each column is a vector, and so can [only store one type of data](#vectors-and-lists)].

- Every column has to be the same length (although missing values are allowed).

- Each column should have a name.


Put another way, a dataframe behaves like a *list* of *vectors*, which means we can use a lot of the same rules to access elements within them (more on this below).


### Using 'built in' data {- #built-in-data}


The quickest way to see a dataframe in action is to use one that is built in[^builtin] to R. For example:

```{r}
head(airquality)
```

Or
```{r}
head(mtcars)
```

In both these examples the datasets (`airquality` and `mtcars`) are already loaded and available to be used in the `head()` function.

[To find a list of all the built in datasets you can type `help(datasets)`. Familiarise yourself with some of the other included datasets, e.g. `datasets::attitude`. Watch out that not all the included dataset as re *dataframes*: some are just vectors of observations (e.g. the `airmiles` data) and some are 'time-series', (e.g. the `co2` data)]{.exercise}



## Looking at data {- #looking-at-data}

As we've already seen, using `print(df)` within an RMarkdown document creates a nice interactive table you can use to look at your data.

However you won't want to print your whole data file when you Knit your RMarkdown document. The `head` function can be useful if you just want to see a few rows:

```{r}
head(mtcars)
```


Or we can use glimpse()` function from the `dplyr::` package (see the [section on loading and using packages](#packages)) for a different view of the first few rows of the `mtcars` data. This flips the dataframe so the variables are listed in the first column of the output:

```{r}
glimpse(mtcars)
```



You can use the `pander::` package to format tables nicely, for when you Knit a document to HTML, Word or PDF. For example:

```{r}
pander::pandoc.table(head(airquality), 
                     caption="Tables always need a caption.")
```


See the section on [sharing and publishing for more ways to format and present tables](#sharing-and-publication).


Other useful functions for looking at and exploring datasets include:

```{r}
summary(airquality)
```


Or the more compact and useful output from `describe()` which is in the `pysch` package:

```{r}
psych::describe(airquality)
```


There are also some helpful plotting functions which accept a dataframe:

```{r}
boxplot(airquality)
psych::cor.plot(airquality)
```

These plots might not be worth including in a final write-up, but are very useful when exploring your data.




## Importing and exporting data {- #importing-data}


If you have data outside of R, *the simplest way to import it is to first save it as a comma or tab-separated text file*, normally with the file extension `.csv` or `.txt`^[This is easy to achieve in Excel and most other stats packages using the `Save As...` menu item].

Let's say we have file called `angry_moods.csv` in the same directory as our `.Rmd` file. We can read this data using the `read_csv()` function from the `readr` package[^readr]:


[^readr]:
  There are also standard functions built into R, such as `read.csv()` or `read.table()` for importing data. These are fine if you can't install the `readr` package for some reason, but they are quite old and the default behaviour is sometimes counterintuitive. I recommend using the `readr` equivalents: `readr::read_csv()` or `readr::read_tsv()`.


```{r}
angry.moods <- readr::read_csv('data/angry_moods.csv')
head(angry.moods)
```



As you can see, when loading the `.csv` file the `read_csv()` makes some assumptions about the *type*  of data the file contains. In this case, all the columns contain integer values. It's worth checking this message to make sure that stray cells in the file you are importing don't cause problems when importing. Excel won't complain about this sort of thing, but R is more strict and won't mix text and numbers in the same column.

A common error is for stray notes or text values in a spreadsheet to cause a column which should be numeric to be converted to the `character` type.




Once it's loaded, you can use this new dataset like any other:


```{r}
pairs(angry.moods)
```



### Importing data over the web {- #importing-data-from-the-web}

One neat feature of the `readr` package is that you can import data from the web, using a URL rather than a filename on your local computer. This can be really helpful when sharing data and code with colleagues. For example, we can load the `angry_moods.csv` file from a URL:


```{r, message=F, cache=T, eval=F}
angry.moods.from.url <- readr::read_csv(
  "https://raw.githubusercontent.com/benwhalley/just-enough-r/master/angry_moods.csv")
head(angry.moods.from.url)
```




### Importing from SPSS and other packages {- #importing-proprietary-formats}

This is often more trouble than it's worth (just use a csv file!) but if you really must see <https://www.datacamp.com/community/tutorials/r-data-import-tutorial>.
